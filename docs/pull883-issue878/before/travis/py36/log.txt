travis_fold:start:worker_info[0K[33;1mWorker information[0m
hostname: 909cd984-0de5-41a7-840f-b3721b2ab0b7@1.worker-org-cfdfb76bd-5945z.gce-production-4
version: v6.2.20-1-g3a987d6 https://github.com/travis-ci/worker/tree/3a987d61ed169c9539ad435d1a9b5f2d8c6ce4a6
instance: travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d travis-ci-sardonyx-xenial-1593004276-4d46c6b3 (via amqp)
startup: 6.648180689s
travis_fold:end:worker_info[0Ktravis_time:start:2dcfcc70[0Ktravis_time:end:2dcfcc70:start=1610551029428326278,finish=1610551029582755049,duration=154428771,event=no_world_writable_dirs[0Ktravis_time:start:00c99cc0[0Ktravis_time:end:00c99cc0:start=1610551029586146620,finish=1610551029594035585,duration=7888965,event=agent[0Ktravis_time:start:1b15ed70[0Ktravis_time:end:1b15ed70:start=1610551029596908371,finish=1610551029599013343,duration=2104972,event=check_unsupported[0Ktravis_time:start:1de6cff2[0Ktravis_fold:start:system_info[0K[33;1mBuild system information[0m
Build language: python
Build dist: xenial
Build id: 754296999
Job id: 754297001
Runtime kernel version: 4.15.0-1077-gcp
travis-build version: 5d5d4288
[34m[1mBuild image provisioning date and time[0m
Wed Jun 24 13:36:52 UTC 2020
[34m[1mOperating System Details[0m
Distributor ID:	Ubuntu
Description:	Ubuntu 16.04.6 LTS
Release:	16.04
Codename:	xenial
[34m[1mSystemd Version[0m
systemd 229
[34m[1mCookbooks Version[0m
3f92a99 https://github.com/travis-ci/travis-cookbooks/tree/3f92a99
[34m[1mgit version[0m
git version 2.27.0
[34m[1mbash version[0m
GNU bash, version 4.3.48(1)-release (x86_64-pc-linux-gnu)
[34m[1mgcc version[0m
gcc (Ubuntu 5.4.0-6ubuntu1~16.04.12) 5.4.0 20160609
[34m[1mdocker version[0m
Client:
 Version:           18.06.0-ce
 API version:       1.38
 Go version:        go1.10.3
 Git commit:        0ffa825
 Built:             Wed Jul 18 19:11:02 2018
 OS/Arch:           linux/amd64
 Experimental:      false

Server:
 Engine:
  Version:          18.06.0-ce
  API version:      1.38 (minimum version 1.12)
  Go version:       go1.10.3
  Git commit:       0ffa825
  Built:            Wed Jul 18 19:09:05 2018
  OS/Arch:          linux/amd64
  Experimental:     false
[34m[1mclang version[0m
clang version 7.0.0 (tags/RELEASE_700/final)
[34m[1mjq version[0m
jq-1.5
[34m[1mbats version[0m
Bats 0.4.0
[34m[1mshellcheck version[0m
0.7.0
[34m[1mshfmt version[0m
v2.6.3
[34m[1mccache version[0m
3.2.4
[34m[1mcmake version[0m
cmake version 3.12.4
[34m[1mheroku version[0m
heroku/7.42.1 linux-x64 node-v12.16.2
[34m[1mimagemagick version[0m
Version: ImageMagick 6.8.9-9 Q16 x86_64 2019-11-12 http://www.imagemagick.org
[34m[1mmd5deep version[0m
4.4
[34m[1mmercurial version[0m
version 4.8
[34m[1mmysql version[0m
mysql  Ver 14.14 Distrib 5.7.30, for Linux (x86_64) using  EditLine wrapper
[34m[1mopenssl version[0m
OpenSSL 1.0.2g  1 Mar 2016
[34m[1mpacker version[0m
1.3.3
[34m[1mpostgresql client version[0m
psql (PostgreSQL) 10.13 (Ubuntu 10.13-1.pgdg16.04+1)
[34m[1mragel version[0m
Ragel State Machine Compiler version 6.8 Feb 2013
[34m[1msudo version[0m
1.8.16
[34m[1mgzip version[0m
gzip 1.6
[34m[1mzip version[0m
Zip 3.0
[34m[1mvim version[0m
VIM - Vi IMproved 7.4 (2013 Aug 10, compiled Mar 18 2020 14:06:17)
[34m[1miptables version[0m
iptables v1.6.0
[34m[1mcurl version[0m
curl 7.47.0 (x86_64-pc-linux-gnu) libcurl/7.47.0 GnuTLS/3.4.10 zlib/1.2.8 libidn/1.32 librtmp/2.3
[34m[1mwget version[0m
GNU Wget 1.17.1 built on linux-gnu.
[34m[1mrsync version[0m
rsync  version 3.1.1  protocol version 31
[34m[1mgimme version[0m
v1.5.4
[34m[1mnvm version[0m
0.35.3
[34m[1mperlbrew version[0m
/home/travis/perl5/perlbrew/bin/perlbrew  - App::perlbrew/0.88
[34m[1mphpenv version[0m
rbenv 1.1.2-30-gc879cb0
[34m[1mrvm version[0m
rvm 1.29.10 (latest) by Michal Papis, Piotr Kuczynski, Wayne E. Seguin [https://rvm.io]
[34m[1mdefault ruby version[0m
ruby 2.5.3p105 (2018-10-18 revision 65156) [x86_64-linux]
[34m[1mCouchDB version[0m
couchdb 1.6.1
[34m[1mElasticSearch version[0m
5.5.0
[34m[1mInstalled Firefox version[0m
firefox 63.0.1
[34m[1mMongoDB version[0m
MongoDB 4.0.19
[34m[1mPhantomJS version[0m
2.1.1
[34m[1mPre-installed PostgreSQL versions[0m
9.4.26
9.5.22
9.6.18
[34m[1mRedis version[0m
redis-server 6.0.5
[34m[1mPre-installed Go versions[0m
1.11.1
[34m[1mant version[0m
Apache Ant(TM) version 1.9.6 compiled on July 20 2018
[34m[1mmvn version[0m
Apache Maven 3.6.3 (cecedd343002696d0abb50b32b541b8a6ba2883f)
[34m[1mgradle version[0m
Gradle 5.1.1!
[34m[1mlein version[0m
Leiningen 2.9.3 on Java 11.0.2 OpenJDK 64-Bit Server VM
[34m[1mPre-installed Node.js versions[0m
v10.21.0
v11.0.0
v12.18.1
v4.9.1
v6.17.1
v8.12.0
v8.17.0
v8.9
[34m[1mphpenv versions[0m
  system
  5.6
  5.6.40
  7.1
  7.1.27
  7.2
* 7.2.15 (set by /home/travis/.phpenv/version)
  hhvm
  hhvm-stable
[34m[1mcomposer --version[0m
Composer version 1.8.4 2019-02-11 10:52:10
[34m[1mPre-installed Ruby versions[0m
ruby-2.3.8
ruby-2.4.5
ruby-2.5.3
travis_fold:end:system_info[0K
travis_time:end:1de6cff2:start=1610551029602144232,finish=1610551029608824170,duration=6679938,event=show_system_info[0Ktravis_time:start:014df070[0Ktravis_time:end:014df070:start=1610551029612081302,finish=1610551029627784438,duration=15703136,event=rm_riak_source[0Ktravis_time:start:235a894e[0Ktravis_time:end:235a894e:start=1610551029630990376,finish=1610551029636571991,duration=5581615,event=fix_rwky_redis[0Ktravis_time:start:0781523d[0Ktravis_time:end:0781523d:start=1610551029639983423,finish=1610551030337772946,duration=697789523,event=wait_for_network[0Ktravis_time:start:0545461c[0Ktravis_time:end:0545461c:start=1610551030341049627,finish=1610551030581739988,duration=240690361,event=update_apt_keys[0Ktravis_time:start:26d9c799[0Ktravis_time:end:26d9c799:start=1610551030585209210,finish=1610551030638803992,duration=53594782,event=fix_hhvm_source[0Ktravis_time:start:0b7855fc[0Ktravis_time:end:0b7855fc:start=1610551030642148308,finish=1610551030644937694,duration=2789386,event=update_mongo_arch[0Ktravis_time:start:0bf7befe[0Ktravis_time:end:0bf7befe:start=1610551030647926271,finish=1610551030690021004,duration=42094733,event=fix_sudo_enabled_trusty[0Ktravis_time:start:00981318[0Ktravis_time:end:00981318:start=1610551030693502298,finish=1610551030695909641,duration=2407343,event=update_glibc[0Ktravis_time:start:28d913e0[0Ktravis_time:end:28d913e0:start=1610551030699021035,finish=1610551030707332630,duration=8311595,event=clean_up_path[0Ktravis_time:start:01129368[0Ktravis_time:end:01129368:start=1610551030710589489,finish=1610551030718881271,duration=8291782,event=fix_resolv_conf[0Ktravis_time:start:0ae68262[0Ktravis_time:end:0ae68262:start=1610551030722303253,finish=1610551030731743872,duration=9440619,event=fix_etc_hosts[0Ktravis_time:start:0c982278[0Ktravis_time:end:0c982278:start=1610551030734787627,finish=1610551030745971588,duration=11183961,event=fix_mvn_settings_xml[0Ktravis_time:start:0879066c[0Ktravis_time:end:0879066c:start=1610551030749005003,finish=1610551030758353546,duration=9348543,event=no_ipv6_localhost[0Ktravis_time:start:2472e211[0Ktravis_time:end:2472e211:start=1610551030761352466,finish=1610551030763533224,duration=2180758,event=fix_etc_mavenrc[0Ktravis_time:start:118e999a[0Ktravis_time:end:118e999a:start=1610551030766447471,finish=1610551030769606825,duration=3159354,event=fix_wwdr_certificate[0Ktravis_time:start:218c08f4[0Ktravis_time:end:218c08f4:start=1610551030772520441,finish=1610551030796163679,duration=23643238,event=put_localhost_first[0Ktravis_time:start:0c208395[0Ktravis_time:end:0c208395:start=1610551030799240929,finish=1610551030802630806,duration=3389877,event=home_paths[0Ktravis_time:start:0139b16b[0Ktravis_time:end:0139b16b:start=1610551030805750327,finish=1610551030818382957,duration=12632630,event=disable_initramfs[0Ktravis_time:start:2abb48bc[0Ktravis_time:end:2abb48bc:start=1610551030821504007,finish=1610551031185679139,duration=364175132,event=disable_ssh_roaming[0Ktravis_time:start:1ec551be[0Ktravis_time:end:1ec551be:start=1610551031188825357,finish=1610551031191116170,duration=2290813,event=debug_tools[0Ktravis_time:start:1b0d4ae1[0Ktravis_time:end:1b0d4ae1:start=1610551031194198133,finish=1610551031197311376,duration=3113243,event=uninstall_oclint[0Ktravis_time:start:07963596[0Ktravis_time:end:07963596:start=1610551031200407109,finish=1610551031203863592,duration=3456483,event=rvm_use[0Ktravis_time:start:15551655[0Ktravis_time:end:15551655:start=1610551031207112818,finish=1610551031215587668,duration=8474850,event=rm_etc_boto_cfg[0Ktravis_time:start:0b0a10c0[0Ktravis_time:end:0b0a10c0:start=1610551031218834738,finish=1610551031223380635,duration=4545897,event=rm_oraclejdk8_symlink[0Ktravis_time:start:158a8880[0Ktravis_time:end:158a8880:start=1610551031226510970,finish=1610551031328180404,duration=101669434,event=enable_i386[0Ktravis_time:start:09f9c332[0Ktravis_time:end:09f9c332:start=1610551031331486817,finish=1610551031338449788,duration=6962971,event=update_rubygems[0Ktravis_time:start:07375130[0Ktravis_time:end:07375130:start=1610551031341649437,finish=1610551032165114234,duration=823464797,event=ensure_path_components[0Ktravis_time:start:1c91f55f[0Ktravis_time:end:1c91f55f:start=1610551032168592816,finish=1610551032170937605,duration=2344789,event=redefine_curl[0Ktravis_time:start:141bb411[0Ktravis_time:end:141bb411:start=1610551032174184378,finish=1610551032176617860,duration=2433482,event=nonblock_pipe[0Ktravis_time:start:065adc3a[0Ktravis_time:end:065adc3a:start=1610551032179530888,finish=1610551038215870106,duration=6036339218,event=apt_get_update[0Ktravis_time:start:02a11e38[0Ktravis_time:end:02a11e38:start=1610551038219364717,finish=1610551038221599381,duration=2234664,event=deprecate_xcode_64[0Ktravis_time:start:1e5fd44d[0Ktravis_time:end:1e5fd44d:start=1610551038224551839,finish=1610551040960652627,duration=2736100788,event=update_heroku[0Ktravis_time:start:2613ecfa[0Ktravis_time:end:2613ecfa:start=1610551040963774461,finish=1610551040965926120,duration=2151659,event=shell_session_update[0Ktravis_time:start:04ebae67[0Ktravis_fold:start:docker_mtu_and_registry_mirrors[0Ktravis_fold:end:docker_mtu_and_registry_mirrors[0Ktravis_time:end:04ebae67:start=1610551040968895136,finish=1610551043577268831,duration=2608373695,event=set_docker_mtu_and_registry_mirrors[0Ktravis_time:start:19a80b4a[0Ktravis_fold:start:resolvconf[0Ktravis_fold:end:resolvconf[0Ktravis_time:end:19a80b4a:start=1610551043584434467,finish=1610551043656301755,duration=71867288,event=resolvconf[0Ktravis_time:start:0ed6474c[0Ktravis_time:end:0ed6474c:start=1610551043661341873,finish=1610551043811099899,duration=149758026,event=maven_central_mirror[0Ktravis_time:start:06e16657[0Ktravis_time:end:06e16657:start=1610551043814335695,finish=1610551043906209642,duration=91873947,event=maven_https[0Ktravis_time:start:0a915af7[0Ktravis_fold:start:services[0Ktravis_time:start:0c012204[0K$ sudo systemctl start mongod
travis_time:end:0c012204:start=1610551043925091511,finish=1610551043944556500,duration=19464989,event=prepare[0Ktravis_fold:end:services[0Ktravis_time:end:0c012204:start=1610551043925091511,finish=1610551046948864991,duration=3023773480,event=services[0Ktravis_time:start:083de7a2[0Ktravis_time:end:083de7a2:start=1610551046952265375,finish=1610551046954429366,duration=2163991,event=fix_ps4[0Ktravis_time:start:0261d2d8[0K
travis_fold:start:git.checkout[0Ktravis_time:start:07190250[0K$ git clone --depth=50 https://github.com/man-group/arctic.git man-group/arctic
Cloning into 'man-group/arctic'...
remote: Enumerating objects: 618, done.[K
remote: Counting objects:   0% (1/618)[Kremote: Counting objects:   1% (7/618)[Kremote: Counting objects:   2% (13/618)[Kremote: Counting objects:   3% (19/618)[Kremote: Counting objects:   4% (25/618)[Kremote: Counting objects:   5% (31/618)[Kremote: Counting objects:   6% (38/618)[Kremote: Counting objects:   7% (44/618)[Kremote: Counting objects:   8% (50/618)[Kremote: Counting objects:   9% (56/618)[Kremote: Counting objects:  10% (62/618)[Kremote: Counting objects:  11% (68/618)[Kremote: Counting objects:  12% (75/618)[Kremote: Counting objects:  13% (81/618)[Kremote: Counting objects:  14% (87/618)[Kremote: Counting objects:  15% (93/618)[Kremote: Counting objects:  16% (99/618)[Kremote: Counting objects:  17% (106/618)[Kremote: Counting objects:  18% (112/618)[Kremote: Counting objects:  19% (118/618)[Kremote: Counting objects:  20% (124/618)[Kremote: Counting objects:  21% (130/618)[Kremote: Counting objects:  22% (136/618)[Kremote: Counting objects:  23% (143/618)[Kremote: Counting objects:  24% (149/618)[Kremote: Counting objects:  25% (155/618)[Kremote: Counting objects:  26% (161/618)[Kremote: Counting objects:  27% (167/618)[Kremote: Counting objects:  28% (174/618)[Kremote: Counting objects:  29% (180/618)[Kremote: Counting objects:  30% (186/618)[Kremote: Counting objects:  31% (192/618)[Kremote: Counting objects:  32% (198/618)[Kremote: Counting objects:  33% (204/618)[Kremote: Counting objects:  34% (211/618)[Kremote: Counting objects:  35% (217/618)[Kremote: Counting objects:  36% (223/618)[Kremote: Counting objects:  37% (229/618)[Kremote: Counting objects:  38% (235/618)[Kremote: Counting objects:  39% (242/618)[Kremote: Counting objects:  40% (248/618)[Kremote: Counting objects:  41% (254/618)[Kremote: Counting objects:  42% (260/618)[Kremote: Counting objects:  43% (266/618)[Kremote: Counting objects:  44% (272/618)[Kremote: Counting objects:  45% (279/618)[Kremote: Counting objects:  46% (285/618)[Kremote: Counting objects:  47% (291/618)[Kremote: Counting objects:  48% (297/618)[Kremote: Counting objects:  49% (303/618)[Kremote: Counting objects:  50% (309/618)[Kremote: Counting objects:  51% (316/618)[Kremote: Counting objects:  52% (322/618)[Kremote: Counting objects:  53% (328/618)[Kremote: Counting objects:  54% (334/618)[Kremote: Counting objects:  55% (340/618)[Kremote: Counting objects:  56% (347/618)[Kremote: Counting objects:  57% (353/618)[Kremote: Counting objects:  58% (359/618)[Kremote: Counting objects:  59% (365/618)[Kremote: Counting objects:  60% (371/618)[Kremote: Counting objects:  61% (377/618)[Kremote: Counting objects:  62% (384/618)[Kremote: Counting objects:  63% (390/618)[Kremote: Counting objects:  64% (396/618)[Kremote: Counting objects:  65% (402/618)[Kremote: Counting objects:  66% (408/618)[Kremote: Counting objects:  67% (415/618)[Kremote: Counting objects:  68% (421/618)[Kremote: Counting objects:  69% (427/618)[Kremote: Counting objects:  70% (433/618)[Kremote: Counting objects:  71% (439/618)[Kremote: Counting objects:  72% (445/618)[Kremote: Counting objects:  73% (452/618)[Kremote: Counting objects:  74% (458/618)[Kremote: Counting objects:  75% (464/618)[Kremote: Counting objects:  76% (470/618)[Kremote: Counting objects:  77% (476/618)[Kremote: Counting objects:  78% (483/618)[Kremote: Counting objects:  79% (489/618)[Kremote: Counting objects:  80% (495/618)[Kremote: Counting objects:  81% (501/618)[Kremote: Counting objects:  82% (507/618)[Kremote: Counting objects:  83% (513/618)[Kremote: Counting objects:  84% (520/618)[Kremote: Counting objects:  85% (526/618)[Kremote: Counting objects:  86% (532/618)[Kremote: Counting objects:  87% (538/618)[Kremote: Counting objects:  88% (544/618)[Kremote: Counting objects:  89% (551/618)[Kremote: Counting objects:  90% (557/618)[Kremote: Counting objects:  91% (563/618)[Kremote: Counting objects:  92% (569/618)[Kremote: Counting objects:  93% (575/618)[Kremote: Counting objects:  94% (581/618)[Kremote: Counting objects:  95% (588/618)[Kremote: Counting objects:  96% (594/618)[Kremote: Counting objects:  97% (600/618)[Kremote: Counting objects:  98% (606/618)[Kremote: Counting objects:  99% (612/618)[Kremote: Counting objects: 100% (618/618)[Kremote: Counting objects: 100% (618/618), done.[K
remote: Compressing objects:   0% (1/374)[Kremote: Compressing objects:   1% (4/374)[Kremote: Compressing objects:   2% (8/374)[Kremote: Compressing objects:   3% (12/374)[Kremote: Compressing objects:   4% (15/374)[Kremote: Compressing objects:   5% (19/374)[Kremote: Compressing objects:   6% (23/374)[Kremote: Compressing objects:   7% (27/374)[Kremote: Compressing objects:   8% (30/374)[Kremote: Compressing objects:   9% (34/374)[Kremote: Compressing objects:  10% (38/374)[Kremote: Compressing objects:  11% (42/374)[Kremote: Compressing objects:  12% (45/374)[Kremote: Compressing objects:  13% (49/374)[Kremote: Compressing objects:  14% (53/374)[Kremote: Compressing objects:  15% (57/374)[Kremote: Compressing objects:  16% (60/374)[Kremote: Compressing objects:  17% (64/374)[Kremote: Compressing objects:  18% (68/374)[Kremote: Compressing objects:  19% (72/374)[Kremote: Compressing objects:  20% (75/374)[Kremote: Compressing objects:  21% (79/374)[Kremote: Compressing objects:  22% (83/374)[Kremote: Compressing objects:  23% (87/374)[Kremote: Compressing objects:  24% (90/374)[Kremote: Compressing objects:  25% (94/374)[Kremote: Compressing objects:  26% (98/374)[Kremote: Compressing objects:  27% (101/374)[Kremote: Compressing objects:  28% (105/374)[Kremote: Compressing objects:  29% (109/374)[Kremote: Compressing objects:  30% (113/374)[Kremote: Compressing objects:  31% (116/374)[Kremote: Compressing objects:  32% (120/374)[Kremote: Compressing objects:  33% (124/374)[Kremote: Compressing objects:  34% (128/374)[Kremote: Compressing objects:  35% (131/374)[Kremote: Compressing objects:  36% (135/374)[Kremote: Compressing objects:  37% (139/374)[Kremote: Compressing objects:  38% (143/374)[Kremote: Compressing objects:  39% (146/374)[Kremote: Compressing objects:  40% (150/374)[Kremote: Compressing objects:  41% (154/374)[Kremote: Compressing objects:  42% (158/374)[Kremote: Compressing objects:  43% (161/374)[Kremote: Compressing objects:  44% (165/374)[Kremote: Compressing objects:  45% (169/374)[Kremote: Compressing objects:  46% (173/374)[Kremote: Compressing objects:  47% (176/374)[Kremote: Compressing objects:  48% (180/374)[Kremote: Compressing objects:  49% (184/374)[Kremote: Compressing objects:  50% (187/374)[Kremote: Compressing objects:  51% (191/374)[Kremote: Compressing objects:  52% (195/374)[Kremote: Compressing objects:  53% (199/374)[Kremote: Compressing objects:  54% (202/374)[Kremote: Compressing objects:  55% (206/374)[Kremote: Compressing objects:  56% (210/374)[Kremote: Compressing objects:  57% (214/374)[Kremote: Compressing objects:  58% (217/374)[Kremote: Compressing objects:  59% (221/374)[Kremote: Compressing objects:  60% (225/374)[Kremote: Compressing objects:  61% (229/374)[Kremote: Compressing objects:  62% (232/374)[Kremote: Compressing objects:  63% (236/374)[Kremote: Compressing objects:  64% (240/374)[Kremote: Compressing objects:  65% (244/374)[Kremote: Compressing objects:  66% (247/374)[Kremote: Compressing objects:  67% (251/374)[Kremote: Compressing objects:  68% (255/374)[Kremote: Compressing objects:  69% (259/374)[Kremote: Compressing objects:  70% (262/374)[Kremote: Compressing objects:  71% (266/374)[Kremote: Compressing objects:  72% (270/374)[Kremote: Compressing objects:  73% (274/374)[Kremote: Compressing objects:  74% (277/374)[Kremote: Compressing objects:  75% (281/374)[Kremote: Compressing objects:  76% (285/374)[Kremote: Compressing objects:  77% (288/374)[Kremote: Compressing objects:  78% (292/374)[Kremote: Compressing objects:  79% (296/374)[Kremote: Compressing objects:  80% (300/374)[Kremote: Compressing objects:  81% (303/374)[Kremote: Compressing objects:  82% (307/374)[Kremote: Compressing objects:  83% (311/374)[Kremote: Compressing objects:  84% (315/374)[Kremote: Compressing objects:  85% (318/374)[Kremote: Compressing objects:  86% (322/374)[Kremote: Compressing objects:  87% (326/374)[Kremote: Compressing objects:  88% (330/374)[Kremote: Compressing objects:  89% (333/374)[Kremote: Compressing objects:  90% (337/374)[Kremote: Compressing objects:  91% (341/374)[Kremote: Compressing objects:  92% (345/374)[Kremote: Compressing objects:  93% (348/374)[Kremote: Compressing objects:  94% (352/374)[Kremote: Compressing objects:  95% (356/374)[Kremote: Compressing objects:  96% (360/374)[Kremote: Compressing objects:  97% (363/374)[Kremote: Compressing objects:  98% (367/374)[Kremote: Compressing objects:  99% (371/374)[Kremote: Compressing objects: 100% (374/374)[Kremote: Compressing objects: 100% (374/374), done.[K
Receiving objects:   0% (1/618)Receiving objects:   1% (7/618)Receiving objects:   2% (13/618)Receiving objects:   3% (19/618)Receiving objects:   4% (25/618)Receiving objects:   5% (31/618)Receiving objects:   6% (38/618)Receiving objects:   7% (44/618)Receiving objects:   8% (50/618)Receiving objects:   9% (56/618)Receiving objects:  10% (62/618)Receiving objects:  11% (68/618)Receiving objects:  12% (75/618)Receiving objects:  13% (81/618)Receiving objects:  14% (87/618)Receiving objects:  15% (93/618)Receiving objects:  16% (99/618)Receiving objects:  17% (106/618)Receiving objects:  18% (112/618)Receiving objects:  19% (118/618)Receiving objects:  20% (124/618)Receiving objects:  21% (130/618)Receiving objects:  22% (136/618)Receiving objects:  23% (143/618)Receiving objects:  24% (149/618)Receiving objects:  25% (155/618)Receiving objects:  26% (161/618)Receiving objects:  27% (167/618)Receiving objects:  28% (174/618)Receiving objects:  29% (180/618)Receiving objects:  30% (186/618)Receiving objects:  31% (192/618)Receiving objects:  32% (198/618)Receiving objects:  33% (204/618)Receiving objects:  34% (211/618)Receiving objects:  35% (217/618)Receiving objects:  36% (223/618)Receiving objects:  37% (229/618)Receiving objects:  38% (235/618)Receiving objects:  39% (242/618)Receiving objects:  40% (248/618)Receiving objects:  41% (254/618)Receiving objects:  42% (260/618)Receiving objects:  43% (266/618)Receiving objects:  44% (272/618)Receiving objects:  45% (279/618)Receiving objects:  46% (285/618)Receiving objects:  47% (291/618)Receiving objects:  48% (297/618)Receiving objects:  49% (303/618)Receiving objects:  50% (309/618)Receiving objects:  51% (316/618)Receiving objects:  52% (322/618)Receiving objects:  53% (328/618)Receiving objects:  54% (334/618)Receiving objects:  55% (340/618)Receiving objects:  56% (347/618)Receiving objects:  57% (353/618)Receiving objects:  58% (359/618)Receiving objects:  59% (365/618)Receiving objects:  60% (371/618)Receiving objects:  61% (377/618)Receiving objects:  62% (384/618)Receiving objects:  63% (390/618)Receiving objects:  64% (396/618)Receiving objects:  65% (402/618)Receiving objects:  66% (408/618)Receiving objects:  67% (415/618)Receiving objects:  68% (421/618)Receiving objects:  69% (427/618)Receiving objects:  70% (433/618)remote: Total 618 (delta 305), reused 398 (delta 238), pack-reused 0[K
Receiving objects:  71% (439/618)Receiving objects:  72% (445/618)Receiving objects:  73% (452/618)Receiving objects:  74% (458/618)Receiving objects:  75% (464/618)Receiving objects:  76% (470/618)Receiving objects:  77% (476/618)Receiving objects:  78% (483/618)Receiving objects:  79% (489/618)Receiving objects:  80% (495/618)Receiving objects:  81% (501/618)Receiving objects:  82% (507/618)Receiving objects:  83% (513/618)Receiving objects:  84% (520/618)Receiving objects:  85% (526/618)Receiving objects:  86% (532/618)Receiving objects:  87% (538/618)Receiving objects:  88% (544/618)Receiving objects:  89% (551/618)Receiving objects:  90% (557/618)Receiving objects:  91% (563/618)Receiving objects:  92% (569/618)Receiving objects:  93% (575/618)Receiving objects:  94% (581/618)Receiving objects:  95% (588/618)Receiving objects:  96% (594/618)Receiving objects:  97% (600/618)Receiving objects:  98% (606/618)Receiving objects:  99% (612/618)Receiving objects: 100% (618/618)Receiving objects: 100% (618/618), 526.98 KiB | 4.62 MiB/s, done.
Resolving deltas:   0% (0/305)Resolving deltas:   1% (5/305)Resolving deltas:  34% (105/305)Resolving deltas:  40% (124/305)Resolving deltas:  43% (132/305)Resolving deltas:  45% (139/305)Resolving deltas:  49% (151/305)Resolving deltas:  50% (154/305)Resolving deltas:  54% (166/305)Resolving deltas:  55% (168/305)Resolving deltas:  56% (172/305)Resolving deltas:  57% (175/305)Resolving deltas:  58% (177/305)Resolving deltas:  59% (181/305)Resolving deltas:  60% (185/305)Resolving deltas:  61% (188/305)Resolving deltas:  63% (193/305)Resolving deltas:  65% (201/305)Resolving deltas:  69% (211/305)Resolving deltas:  71% (218/305)Resolving deltas:  72% (220/305)Resolving deltas:  73% (224/305)Resolving deltas:  74% (226/305)Resolving deltas:  75% (230/305)Resolving deltas:  76% (234/305)Resolving deltas:  78% (239/305)Resolving deltas:  80% (244/305)Resolving deltas:  81% (248/305)Resolving deltas:  82% (251/305)Resolving deltas:  83% (254/305)Resolving deltas:  84% (257/305)Resolving deltas:  85% (260/305)Resolving deltas:  89% (272/305)Resolving deltas:  90% (276/305)Resolving deltas:  91% (278/305)Resolving deltas:  93% (284/305)Resolving deltas:  94% (288/305)Resolving deltas:  95% (292/305)Resolving deltas:  96% (294/305)Resolving deltas:  97% (297/305)Resolving deltas:  98% (299/305)Resolving deltas:  99% (302/305)Resolving deltas: 100% (305/305)Resolving deltas: 100% (305/305), done.
travis_time:end:07190250:start=1610551046960662552,finish=1610551047716293921,duration=755631369,event=checkout[0K$ cd man-group/arctic
travis_time:start:048651aa[0K$ git fetch origin +refs/pull/881/merge:
remote: Enumerating objects: 73, done.[K
remote: Counting objects:   1% (1/55)[Kremote: Counting objects:   3% (2/55)[Kremote: Counting objects:   5% (3/55)[Kremote: Counting objects:   7% (4/55)[Kremote: Counting objects:   9% (5/55)[Kremote: Counting objects:  10% (6/55)[Kremote: Counting objects:  12% (7/55)[Kremote: Counting objects:  14% (8/55)[Kremote: Counting objects:  16% (9/55)[Kremote: Counting objects:  18% (10/55)[Kremote: Counting objects:  20% (11/55)[Kremote: Counting objects:  21% (12/55)[Kremote: Counting objects:  23% (13/55)[Kremote: Counting objects:  25% (14/55)[Kremote: Counting objects:  27% (15/55)[Kremote: Counting objects:  29% (16/55)[Kremote: Counting objects:  30% (17/55)[Kremote: Counting objects:  32% (18/55)[Kremote: Counting objects:  34% (19/55)[Kremote: Counting objects:  36% (20/55)[Kremote: Counting objects:  38% (21/55)[Kremote: Counting objects:  40% (22/55)[Kremote: Counting objects:  41% (23/55)[Kremote: Counting objects:  43% (24/55)[Kremote: Counting objects:  45% (25/55)[Kremote: Counting objects:  47% (26/55)[Kremote: Counting objects:  49% (27/55)[Kremote: Counting objects:  50% (28/55)[Kremote: Counting objects:  52% (29/55)[Kremote: Counting objects:  54% (30/55)[Kremote: Counting objects:  56% (31/55)[Kremote: Counting objects:  58% (32/55)[Kremote: Counting objects:  60% (33/55)[Kremote: Counting objects:  61% (34/55)[Kremote: Counting objects:  63% (35/55)[Kremote: Counting objects:  65% (36/55)[Kremote: Counting objects:  67% (37/55)[Kremote: Counting objects:  69% (38/55)[Kremote: Counting objects:  70% (39/55)[Kremote: Counting objects:  72% (40/55)[Kremote: Counting objects:  74% (41/55)[Kremote: Counting objects:  76% (42/55)[Kremote: Counting objects:  78% (43/55)[Kremote: Counting objects:  80% (44/55)[Kremote: Counting objects:  81% (45/55)[Kremote: Counting objects:  83% (46/55)[Kremote: Counting objects:  85% (47/55)[Kremote: Counting objects:  87% (48/55)[Kremote: Counting objects:  89% (49/55)[Kremote: Counting objects:  90% (50/55)[Kremote: Counting objects:  92% (51/55)[Kremote: Counting objects:  94% (52/55)[Kremote: Counting objects:  96% (53/55)[Kremote: Counting objects:  98% (54/55)[Kremote: Counting objects: 100% (55/55)[Kremote: Counting objects: 100% (55/55), done.[K
remote: Compressing objects:  10% (1/10)[Kremote: Compressing objects:  20% (2/10)[Kremote: Compressing objects:  30% (3/10)[Kremote: Compressing objects:  40% (4/10)[Kremote: Compressing objects:  50% (5/10)[Kremote: Compressing objects:  60% (6/10)[Kremote: Compressing objects:  70% (7/10)[Kremote: Compressing objects:  80% (8/10)[Kremote: Compressing objects:  90% (9/10)[Kremote: Compressing objects: 100% (10/10)[Kremote: Compressing objects: 100% (10/10), done.[K
remote: Total 19 (delta 15), reused 12 (delta 9), pack-reused 0[K
Unpacking objects:   5% (1/19)Unpacking objects:  10% (2/19)Unpacking objects:  15% (3/19)Unpacking objects:  21% (4/19)Unpacking objects:  26% (5/19)Unpacking objects:  31% (6/19)Unpacking objects:  36% (7/19)Unpacking objects:  42% (8/19)Unpacking objects:  47% (9/19)Unpacking objects:  52% (10/19)Unpacking objects:  57% (11/19)Unpacking objects:  63% (12/19)Unpacking objects:  68% (13/19)Unpacking objects:  73% (14/19)Unpacking objects:  78% (15/19)Unpacking objects:  84% (16/19)Unpacking objects:  89% (17/19)Unpacking objects:  94% (18/19)Unpacking objects: 100% (19/19)Unpacking objects: 100% (19/19), 2.03 KiB | 260.00 KiB/s, done.
From https://github.com/man-group/arctic
 * branch            refs/pull/881/merge -> FETCH_HEAD
travis_time:end:048651aa:start=1610551047720536410,finish=1610551048303059593,duration=582523183,event=checkout[0K$ git checkout -qf FETCH_HEAD
travis_fold:end:git.checkout[0K
travis_time:end:048651aa:start=1610551047720536410,finish=1610551048321030883,duration=600494473,event=checkout[0Ktravis_time:start:16494a74[0Ktravis_time:end:16494a74:start=1610551048326619844,finish=1610551048333814574,duration=7194730,event=env[0Ktravis_time:start:012540bb[0K$ source ~/virtualenv/python3.6/bin/activate
travis_time:end:012540bb:start=1610551048337488544,finish=1610551048344092855,duration=6604311,event=[0K$ python --version
Python 3.6.7
$ pip --version
pip 20.1.1 from /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages/pip (python 3.6)
travis_fold:start:before_install[0Ktravis_time:start:02f3b288[0K$ pip install pycodestyle
Collecting pycodestyle
  Downloading pycodestyle-2.6.0-py2.py3-none-any.whl (41 kB)
[?25l
[?25hInstalling collected packages: pycodestyle
Successfully installed pycodestyle-2.6.0
travis_time:end:02f3b288:start=1610551048864005651,finish=1610551049916276644,duration=1052270993,event=before_install[0Ktravis_fold:end:before_install[0Ktravis_fold:start:install.1[0Ktravis_time:start:09c48480[0K$ mongo --version
MongoDB shell version v4.0.19
git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
allocator: tcmalloc
modules: none
build environment:
    distmod: ubuntu1604
    distarch: x86_64
    target_arch: x86_64
travis_time:end:09c48480:start=1610551049920752439,finish=1610551050065863648,duration=145111209,event=install[0Ktravis_fold:end:install.1[0Ktravis_fold:start:install.2[0Ktravis_time:start:18b50540[0K$ pip install --upgrade pip
Collecting pip
  Downloading pip-20.3.3-py2.py3-none-any.whl (1.5 MB)
[?25l
[?25hInstalling collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 20.1.1
    Uninstalling pip-20.1.1:
      Successfully uninstalled pip-20.1.1
Successfully installed pip-20.3.3
travis_time:end:18b50540:start=1610551050070233406,finish=1610551052212205137,duration=2141971731,event=install[0Ktravis_fold:end:install.2[0Ktravis_fold:start:install.3[0Ktravis_time:start:0938701c[0K$ pip install python-dateutil --upgrade
Collecting python-dateutil
  Downloading python_dateutil-2.8.1-py2.py3-none-any.whl (227 kB)
[?25l
[?25hRequirement already satisfied: six>=1.5 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from python-dateutil) (1.11.0)
Installing collected packages: python-dateutil
Successfully installed python-dateutil-2.8.1
travis_time:end:0938701c:start=1610551052216374157,finish=1610551053058030873,duration=841656716,event=install[0Ktravis_fold:end:install.3[0Ktravis_fold:start:install.4[0Ktravis_time:start:08334426[0K$ pip install pytz --upgrade
Collecting pytz
  Downloading pytz-2020.5-py2.py3-none-any.whl (510 kB)
[?25l
[?25hInstalling collected packages: pytz
Successfully installed pytz-2020.5
travis_time:end:08334426:start=1610551053061903361,finish=1610551054133424309,duration=1071520948,event=install[0Ktravis_fold:end:install.4[0Ktravis_fold:start:install.5[0Ktravis_time:start:076c5321[0K$ pip install tzlocal --upgrade
Collecting tzlocal
  Downloading tzlocal-2.1-py2.py3-none-any.whl (16 kB)
Requirement already satisfied: pytz in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from tzlocal) (2020.5)
Installing collected packages: tzlocal
Successfully installed tzlocal-2.1
travis_time:end:076c5321:start=1610551054137666157,finish=1610551054864053135,duration=726386978,event=install[0Ktravis_fold:end:install.5[0Ktravis_fold:start:install.6[0Ktravis_time:start:1ae6886a[0K$ pip install pymongo --upgrade
Collecting pymongo
  Downloading pymongo-3.11.2-cp36-cp36m-manylinux2014_x86_64.whl (509 kB)
[?25l
[?25hInstalling collected packages: pymongo
Successfully installed pymongo-3.11.2
travis_time:end:1ae6886a:start=1610551054868293775,finish=1610551056402477240,duration=1534183465,event=install[0Ktravis_fold:end:install.6[0Ktravis_fold:start:install.7[0Ktravis_time:start:0565b6b2[0K$ pip install numpy --upgrade
Requirement already satisfied: numpy in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (1.19.0)
Collecting numpy
  Downloading numpy-1.19.5-cp36-cp36m-manylinux2010_x86_64.whl (14.8 MB)
[?25l
[?25hInstalling collected packages: numpy
  Attempting uninstall: numpy
    Found existing installation: numpy 1.19.0
    Uninstalling numpy-1.19.0:
      Successfully uninstalled numpy-1.19.0
Successfully installed numpy-1.19.5
travis_time:end:0565b6b2:start=1610551056406517683,finish=1610551060598836589,duration=4192318906,event=install[0Ktravis_fold:end:install.7[0Ktravis_fold:start:install.8[0Ktravis_time:start:0210523e[0K$ pip install pandas --upgrade
Collecting pandas
  Downloading pandas-1.1.5-cp36-cp36m-manylinux1_x86_64.whl (9.5 MB)
[?25l
[?25hRequirement already satisfied: python-dateutil>=2.7.3 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pandas) (2.8.1)
Requirement already satisfied: numpy>=1.15.4 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pandas) (1.19.5)
Requirement already satisfied: pytz>=2017.2 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pandas) (2020.5)
Requirement already satisfied: six>=1.5 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from python-dateutil>=2.7.3->pandas) (1.11.0)
Installing collected packages: pandas
Successfully installed pandas-1.1.5
travis_time:end:0210523e:start=1610551060602643666,finish=1610551064827166488,duration=4224522822,event=install[0Ktravis_fold:end:install.8[0Ktravis_fold:start:install.9[0Ktravis_time:start:1648ea04[0K$ pip install decorator --upgrade
Collecting decorator
  Downloading decorator-4.4.2-py2.py3-none-any.whl (9.2 kB)
Installing collected packages: decorator
Successfully installed decorator-4.4.2
travis_time:end:1648ea04:start=1610551064831476447,finish=1610551065596765102,duration=765288655,event=install[0Ktravis_fold:end:install.9[0Ktravis_fold:start:install.10[0Ktravis_time:start:028bd668[0K$ pip install enum34 --upgrade
Collecting enum34
  Downloading enum34-1.1.10-py3-none-any.whl (11 kB)
Installing collected packages: enum34
Successfully installed enum34-1.1.10
travis_time:end:028bd668:start=1610551065600742380,finish=1610551066359868771,duration=759126391,event=install[0Ktravis_fold:end:install.10[0Ktravis_fold:start:install.11[0Ktravis_time:start:02f859fc[0K$ pip install lz4 --upgrade
Collecting lz4
  Downloading lz4-3.1.1-cp36-cp36m-manylinux2010_x86_64.whl (1.8 MB)
[?25l
[?25hInstalling collected packages: lz4
Successfully installed lz4-3.1.1
travis_time:end:02f859fc:start=1610551066363892181,finish=1610551067445750263,duration=1081858082,event=install[0Ktravis_fold:end:install.11[0Ktravis_fold:start:install.12[0Ktravis_time:start:082e0b7b[0K$ pip install mock --upgrade
Requirement already satisfied: mock in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (4.0.2)
Collecting mock
  Downloading mock-4.0.3-py3-none-any.whl (28 kB)
Installing collected packages: mock
  Attempting uninstall: mock
    Found existing installation: mock 4.0.2
    Uninstalling mock-4.0.2:
      Successfully uninstalled mock-4.0.2
Successfully installed mock-4.0.3
travis_time:end:082e0b7b:start=1610551067449717412,finish=1610551068502831068,duration=1053113656,event=install[0Ktravis_fold:end:install.12[0Ktravis_fold:start:install.13[0Ktravis_time:start:1be311e8[0K$ pip install mockextras
Collecting mockextras
  Downloading mockextras-1.0.2-py3-none-any.whl (8.0 kB)
Installing collected packages: mockextras
Successfully installed mockextras-1.0.2
travis_time:end:1be311e8:start=1610551068506942212,finish=1610551069247042935,duration=740100723,event=install[0Ktravis_fold:end:install.13[0Ktravis_fold:start:install.14[0Ktravis_time:start:16764b28[0K$ pip install pytest --upgrade
Requirement already satisfied: pytest in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (5.4.3)
Collecting pytest
  Downloading pytest-6.2.1-py3-none-any.whl (279 kB)
[?25l
[?25hRequirement already satisfied: pluggy<1.0.0a1,>=0.12 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest) (0.12.0)
Requirement already satisfied: packaging in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest) (19.0)
Requirement already satisfied: importlib-metadata>=0.12 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest) (0.18)
Collecting attrs>=19.2.0
  Downloading attrs-20.3.0-py2.py3-none-any.whl (49 kB)
[?25l
[?25hRequirement already satisfied: zipp>=0.5 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from importlib-metadata>=0.12->pytest) (0.5.1)
Collecting py>=1.8.2
  Downloading py-1.10.0-py2.py3-none-any.whl (97 kB)
[?25l
[?25hCollecting iniconfig
  Downloading iniconfig-1.1.1-py2.py3-none-any.whl (5.0 kB)
Requirement already satisfied: pyparsing>=2.0.2 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from packaging->pytest) (2.4.0)
Requirement already satisfied: six in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from packaging->pytest) (1.11.0)
Collecting toml
  Downloading toml-0.10.2-py2.py3-none-any.whl (16 kB)
Installing collected packages: toml, py, iniconfig, attrs, pytest
  Attempting uninstall: py
    Found existing installation: py 1.7.0
    Uninstalling py-1.7.0:
      Successfully uninstalled py-1.7.0
  Attempting uninstall: attrs
    Found existing installation: attrs 18.2.0
    Uninstalling attrs-18.2.0:
      Successfully uninstalled attrs-18.2.0
  Attempting uninstall: pytest
    Found existing installation: pytest 5.4.3
    Uninstalling pytest-5.4.3:
      Successfully uninstalled pytest-5.4.3
Successfully installed attrs-20.3.0 iniconfig-1.1.1 py-1.10.0 pytest-6.2.1 toml-0.10.2
travis_time:end:16764b28:start=1610551069250994672,finish=1610551072311126465,duration=3060131793,event=install[0Ktravis_fold:end:install.14[0Ktravis_fold:start:install.15[0Ktravis_time:start:046cb420[0K$ pip install pytest-cov --upgrade
Collecting pytest-cov
  Downloading pytest_cov-2.10.1-py2.py3-none-any.whl (19 kB)
Requirement already satisfied: pytest>=4.6 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest-cov) (6.2.1)
Collecting coverage>=4.4
  Downloading coverage-5.3.1-cp36-cp36m-manylinux2010_x86_64.whl (241 kB)
[?25l
[?25hRequirement already satisfied: iniconfig in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=4.6->pytest-cov) (1.1.1)
Requirement already satisfied: packaging in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=4.6->pytest-cov) (19.0)
Requirement already satisfied: py>=1.8.2 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=4.6->pytest-cov) (1.10.0)
Requirement already satisfied: importlib-metadata>=0.12 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=4.6->pytest-cov) (0.18)
Requirement already satisfied: attrs>=19.2.0 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=4.6->pytest-cov) (20.3.0)
Requirement already satisfied: pluggy<1.0.0a1,>=0.12 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=4.6->pytest-cov) (0.12.0)
Requirement already satisfied: toml in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=4.6->pytest-cov) (0.10.2)
Requirement already satisfied: zipp>=0.5 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from importlib-metadata>=0.12->pytest>=4.6->pytest-cov) (0.5.1)
Requirement already satisfied: pyparsing>=2.0.2 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from packaging->pytest>=4.6->pytest-cov) (2.4.0)
Requirement already satisfied: six in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from packaging->pytest>=4.6->pytest-cov) (1.11.0)
Installing collected packages: coverage, pytest-cov
Successfully installed coverage-5.3.1 pytest-cov-2.10.1
travis_time:end:046cb420:start=1610551072315008429,finish=1610551073809440848,duration=1494432419,event=install[0Ktravis_fold:end:install.15[0Ktravis_fold:start:install.16[0Ktravis_time:start:0f7521de[0K$ pip install pytest-server-fixtures --upgrade
Collecting pytest-server-fixtures
  Downloading pytest_server_fixtures-1.7.0-py2.py3-none-any.whl (40 kB)
[?25l
[?25hRequirement already satisfied: pytest in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest-server-fixtures) (6.2.1)
Requirement already satisfied: six in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest-server-fixtures) (1.11.0)
Collecting future
  Downloading future-0.18.2.tar.gz (829 kB)
[?25l
[?25hCollecting psutil
  Downloading psutil-5.8.0-cp36-cp36m-manylinux2010_x86_64.whl (291 kB)
[?25l
[?25hRequirement already satisfied: pluggy<1.0.0a1,>=0.12 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest->pytest-server-fixtures) (0.12.0)
Requirement already satisfied: iniconfig in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest->pytest-server-fixtures) (1.1.1)
Requirement already satisfied: packaging in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest->pytest-server-fixtures) (19.0)
Requirement already satisfied: importlib-metadata>=0.12 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest->pytest-server-fixtures) (0.18)
Requirement already satisfied: toml in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest->pytest-server-fixtures) (0.10.2)
Requirement already satisfied: attrs>=19.2.0 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest->pytest-server-fixtures) (20.3.0)
Requirement already satisfied: py>=1.8.2 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest->pytest-server-fixtures) (1.10.0)
Requirement already satisfied: zipp>=0.5 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from importlib-metadata>=0.12->pytest->pytest-server-fixtures) (0.5.1)
Requirement already satisfied: pyparsing>=2.0.2 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from packaging->pytest->pytest-server-fixtures) (2.4.0)
Collecting pytest-fixture-config
  Downloading pytest_fixture_config-1.7.0-py2.py3-none-any.whl (6.5 kB)
Collecting pytest-shutil
  Downloading pytest_shutil-1.7.0-py2.py3-none-any.whl (15 kB)
Requirement already satisfied: mock in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest-shutil->pytest-server-fixtures) (4.0.3)
Collecting contextlib2
  Using cached contextlib2-0.6.0.post1-py2.py3-none-any.whl (9.8 kB)
Collecting execnet
  Downloading execnet-1.7.1-py2.py3-none-any.whl (39 kB)
Collecting apipkg>=1.4
  Downloading apipkg-1.5-py2.py3-none-any.whl (4.9 kB)
Collecting path.py
  Downloading path.py-12.5.0-py3-none-any.whl (2.3 kB)
Collecting path
  Downloading path-15.0.1-py3-none-any.whl (21 kB)
Collecting requests
  Downloading requests-2.25.1-py2.py3-none-any.whl (61 kB)
[?25l
[?25hRequirement already satisfied: certifi>=2017.4.17 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from requests->pytest-server-fixtures) (2018.10.15)
Collecting chardet<5,>=3.0.2
  Downloading chardet-4.0.0-py2.py3-none-any.whl (178 kB)
[?25l
[?25hCollecting idna<3,>=2.5
  Downloading idna-2.10-py2.py3-none-any.whl (58 kB)
[?25l
[?25hCollecting urllib3<1.27,>=1.21.1
  Downloading urllib3-1.26.2-py2.py3-none-any.whl (136 kB)
[?25l
[?25hCollecting retry
  Downloading retry-0.9.2-py2.py3-none-any.whl (8.0 kB)
Requirement already satisfied: decorator>=3.4.2 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from retry->pytest-server-fixtures) (4.4.2)
Collecting termcolor
  Downloading termcolor-1.1.0.tar.gz (3.9 kB)
Building wheels for collected packages: future, termcolor
  Building wheel for future (setup.py) ... [?25l- \ | done
[?25h  Created wheel for future: filename=future-0.18.2-py3-none-any.whl size=491058 sha256=64e4cf14303ac8c73121421cda34777f96636b29ffb628095340708532526f21
  Stored in directory: /home/travis/.cache/pip/wheels/6e/9c/ed/4499c9865ac1002697793e0ae05ba6be33553d098f3347fb94
  Building wheel for termcolor (setup.py) ... [?25l- done
[?25h  Created wheel for termcolor: filename=termcolor-1.1.0-py3-none-any.whl size=4830 sha256=1c9600f418e96514dc849db6e14b8d25d18390174a7759a0e21da3e4b79955a0
  Stored in directory: /home/travis/.cache/pip/wheels/93/2a/eb/e58dbcbc963549ee4f065ff80a59f274cc7210b6eab962acdc
Successfully built future termcolor
Installing collected packages: path, apipkg, urllib3, termcolor, path.py, idna, execnet, contextlib2, chardet, retry, requests, pytest-shutil, pytest-fixture-config, psutil, future, pytest-server-fixtures
Successfully installed apipkg-1.5 chardet-4.0.0 contextlib2-0.6.0.post1 execnet-1.7.1 future-0.18.2 idna-2.10 path-15.0.1 path.py-12.5.0 psutil-5.8.0 pytest-fixture-config-1.7.0 pytest-server-fixtures-1.7.0 pytest-shutil-1.7.0 requests-2.25.1 retry-0.9.2 termcolor-1.1.0 urllib3-1.26.2
travis_time:end:0f7521de:start=1610551073813340654,finish=1610551078893303427,duration=5079962773,event=install[0Ktravis_fold:end:install.16[0Ktravis_fold:start:install.17[0Ktravis_time:start:01e5e770[0K$ pip install pytest-timeout --upgrade
Collecting pytest-timeout
  Downloading pytest_timeout-1.4.2-py2.py3-none-any.whl (10 kB)
Requirement already satisfied: pytest>=3.6.0 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest-timeout) (6.2.1)
Requirement already satisfied: packaging in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=3.6.0->pytest-timeout) (19.0)
Requirement already satisfied: iniconfig in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=3.6.0->pytest-timeout) (1.1.1)
Requirement already satisfied: attrs>=19.2.0 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=3.6.0->pytest-timeout) (20.3.0)
Requirement already satisfied: toml in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=3.6.0->pytest-timeout) (0.10.2)
Requirement already satisfied: importlib-metadata>=0.12 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=3.6.0->pytest-timeout) (0.18)
Requirement already satisfied: py>=1.8.2 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=3.6.0->pytest-timeout) (1.10.0)
Requirement already satisfied: pluggy<1.0.0a1,>=0.12 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=3.6.0->pytest-timeout) (0.12.0)
Requirement already satisfied: zipp>=0.5 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from importlib-metadata>=0.12->pytest>=3.6.0->pytest-timeout) (0.5.1)
Requirement already satisfied: pyparsing>=2.0.2 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from packaging->pytest>=3.6.0->pytest-timeout) (2.4.0)
Requirement already satisfied: six in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from packaging->pytest>=3.6.0->pytest-timeout) (1.11.0)
Installing collected packages: pytest-timeout
Successfully installed pytest-timeout-1.4.2
travis_time:end:01e5e770:start=1610551078897233348,finish=1610551079798455304,duration=901221956,event=install[0Ktravis_fold:end:install.17[0Ktravis_fold:start:install.18[0Ktravis_time:start:1f1b1e41[0K$ pip install pytest-xdist --upgrade
Collecting pytest-xdist
  Downloading pytest_xdist-2.2.0-py3-none-any.whl (36 kB)
Requirement already satisfied: pytest>=6.0.0 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest-xdist) (6.2.1)
Requirement already satisfied: execnet>=1.1 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest-xdist) (1.7.1)
Requirement already satisfied: apipkg>=1.4 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from execnet>=1.1->pytest-xdist) (1.5)
Requirement already satisfied: toml in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=6.0.0->pytest-xdist) (0.10.2)
Requirement already satisfied: attrs>=19.2.0 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=6.0.0->pytest-xdist) (20.3.0)
Requirement already satisfied: iniconfig in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=6.0.0->pytest-xdist) (1.1.1)
Requirement already satisfied: importlib-metadata>=0.12 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=6.0.0->pytest-xdist) (0.18)
Requirement already satisfied: py>=1.8.2 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=6.0.0->pytest-xdist) (1.10.0)
Requirement already satisfied: packaging in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=6.0.0->pytest-xdist) (19.0)
Requirement already satisfied: pluggy<1.0.0a1,>=0.12 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from pytest>=6.0.0->pytest-xdist) (0.12.0)
Requirement already satisfied: zipp>=0.5 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from importlib-metadata>=0.12->pytest>=6.0.0->pytest-xdist) (0.5.1)
Requirement already satisfied: six in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from packaging->pytest>=6.0.0->pytest-xdist) (1.11.0)
Requirement already satisfied: pyparsing>=2.0.2 in /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages (from packaging->pytest>=6.0.0->pytest-xdist) (2.4.0)
Collecting pytest-forked
  Downloading pytest_forked-1.3.0-py2.py3-none-any.whl (4.7 kB)
Installing collected packages: pytest-forked, pytest-xdist
Successfully installed pytest-forked-1.3.0 pytest-xdist-2.2.0
travis_time:end:1f1b1e41:start=1610551079802411843,finish=1610551080856986700,duration=1054574857,event=install[0Ktravis_fold:end:install.18[0Ktravis_fold:start:install.19[0Ktravis_time:start:07dd02be[0K$ pip install setuptools-git --upgrade
Collecting setuptools-git
  Downloading setuptools_git-1.2-py2.py3-none-any.whl (10 kB)
Installing collected packages: setuptools-git
Successfully installed setuptools-git-1.2
travis_time:end:07dd02be:start=1610551080861097042,finish=1610551081729070958,duration=867973916,event=install[0Ktravis_fold:end:install.19[0Ktravis_fold:start:install.20[0Ktravis_time:start:0bf2eb5a[0K$ if [[ $TRAVIS_PYTHON_VERSION == 2.7 ]]; then pip install pandas==0.22.0; fi
travis_time:end:0bf2eb5a:start=1610551081733074046,finish=1610551081735418732,duration=2344686,event=install[0Ktravis_fold:end:install.20[0Ktravis_time:start:138d86f0[0K$ pip freeze
apipkg==1.5
atomicwrites==1.2.1
attrs==20.3.0
certifi==2018.10.15
chardet==4.0.0
contextlib2==0.6.0.post1
coverage==5.3.1
decorator==4.4.2
enum34==1.1.10
execnet==1.7.1
future==0.18.2
idna==2.10
importlib-metadata==0.18
iniconfig==1.1.1
lz4==3.1.1
mock==4.0.3
mockextras==1.0.2
more-itertools==4.3.0
nose==1.3.7
numpy==1.19.5
packaging==19.0
pandas==1.1.5
path==15.0.1
path.py==12.5.0
pbr==5.0.0
pipenv==2018.11.26
pluggy==0.12.0
psutil==5.8.0
py==1.10.0
pycodestyle==2.6.0
pymongo==3.11.2
pyparsing==2.4.0
pytest==6.2.1
pytest-cov==2.10.1
pytest-fixture-config==1.7.0
pytest-forked==1.3.0
pytest-server-fixtures==1.7.0
pytest-shutil==1.7.0
pytest-timeout==1.4.2
pytest-xdist==2.2.0
python-dateutil==2.8.1
pytz==2020.5
requests==2.25.1
retry==0.9.2
setuptools-git==1.2
six==1.11.0
termcolor==1.1.0
toml==0.10.2
tzlocal==2.1
urllib3==1.26.2
virtualenv==16.0.0
virtualenv-clone==0.4.0
wcwidth==0.1.7
zipp==0.5.1
travis_time:end:138d86f0:start=1610551081739531511,finish=1610551082094224238,duration=354692727,event=script[0K[32;1mThe command "pip freeze" exited with 0.[0m
travis_time:start:02f62911[0K$ python setup.py test --pytest-args=-v
running test
WARNING: Testing via this command is deprecated and will be removed in a future version. Users looking for a generic test entry point independent of test runner are encouraged to use tox.
running egg_info
creating arctic.egg-info
writing arctic.egg-info/PKG-INFO
writing dependency_links to arctic.egg-info/dependency_links.txt
writing entry points to arctic.egg-info/entry_points.txt
writing requirements to arctic.egg-info/requires.txt
writing top-level names to arctic.egg-info/top_level.txt
writing manifest file 'arctic.egg-info/SOURCES.txt'
writing manifest file 'arctic.egg-info/SOURCES.txt'
running build_ext
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.6.7, pytest-6.2.1, py-1.10.0, pluggy-0.12.0 -- /home/travis/virtualenv/python3.6.7/bin/python
cachedir: .pytest_cache
rootdir: /home/travis/build/man-group/arctic
plugins: xdist-1.26.1, cov-2.10.1, server-fixtures-1.7.0, shutil-1.7.0, timeout-1.4.2, forked-1.3.0
[1mcollecting ... [0m[1mcollecting 216 items                                                           [0m[1mcollecting 460 items                                                           [0m[1mcollecting 867 items                                                           [0m[1mcollecting 1245 items                                                          [0m[1mcollected 1339 items                                                           [0m

tests/integration/test_arctic.py::test_connect_to_Arctic_string [32mPASSED[0m[33m   [  0%][0m2021-01-13 15:18:12,750 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_connect_to_Arctic_connection [32mPASSED[0m[33m [  0%][0m2021-01-13 15:18:13,432 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_reset_Arctic [32mPASSED[0m[33m               [  0%][0m2021-01-13 15:18:14,333 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_re_authenticate_on_arctic_reset [32mPASSED[0m[33m [  0%][0m2021-01-13 15:18:15,357 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_simple [32mPASSED[0m[33m                     [  0%][0m2021-01-13 15:18:17,489 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_indexes [32mPASSED[0m[33m                    [  0%][0m2021-01-13 15:18:18,372 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_delete_library [32mPASSED[0m[33m             [  0%][0m2021-01-13 15:18:19,616 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_quota [32mPASSED[0m[33m                      [  0%][0m2021-01-13 15:18:20,594 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_check_quota [32mPASSED[0m[33m                [  0%][0m2021-01-13 15:18:21,488 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_default_mongo_retry_timout [32mPASSED[0m[33m [  0%][0m
tests/integration/test_arctic.py::test_lib_rename [32mPASSED[0m[33m                 [  0%][0m
tests/integration/test_arctic.py::test_lib_rename_namespace [32mPASSED[0m[33m       [  0%][0m
tests/integration/test_arctic.py::test_lib_type [32mPASSED[0m[33m                   [  0%][0m2021-01-13 15:18:24,212 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_library_exists [32mPASSED[0m[33m             [  1%][0m2021-01-13 15:18:25,102 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_library_exists_no_auth [32mPASSED[0m[33m     [  1%][0m
tests/integration/test_arctic.py::test_list_libraries_cached [32mPASSED[0m[33m      [  1%][0m2021-01-13 15:18:27,110 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_initialize_library_adds_to_cache [32mPASSED[0m[33m [  1%][0m2021-01-13 15:18:28,447 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_cache_does_not_return_stale_data [32mPASSED[0m[33m [  1%][0m2021-01-13 15:18:29,757 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_renaming_returns_new_name_in_cache [32mPASSED[0m[33m [  1%][0m2021-01-13 15:18:30,896 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_deleting_library_removes_it_from_cache [32mPASSED[0m[33m [  1%][0m2021-01-13 15:18:32,147 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic.py::test_disable_cache_by_settings [32mPASSED[0m[33m  [  1%][0m2021-01-13 15:18:33,063 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic_multithreading.py::test_multiprocessing_safety [32mPASSED[0m[33m [  1%][0m2021-01-13 15:18:58,075 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_arctic_multithreading.py::test_multiprocessing_safety_parent_children_race [32mPASSED[0m[33m [  1%][0m2021-01-13 15:19:17,065 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_async_arctic.py::test_async_arctic [32mPASSED[0m[33m         [  1%][0m
tests/integration/test_compress_integration.py::test_roundtrip[arctic/lz4] [32mPASSED[0m[33m [  1%][0m
tests/integration/test_compress_integration.py::test_roundtrip[arcticHC/lz4] [32mPASSED[0m[33m [  1%][0m
tests/integration/test_compress_integration.py::test_roundtrip[lz4/arctic] [32mPASSED[0m[33m [  2%][0m
tests/integration/test_compress_integration.py::test_roundtrip[lz4HC/arctic] [32mPASSED[0m[33m [  2%][0m
tests/integration/test_compress_integration.py::test_performance_sequential[300-50000.0] [32mPASSED[0m[33m [  2%][0m
tests/integration/test_compress_integration.py::test_performance_sequential[5-2000000.0] [32mPASSED[0m[33m [  2%][0m
tests/integration/test_compress_integration.py::test_performance_sequential[10-2000000.0] [32mPASSED[0m[33m [  2%][0m
tests/integration/test_compress_integration.py::test_performance_sequential[100-2000000.0] [32mPASSED[0m[33m [  2%][0m
tests/integration/test_compress_integration.py::test_performance_sequential[250-2000000.0] [32mPASSED[0m[33m [  2%][0m
tests/integration/test_compress_integration.py::test_exceptions [32mPASSED[0m[33m   [  2%][0m
tests/integration/test_concurrent_append.py::test_append_kill [32mPASSED[0m[33m     [  2%][0m2021-01-13 15:22:21,155 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_decorators.py::test_get_host_VersionStore [32mPASSED[0m[33m  [  2%][0m2021-01-13 15:22:22,048 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_howtos.py::test_howto[how_to_custom_arctic_library.py] [32mPASSED[0m[33m [  2%][0m2021-01-13 15:22:22,796 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/test_howtos.py::test_howto[how_to_use_arctic.py] [32mPASSED[0m[33m [  2%][0m2021-01-13 15:22:23,751 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_write_dataframe [32mPASSED[0m[33m [  2%][0m2021-01-13 15:22:24,705 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_upsert_dataframe [32mPASSED[0m[33m [  2%][0m2021-01-13 15:22:25,646 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_write_dataframe_noindex [32mPASSED[0m[33m [  3%][0m2021-01-13 15:22:26,552 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_overwrite_dataframe [32mPASSED[0m[33m [  3%][0m2021-01-13 15:22:27,476 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_overwrite_dataframe_noindex [32mPASSED[0m[33m [  3%][0m2021-01-13 15:22:28,386 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_overwrite_dataframe_monthly [32mPASSED[0m[33m [  3%][0m2021-01-13 15:22:29,344 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_write_read_with_daterange [32mPASSED[0m[33m [  3%][0m2021-01-13 15:22:30,304 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_write_read_with_daterange_noindex [32mPASSED[0m[33m [  3%][0m2021-01-13 15:22:31,218 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_store_single_index_df [32mPASSED[0m[33m [  3%][0m2021-01-13 15:22:32,110 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_no_range [32mPASSED[0m[33m    [  3%][0m2021-01-13 15:22:33,013 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_closed_open [32mPASSED[0m[33m [  3%][0m2021-01-13 15:22:33,919 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_open_closed [32mPASSED[0m[33m [  3%][0m2021-01-13 15:22:34,859 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_closed_open_no_index [32mPASSED[0m[33m [  3%][0m2021-01-13 15:22:36,360 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_open_open_no_index [32mPASSED[0m[33m [  3%][0m2021-01-13 15:22:37,252 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_monthly_df [32mPASSED[0m[33m  [  3%][0m2021-01-13 15:22:38,168 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_yearly_df [32mPASSED[0m[33m   [  4%][0m2021-01-13 15:22:39,051 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_append_daily [32mPASSED[0m[33m [  4%][0m2021-01-13 15:22:40,092 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_append_monthly [32mPASSED[0m[33m [  4%][0m2021-01-13 15:22:41,063 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_append_yearly [32mPASSED[0m[33m [  4%][0m2021-01-13 15:22:41,991 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_append_existing_chunk [32mPASSED[0m[33m [  4%][0m2021-01-13 15:22:42,896 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_store_objects_df [32mPASSED[0m[33m [  4%][0m2021-01-13 15:22:43,799 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_empty_range [32mPASSED[0m[33m [  4%][0m2021-01-13 15:22:44,705 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_update [32mPASSED[0m[33m      [  4%][0m2021-01-13 15:22:45,648 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_update_no_overlap [32mPASSED[0m[33m [  4%][0m2021-01-13 15:22:46,590 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_update_chunk_range [32mPASSED[0m[33m [  4%][0m2021-01-13 15:22:47,516 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_update_chunk_range_overlap [32mPASSED[0m[33m [  4%][0m2021-01-13 15:22:48,418 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_append_before [32mPASSED[0m[33m [  4%][0m2021-01-13 15:22:49,365 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_append_and_update [32mPASSED[0m[33m [  4%][0m2021-01-13 15:22:50,333 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_update_same_df [32mPASSED[0m[33m [  5%][0m2021-01-13 15:22:51,250 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_df_with_multiindex [32mPASSED[0m[33m [  5%][0m2021-01-13 15:22:52,146 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_with_strings [32mPASSED[0m[33m [  5%][0m2021-01-13 15:22:53,040 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_with_strings_multiindex_append [32mPASSED[0m[33m [  5%][0m2021-01-13 15:22:53,973 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_multiple_actions [32mPASSED[0m[33m [  5%][0m2021-01-13 15:23:05,573 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_multiple_actions_monthly_data [32mPASSED[0m[33m [  5%][0m2021-01-13 15:23:10,901 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_delete [32mPASSED[0m[33m      [  5%][0m2021-01-13 15:23:11,857 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_delete_empty_df_on_range [32mPASSED[0m[33m [  5%][0m2021-01-13 15:23:12,818 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_get_info [32mPASSED[0m[33m    [  5%][0m2021-01-13 15:23:13,715 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_get_info_after_append [32mPASSED[0m[33m [  5%][0m2021-01-13 15:23:14,693 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_get_info_after_update [32mPASSED[0m[33m [  5%][0m2021-01-13 15:23:15,656 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_delete_range [32mPASSED[0m[33m [  5%][0m2021-01-13 15:23:16,615 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_delete_range_noindex [32mPASSED[0m[33m [  5%][0m2021-01-13 15:23:17,556 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_read_chunk_range [32mPASSED[0m[33m [  5%][0m2021-01-13 15:23:18,517 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_read_data_doesnt_exist [32mPASSED[0m[33m [  6%][0m
tests/integration/chunkstore/test_chunkstore.py::test_invalid_type [32mPASSED[0m[33m [  6%][0m
tests/integration/chunkstore/test_chunkstore.py::test_append_no_data [32mPASSED[0m[33m [  6%][0m
tests/integration/chunkstore/test_chunkstore.py::test_append_upsert [32mPASSED[0m[33m [  6%][0m2021-01-13 15:23:22,041 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_append_no_new_data [32mPASSED[0m[33m [  6%][0m2021-01-13 15:23:23,254 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_overwrite_series [31mFAILED[0m[31m [  6%][0m
tests/integration/chunkstore/test_chunkstore.py::test_overwrite_series_monthly [32mPASSED[0m[31m [  6%][0m2021-01-13 15:23:25,206 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_pandas_datetime_index_store_series [32mPASSED[0m[31m [  6%][0m2021-01-13 15:23:26,116 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_yearly_series [32mPASSED[0m[31m [  6%][0m2021-01-13 15:23:26,996 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_store_objects_series [32mPASSED[0m[31m [  6%][0m2021-01-13 15:23:27,889 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_update_series [32mPASSED[0m[31m [  6%][0m2021-01-13 15:23:28,828 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_update_same_series [32mPASSED[0m[31m [  6%][0m2021-01-13 15:23:30,342 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_dtype_mismatch [32mPASSED[0m[31m [  6%][0m2021-01-13 15:23:31,277 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_read_column_subset [32mPASSED[0m[31m [  7%][0m2021-01-13 15:23:32,220 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_rename [32mPASSED[0m[31m      [  7%][0m
tests/integration/chunkstore/test_chunkstore.py::test_pass_thru_chunker [32mPASSED[0m[31m [  7%][0m2021-01-13 15:23:34,171 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_pass_thru_chunker_append [32mPASSED[0m[31m [  7%][0m2021-01-13 15:23:35,687 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_pass_thru_chunker_update [32mPASSED[0m[31m [  7%][0m2021-01-13 15:23:36,591 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_pass_thru_chunker_update_range [32mPASSED[0m[31m [  7%][0m2021-01-13 15:23:37,493 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_size_chunking [32mPASSED[0m[31m [  7%][0m2021-01-13 15:23:41,089 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_size_chunk_append [32mPASSED[0m[31m [  7%][0m2021-01-13 15:23:48,695 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_delete_range_segment [32mPASSED[0m[31m [  7%][0m2021-01-13 15:23:54,664 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_size_chunk_update [32mPASSED[0m[31m [  7%][0m2021-01-13 15:24:02,060 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_size_chunk_multiple_update [32mPASSED[0m[31m [  7%][0m2021-01-13 15:24:05,828 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_get_chunk_range [32mPASSED[0m[31m [  7%][0m2021-01-13 15:24:06,717 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_iterators [32mPASSED[0m[31m   [  7%][0m2021-01-13 15:24:07,768 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_unnamed_colums [32mPASSED[0m[31m [  7%][0m
tests/integration/chunkstore/test_chunkstore.py::test_quarterly_data 2021-01-13 15:24:09,559 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:24:09,650 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [  8%][0m
tests/integration/chunkstore/test_chunkstore.py::test_list_symbols [32mPASSED[0m[31m [  8%][0m2021-01-13 15:24:14,701 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_stats [32mPASSED[0m[31m       [  8%][0m2021-01-13 15:24:19,925 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_metadata [32mPASSED[0m[31m    [  8%][0m2021-01-13 15:24:20,910 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_metadata_update [32mPASSED[0m[31m [  8%][0m2021-01-13 15:24:21,803 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_metadata_nosymbol [32mPASSED[0m[31m [  8%][0m2021-01-13 15:24:22,661 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_metadata_none [32mPASSED[0m[31m [  8%][0m2021-01-13 15:24:23,529 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_metadata_invalid [32mPASSED[0m[31m [  8%][0m2021-01-13 15:24:24,401 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_write_metadata [32mPASSED[0m[31m [  8%][0m2021-01-13 15:24:25,279 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_write_metadata_nosymbol [32mPASSED[0m[31m [  8%][0m2021-01-13 15:24:26,139 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_audit [32mPASSED[0m[31m       [  8%][0m2021-01-13 15:24:27,261 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_chunkstore_misc [32mPASSED[0m[31m [  8%][0m2021-01-13 15:24:28,123 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_unsorted_index [32mPASSED[0m[31m [  8%][0m2021-01-13 15:24:29,050 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_unsorted_date_col [32mPASSED[0m[31m [  9%][0m2021-01-13 15:24:29,980 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_chunk_range_with_dti [32mPASSED[0m[31m [  9%][0m2021-01-13 15:24:30,878 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_chunkstore_multiread [32mPASSED[0m[31m [  9%][0m2021-01-13 15:24:31,923 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_chunkstore_multiread_samedate [32mPASSED[0m[31m [  9%][0m2021-01-13 15:24:32,943 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_chunkstore.py::test_write_dataframe_with_func [32mPASSED[0m[31m [  9%][0m2021-01-13 15:24:33,864 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_fixes.py::test_write_dataframe [32mPASSED[0m[31m  [  9%][0m2021-01-13 15:24:34,779 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_fixes.py::test_compression [32mPASSED[0m[31m      [  9%][0m2021-01-13 15:24:36,938 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_fixes.py::test_date_interval [31mFAILED[0m[31m    [  9%][0m
tests/integration/chunkstore/test_fixes.py::test_rewrite [32mPASSED[0m[31m          [  9%][0m2021-01-13 15:24:38,763 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_fixes.py::test_iterator [32mPASSED[0m[31m         [  9%][0m2021-01-13 15:24:40,084 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_fixes.py::test_missing_cols [31mFAILED[0m[31m     [  9%][0m
tests/integration/chunkstore/test_fixes.py::test_column_copy [32mPASSED[0m[31m      [  9%][0m2021-01-13 15:24:41,929 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_fixes.py::test_get_info_empty [32mPASSED[0m[31m   [  9%][0m2021-01-13 15:24:42,783 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/test_utils.py::test_read_apply [32mPASSED[0m[31m       [ 10%][0m2021-01-13 15:24:43,665 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/chunkstore/tools/test_tools.py::test_segment_repair_tool [32mPASSED[0m[31m [ 10%][0m2021-01-13 15:24:47,189 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/fixtures/test_arctic.py::test_arctic [32mPASSED[0m[31m            [ 10%][0m2021-01-13 15:24:47,879 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/fixtures/test_arctic.py::test_library [32mPASSED[0m[31m           [ 10%][0m2021-01-13 15:24:48,789 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/fixtures/test_arctic.py::test_ms_lib [32mPASSED[0m[31m            [ 10%][0m2021-01-13 15:24:49,559 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[True-data0-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 10%][0m2021-01-13 15:24:50,533 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[True-data1-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 10%][0m2021-01-13 15:24:51,493 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[True-data2-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 10%][0m2021-01-13 15:24:52,445 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[True-data3-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 10%][0m2021-01-13 15:24:53,407 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[True-data4-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 10%][0m2021-01-13 15:24:54,380 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[True-data5-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 10%][0m2021-01-13 15:24:55,367 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[False-data6-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 10%][0m2021-01-13 15:24:56,330 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[False-data7-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 10%][0m2021-01-13 15:24:57,291 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[False-data8-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 10%][0m2021-01-13 15:24:58,237 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[False-data9-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:24:59,188 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[False-data10-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:00,157 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks[False-data11-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:01,136 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[True-data0-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:02,098 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[True-data1-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:03,059 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[True-data2-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:04,008 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[True-data3-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:05,012 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[True-data4-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:06,639 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[True-data5-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:08,253 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[False-data6-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:09,264 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[False-data7-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:10,869 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[False-data8-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:12,471 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[False-data9-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 11%][0m2021-01-13 15:25:13,506 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[False-data10-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:15,132 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_noop[False-data11-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:16,115 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[True-data0-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:17,068 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[True-data1-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:18,012 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[True-data2-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:18,963 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[True-data3-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:19,904 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[True-data4-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:20,872 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[True-data5-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:22,444 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[False-data6-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:23,512 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[False-data7-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:24,470 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[False-data8-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:25,429 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[False-data9-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:26,388 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[False-data10-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:27,341 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunks_ignores_recent[False-data11-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 12%][0m2021-01-13 15:25:28,287 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunk_doesnt_break_versions[data0-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:29,261 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunk_doesnt_break_versions[data1-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:30,237 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunk_doesnt_break_versions[data2-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:31,221 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunk_doesnt_break_versions[data3-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:32,236 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunk_doesnt_break_versions[data4-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:33,255 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_chunk_doesnt_break_versions[data5-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:34,276 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[True-data0-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:35,231 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[True-data1-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:36,192 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[True-data2-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:37,161 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[True-data3-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:38,132 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[True-data4-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:39,100 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[True-data5-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:40,077 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[False-data6-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 13%][0m2021-01-13 15:25:41,041 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[False-data7-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:41,997 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[False-data8-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:42,970 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[False-data9-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:43,948 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[False-data10-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:44,938 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots[False-data11-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:45,945 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[True-data0-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:46,916 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[True-data1-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:47,883 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[True-data2-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:48,840 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[True-data3-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:49,838 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[True-data4-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:50,821 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[True-data5-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:51,804 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[False-data6-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:52,790 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[False-data7-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 14%][0m2021-01-13 15:25:53,778 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[False-data8-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:25:54,751 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[False-data9-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:25:55,734 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[False-data10-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:25:56,724 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_cleanup_orphaned_snapshots_nop[False-data11-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:25:57,719 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[True-data0-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:25:58,678 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[True-data1-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:25:59,638 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[True-data2-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:26:00,611 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[True-data3-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:26:01,583 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[True-data4-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:26:02,572 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[True-data5-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:26:03,565 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[False-data6-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:26:04,529 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[False-data7-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:26:05,504 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[False-data8-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:26:06,463 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[False-data9-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 15%][0m2021-01-13 15:26:07,454 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[False-data10-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:08,437 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_arctic_fsck.py::test_dont_cleanup_recent_orphaned_snapshots[False-data11-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:09,426 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_copy_data.py::test_copy_data_no_force [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:10,702 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_copy_data.py::test_copy_data_force [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:11,973 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_copy_data.py::test_copy_data_splice [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:13,254 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_copy_data.py::test_copy_data_wild [32mPASSED[0m[31m  [ 16%][0m2021-01-13 15:26:14,524 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_copy_data.py::test_copy_data_doesnt_exist [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:15,703 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_delete_library.py::test_delete_library [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:16,988 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_delete_library.py::test_delete_library1 [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:18,261 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_delete_library.py::test_delete_library2 [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:19,526 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_delete_library.py::test_delete_library3 [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:20,823 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_delete_library.py::test_delete_library_doesnt_exist [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:21,963 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_enable_sharding.py::test_enable_sharding [32mPASSED[0m[31m [ 16%][0m2021-01-13 15:26:22,855 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_enable_sharding.py::test_enable_sharding_already_on_db [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:23,771 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_enable_sharding.py::test_enable_sharding_on_db_other_failure [32mPASSED[0m[31m [ 17%][0m
tests/integration/scripts/test_initialize_library.py::test_init_library [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:25,608 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_initialize_library.py::test_init_library_no_arctic_prefix [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:26,534 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_initialize_library.py::test_init_library_quota [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:27,418 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_initialize_library.py::test_init_library_bad_library [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:28,066 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_list_libraries.py::test_list_library [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:28,960 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_list_libraries.py::test_list_library_args [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:29,874 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_list_libraries.py::test_list_library_args_not_found [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:30,774 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_prune_versions.py::test_prune_versions_symbol [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:31,667 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_prune_versions.py::test_prune_versions_full [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:32,642 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_prune_versions.py::test_keep_recent_snapshots [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:33,563 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_prune_versions.py::test_fix_broken_snapshot_references [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:34,495 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/scripts/test_prune_versions.py::test_keep_only_one_version [32mPASSED[0m[31m [ 17%][0m2021-01-13 15:26:35,414 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_new_ts_read_write [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:36,349 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_read_ts_raw [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:37,297 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_write_ts_with_column_name_same_as_observed_dt_ok [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:38,239 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_last_update [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:39,195 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_existing_ts_update_and_read [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:40,172 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_existing_ts_update_existing_data_and_read [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:41,127 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_read_ts_with_historical_update [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:42,140 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_read_ts_with_historical_update_and_new_row [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:43,116 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_insert_new_rows_in_middle_remains_sorted [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:44,102 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_insert_versions_inbetween_works_ok [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:45,128 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_read_ts_raw_all_version_ok [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:46,189 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_bitemporal_store_saves_as_of_with_timezone [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:47,115 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_bitemporal_store_read_as_of_timezone [32mPASSED[0m[31m [ 18%][0m2021-01-13 15:26:48,075 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_multi_index_ts_read_write [32mPASSED[0m[31m [ 19%][0m2021-01-13 15:26:49,022 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_multi_index_ts_read_raw [32mPASSED[0m[31m [ 19%][0m2021-01-13 15:26:49,972 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_bitemporal_store.py::test_multi_index_update [32mPASSED[0m[31m [ 19%][0m2021-01-13 15:26:50,963 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_metadata_store.py::test_pickle [32mPASSED[0m[31m       [ 19%][0m2021-01-13 15:26:51,736 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_metadata_store.py::test_has_symbol [32mPASSED[0m[31m   [ 19%][0m2021-01-13 15:26:52,504 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_metadata_store.py::test_list_symbols [32mPASSED[0m[31m [ 19%][0m2021-01-13 15:26:53,276 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_metadata_store.py::test_read_history [32mPASSED[0m[31m [ 19%][0m2021-01-13 15:26:54,051 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_metadata_store.py::test_read [32mPASSED[0m[31m         [ 19%][0m2021-01-13 15:26:54,826 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_metadata_store.py::test_write_history [32mPASSED[0m[31m [ 19%][0m2021-01-13 15:26:55,610 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_metadata_store.py::test_append [32mPASSED[0m[31m       [ 19%][0m2021-01-13 15:26:56,406 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_metadata_store.py::test_prepend [32mPASSED[0m[31m      [ 19%][0m2021-01-13 15:26:57,198 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_metadata_store.py::test_pop [32mPASSED[0m[31m          [ 19%][0m2021-01-13 15:26:57,977 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_metadata_store.py::test_purge [32mPASSED[0m[31m        [ 19%][0m2021-01-13 15:26:58,763 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_write_new_column_name_to_arctic_1_40_data [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:26:59,911 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_save_read_simple_ndarray [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:00,829 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_read_simple_ndarray_from_secondary [33mXFAIL[0m[31m [ 20%][0m
tests/integration/store/test_ndarray_store.py::test_save_read_big_1darray[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:06,807 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_save_read_big_1darray[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:11,860 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_save_read_big_1darray[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:16,872 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_save_and_resave_reuses_chunks[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:17,807 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_save_and_resave_reuses_chunks[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:18,756 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_save_and_resave_reuses_chunks[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:19,690 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_save_read_big_2darray[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:24,590 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_save_read_big_2darray[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:30,215 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_save_read_big_2darray[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:35,242 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_get_info_bson_object [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:36,176 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_save_read_ndarray_with_array_field [32mPASSED[0m[31m [ 20%][0m2021-01-13 15:27:37,098 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_save_read_ndarray [32mPASSED[0m[31m [ 21%][0m2021-01-13 15:27:38,007 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_multiple_write[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 21%][0m2021-01-13 15:27:38,927 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_multiple_write[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 21%][0m2021-01-13 15:27:39,846 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_multiple_write[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 21%][0m2021-01-13 15:27:40,804 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_cant_write_objects [32mPASSED[0m[31m [ 21%][0m
tests/integration/store/test_ndarray_store.py::test_save_read_large_ndarray [32mPASSED[0m[31m [ 21%][0m2021-01-13 15:27:42,111 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_mutable_ndarray [32mPASSED[0m[31m [ 21%][0m2021-01-13 15:27:43,027 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store.py::test_delete_version_shouldnt_break_read [33mXPASS[0m[31m [ 21%][0m2021-01-13 15:27:43,935 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_simple_ndarray[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 21%][0m2021-01-13 15:27:44,861 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_simple_ndarray[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 21%][0m2021-01-13 15:27:45,801 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_simple_ndarray[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 21%][0m2021-01-13 15:27:46,736 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_simple_ndarray_promoting_types[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 21%][0m2021-01-13 15:27:47,671 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_simple_ndarray_promoting_types[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 21%][0m2021-01-13 15:27:48,599 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_simple_ndarray_promoting_types[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:27:49,513 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_promote_types [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:27:50,458 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_promote_types2 [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:27:51,387 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_promote_types_smaller_sizes [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:27:52,336 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_promote_types_larger_sizes [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:27:53,265 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_promote_field_types_smaller_sizes [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:27:54,178 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_promote_field_types_larger_sizes [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:27:55,098 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_ndarray_with_field_shape[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:27:56,014 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_ndarray_with_field_shape[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:27:56,929 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_ndarray_with_field_shape[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:27:57,853 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_read_large_ndarray[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:28:00,548 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_read_large_ndarray[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:28:03,279 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_read_large_ndarray[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 22%][0m2021-01-13 15:28:05,922 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_save_append_read_ndarray[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:07,331 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_save_append_read_ndarray[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:08,753 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_save_append_read_ndarray[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:10,200 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_save_append_read_1row_ndarray [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:11,635 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_too_large_ndarray [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:13,378 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_field_append_keeps_all_columns [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:14,312 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_promotes_dtype[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:15,240 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_promotes_dtype[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:16,178 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_promotes_dtype[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:17,125 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_promotes_dtype2 [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:18,063 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_promotes_dtype3 [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:19,001 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_convert_to_structured_array [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:19,911 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_concat_and_rewrite[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:20,893 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_concat_and_rewrite[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 23%][0m2021-01-13 15:28:21,873 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_concat_and_rewrite[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:22,855 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_concat_and_rewrite_2[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:24,026 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_concat_and_rewrite_2[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:25,228 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_concat_and_rewrite_2[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:26,448 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_concat_and_rewrite_3[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:27,441 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_concat_and_rewrite_3[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:28,401 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_empty_append_concat_and_rewrite_3[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:29,358 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_with_extra_columns [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:30,298 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_save_append_delete_append[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:31,229 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_save_append_delete_append[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:32,186 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_save_append_delete_append[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:33,110 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_after_failed_append[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:34,045 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_after_failed_append[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 24%][0m2021-01-13 15:28:34,978 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_after_failed_append[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:35,908 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_ndarray_store_append.py::test_append_reorder_columns [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:36,812 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_write_multi_column_to_arctic_1_40_data [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:37,740 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_series [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:38,644 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_series_maintains_name [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:39,555 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_series_with_multiindex [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:40,492 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_series_with_multiindex_and_name [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:41,422 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_series_with_unicode_index_name 2021-01-13 15:28:42,565 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 25%][0m
tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe_with_multiindex [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:43,579 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe_with_none_values [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:44,490 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe_with_unicode_index_name [31mFAILED[0m[31m [ 25%][0m
tests/integration/store/test_pandas_store.py::test_cant_write_pandas_series_with_tuple_values [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:46,494 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_series_with_datetimeindex_with_timezone [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:47,399 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_series_with_datetimeindex [32mPASSED[0m[31m [ 25%][0m2021-01-13 15:28:48,311 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe_with_datetimeindex_with_timezone [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:49,212 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_empty_series_with_datetime_multiindex_with_timezone [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:50,131 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe_with_datetimeindex [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:51,064 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe_with_strings [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:51,987 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:52,900 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_empty_dataframe [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:53,810 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe2 [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:54,736 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe_strings [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:55,668 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe_empty_multiindex [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:56,607 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe_empty_multiindex_and_no_columns [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:57,529 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe_multiindex_and_no_columns [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:58,465 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_append_pandas_multi_columns_dataframe [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:28:59,396 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_append_pandas_multi_columns_dataframe_new_column [32mPASSED[0m[31m [ 26%][0m2021-01-13 15:29:00,380 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_multi_columns_empty_dataframe [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:01,322 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_multi_columns_dataframe [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:02,248 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_multi_columns_no_names_dataframe [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:03,171 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_pandas_multi_columns_dataframe_with_int_levels [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:04,121 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_multi_index_and_multi_columns_dataframe [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:05,051 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_append_pandas_dataframe [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:05,986 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_empty_dataframe_multindex [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:06,906 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_append_empty [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:07,836 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_empy_dataframe_append [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:08,770 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_append_empty_multiindex [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:09,708 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_empty_dataframe_append_multiindex [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:10,646 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_empty_dataframe_should_ignore_dtype [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:11,586 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_empty_dataframe_should_ignore_dtype2 [32mPASSED[0m[31m [ 27%][0m2021-01-13 15:29:12,516 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_append_should_promote_string_column [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:13,444 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_append_should_add_new_column [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:14,377 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_append_should_add_new_columns_and_reorder [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:15,319 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size0] [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:16,234 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size1] [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:17,162 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size2] [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:18,080 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size3] [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:18,987 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size4] [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:19,900 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size5] [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:20,823 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size6] [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:21,751 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size7] [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:22,669 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size8] [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:23,588 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size9] [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:24,506 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size10] [32mPASSED[0m[31m [ 28%][0m2021-01-13 15:29:25,434 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size11] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:26,365 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size12] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:27,303 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size13] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:28,237 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size14] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:29,151 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size15] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:30,119 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size16] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:31,057 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size17] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:31,978 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size18] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:32,901 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_read[df_size19] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:33,815 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size0] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:34,730 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size1] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:35,678 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size2] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:36,611 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size3] [32mPASSED[0m[31m [ 29%][0m2021-01-13 15:29:37,527 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size4] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:38,443 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size5] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:39,362 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size6] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:40,293 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size7] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:41,217 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size8] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:42,143 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size9] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:43,059 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size10] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:43,965 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size11] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:44,884 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size12] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:45,820 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size13] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:46,741 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size14] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:47,682 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size15] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:48,586 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size16] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:49,494 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size17] [32mPASSED[0m[31m [ 30%][0m2021-01-13 15:29:50,426 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size18] [32mPASSED[0m[31m [ 31%][0m2021-01-13 15:29:51,361 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_dataframe_save_append_read[df_size19] [32mPASSED[0m[31m [ 31%][0m2021-01-13 15:29:52,280 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_large_dataframe_append_rewrite_same_item [32mPASSED[0m[31m [ 31%][0m2021-01-13 15:29:53,719 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_large_dataframe_rewrite_same_item [32mPASSED[0m[31m [ 31%][0m2021-01-13 15:29:56,317 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_append_after_truncate_after_append [32mPASSED[0m[31m [ 31%][0m2021-01-13 15:29:57,296 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_can_write_pandas_df_with_object_columns [32mPASSED[0m[31m [ 31%][0m2021-01-13 15:29:58,234 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_panel_save_read[df_size0] [33mXFAIL[0m[31m [ 31%][0m
tests/integration/store/test_pandas_store.py::test_panel_save_read[df_size1] 2021-01-13 15:30:00,276 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:00,276 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:00,276 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[33mXFAIL[0m[31m [ 31%][0m
tests/integration/store/test_pandas_store.py::test_panel_save_read[df_size2] [33mXFAIL[0m[31m [ 31%][0m
tests/integration/store/test_pandas_store.py::test_panel_save_read[df_size3] [33mXFAIL[0m[31m [ 31%][0m
tests/integration/store/test_pandas_store.py::test_panel_save_read[df_size4] [33mXFAIL[0m[31m [ 31%][0m
tests/integration/store/test_pandas_store.py::test_panel_save_read[df_size5] 2021-01-13 15:30:04,499 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:04,499 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:04,500 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:04,500 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[33mXFAIL[0m[31m [ 31%][0m
tests/integration/store/test_pandas_store.py::test_panel_save_read[df_size6] [33mXFAIL[0m[31m [ 31%][0m
tests/integration/store/test_pandas_store.py::test_panel_save_read[df_size7] [33mXFAIL[0m[31m [ 32%][0m
tests/integration/store/test_pandas_store.py::test_panel_save_read[df_size8] [33mXFAIL[0m[31m [ 32%][0m
tests/integration/store/test_pandas_store.py::test_panel_save_read[df_size9] [33mXFAIL[0m[31m [ 32%][0m
tests/integration/store/test_pandas_store.py::test_panel_save_read_with_nans [33mXFAIL[0m[31m [ 32%][0m
tests/integration/store/test_pandas_store.py::test_save_read_ints [32mPASSED[0m[31m [ 32%][0m2021-01-13 15:30:11,177 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_save_read_datetimes [32mPASSED[0m[31m [ 32%][0m2021-01-13 15:30:12,105 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_labels [32mPASSED[0m[31m         [ 32%][0m2021-01-13 15:30:13,028 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_duplicate_labels [32mPASSED[0m[31m [ 32%][0m2021-01-13 15:30:13,973 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_no_labels [32mPASSED[0m[31m      [ 32%][0m2021-01-13 15:30:14,912 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_no_index_labels 2021-01-13 15:30:16,008 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:16,008 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:16,008 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:16,008 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:16,009 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:16,009 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[33mXFAIL[0m[31m [ 32%][0m
tests/integration/store/test_pandas_store.py::test_not_unique [32mPASSED[0m[31m     [ 32%][0m2021-01-13 15:30:17,642 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_daterange_end [32mPASSED[0m[31m  [ 32%][0m2021-01-13 15:30:19,631 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_daterange_start [32mPASSED[0m[31m [ 32%][0m2021-01-13 15:30:21,653 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_daterange_with_zero_index [32mPASSED[0m[31m [ 33%][0m2021-01-13 15:30:22,656 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_daterange_large_DataFrame [31mFAILED[0m[31m [ 33%][0m
tests/integration/store/test_pandas_store.py::test_daterange_large_DataFrame_middle [31mFAILED[0m[31m [ 33%][0m
tests/integration/store/test_pandas_store.py::test_daterange[df0-assert_frame_equal] [31mFAILED[0m[31m [ 33%][0m
tests/integration/store/test_pandas_store.py::test_daterange[df1-assert_series_equal] [31mFAILED[0m[31m [ 33%][0m
tests/integration/store/test_pandas_store.py::test_daterange_append [31mFAILED[0m[31m [ 33%][0m
tests/integration/store/test_pandas_store.py::test_daterange_single_chunk [32mPASSED[0m[31m [ 33%][0m2021-01-13 15:30:30,416 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_daterange_when_end_beyond_chunk_index [32mPASSED[0m[31m [ 33%][0m2021-01-13 15:30:31,361 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_daterange_when_end_beyond_chunk_index_no_start [32mPASSED[0m[31m [ 33%][0m2021-01-13 15:30:32,298 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_daterange_fails_with_timezone_start [32mPASSED[0m[31m [ 33%][0m2021-01-13 15:30:33,245 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_data_info_series [32mPASSED[0m[31m [ 33%][0m2021-01-13 15:30:34,181 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_data_info_df [32mPASSED[0m[31m   [ 33%][0m2021-01-13 15:30:35,107 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_data_info_cols [32mPASSED[0m[31m [ 33%][0m2021-01-13 15:30:36,047 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_read_write_multiindex_store_keeps_timezone [32mPASSED[0m[31m [ 33%][0m2021-01-13 15:30:37,008 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_mutable_df [32mPASSED[0m[31m     [ 34%][0m2021-01-13 15:30:37,944 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_forced_encodings_with_df_mixed_types [33mSKIPPED[0m[31m [ 34%][0m
tests/integration/store/test_pandas_store.py::test_forced_encodings_with_df [33mSKIPPED[0m[31m [ 34%][0m
tests/integration/store/test_pandas_store.py::test_forced_encodings_with_df_py3 [32mPASSED[0m[31m [ 34%][0m2021-01-13 15:30:38,891 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pandas_store.py::test_forced_encodings_with_df_py3_multi_index [32mPASSED[0m[31m [ 34%][0m2021-01-13 15:30:39,874 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pickle_store.py::test_save_read_bson [32mPASSED[0m[31m [ 34%][0m2021-01-13 15:30:40,814 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pickle_store.py::test_save_read_big_encodable [32mPASSED[0m[31m [ 34%][0m2021-01-13 15:30:41,851 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pickle_store.py::test_save_read_bson_object [32mPASSED[0m[31m [ 34%][0m2021-01-13 15:30:42,779 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pickle_store.py::test_get_info_bson_object [32mPASSED[0m[31m [ 34%][0m2021-01-13 15:30:43,702 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pickle_store.py::test_bson_large_object [32mPASSED[0m[31m [ 34%][0m2021-01-13 15:30:44,979 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pickle_store.py::test_bson_leak_objects_delete [32mPASSED[0m[31m [ 34%][0m2021-01-13 15:30:45,905 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pickle_store.py::test_bson_leak_objects_prune_previous [32mPASSED[0m[31m [ 34%][0m2021-01-13 15:30:46,843 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pickle_store.py::test_prune_previous_doesnt_kill_other_objects [32mPASSED[0m[31m [ 34%][0m2021-01-13 15:30:47,788 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_pickle_store.py::test_write_metadata [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:30:48,705 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_store_item_new_version [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:30:49,634 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_store_item_read_preference [33mXFAIL[0m[31m [ 35%][0m
tests/integration/store/test_version_store.py::test_read_item_read_preference_SECONDARY [33mXFAIL[0m[31m [ 35%][0m
tests/integration/store/test_version_store.py::test_store_item_metadata[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:30:52,630 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_store_item_metadata[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:30:53,543 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_store_item_metadata[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:30:54,456 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_metadata[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:30:55,378 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_metadata[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:30:56,308 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_metadata[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:30:57,217 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_metadata_newer_version_with_lower_id[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:30:58,133 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_metadata_newer_version_with_lower_id[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:30:59,064 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_metadata_newer_version_with_lower_id[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:30:59,981 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_metadata_throws_on_deleted_symbol[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 35%][0m2021-01-13 15:31:00,923 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_metadata_throws_on_deleted_symbol[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:01,853 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_metadata_throws_on_deleted_symbol[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:02,783 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_store_item_and_update[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:06,758 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_store_item_and_update[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:10,772 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_store_item_and_update[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:14,790 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_update[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:15,846 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_update[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:16,897 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_update[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:17,930 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:18,865 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:19,796 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:20,744 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_should_overwrite_after_delete[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:21,715 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_should_overwrite_after_delete[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 36%][0m2021-01-13 15:31:22,692 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_should_overwrite_after_delete[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:23,663 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_empty_ts[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:24,605 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_empty_ts[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:25,548 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_empty_ts[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:26,504 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_corrupted_new_version[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:27,471 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_corrupted_new_version[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:28,445 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_corrupted_new_version[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:29,409 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_query_version_as_of_int [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:30,371 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_version[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:31,334 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_version[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:32,284 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_version[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:33,245 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_version_deleted [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:34,174 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_version_latest_only [32mPASSED[0m[31m [ 37%][0m2021-01-13 15:31:35,147 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_version_snapshot [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:36,136 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_versions[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:37,107 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_versions[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:38,086 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_versions[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:39,068 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_bson_versions[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:40,012 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_bson_versions[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:40,964 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_bson_versions[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:41,904 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_none_does_not_exception[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:42,835 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_none_does_not_exception[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:43,768 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_read_none_does_not_exception[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:44,683 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_item_has_symbol[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:45,658 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_item_has_symbol[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:46,635 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_item_has_symbol[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:47,598 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_item_snapshot[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 38%][0m2021-01-13 15:31:48,594 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_item_snapshot[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:31:49,578 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_item_snapshot[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:31:50,559 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_has_symbol [32mPASSED[0m[31m    [ 39%][0m2021-01-13 15:31:51,469 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:31:52,449 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:31:53,439 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:31:54,421 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_with_versions[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:31:55,420 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_with_versions[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:31:56,404 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_with_versions[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:31:57,395 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_exclusion[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:31:58,332 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_exclusion[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:31:59,248 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_exclusion[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:32:00,167 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_delete[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 39%][0m2021-01-13 15:32:01,121 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_delete[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:02,084 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_delete[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:03,037 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_multiple_snapshots[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:04,018 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_multiple_snapshots[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:04,987 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_multiple_snapshots[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:05,966 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_delete_identical_snapshots [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:06,907 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_snapshots [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:07,977 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_duplicate_snapshots [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:08,902 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_multiple_versions[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:09,845 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_multiple_versions[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:10,788 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_multiple_versions[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:11,723 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_doesnt_prune_snapshots[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:12,667 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_doesnt_prune_snapshots[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 40%][0m2021-01-13 15:32:13,622 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_doesnt_prune_snapshots[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:14,578 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_multiple_versions_ts[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:15,581 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_multiple_versions_ts[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:16,571 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_multiple_versions_ts[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:17,542 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_doesnt_prune_snapshots_ts[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:18,555 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_doesnt_prune_snapshots_ts[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:19,566 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_doesnt_prune_snapshots_ts[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:20,581 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_multiple_versions_fully_different_tss[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:21,555 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_multiple_versions_fully_different_tss[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:22,536 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_multiple_versions_fully_different_tss[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:23,513 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_doesnt_prune_snapshots_fully_different_tss[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:24,547 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_doesnt_prune_snapshots_fully_different_tss[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:25,583 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_doesnt_prune_snapshots_fully_different_tss[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:26,628 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_previous_version_append_interaction[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 41%][0m2021-01-13 15:32:27,697 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_previous_version_append_interaction[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:28,791 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prunes_previous_version_append_interaction[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:29,860 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:31,411 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:32,938 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:33,848 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_regex[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:34,781 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_regex[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:35,722 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_regex[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:36,661 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_newer_version_with_lower_id[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:37,587 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_newer_version_with_lower_id[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:38,533 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_newer_version_with_lower_id[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:39,471 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_write_snapshot_write_delete[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:40,424 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_write_snapshot_write_delete[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 42%][0m2021-01-13 15:32:41,363 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_write_snapshot_write_delete[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 43%][0m2021-01-13 15:32:42,320 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_delete_write[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 43%][0m2021-01-13 15:32:43,254 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_delete_write[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 43%][0m2021-01-13 15:32:44,181 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_list_symbols_delete_write[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 43%][0m2021-01-13 15:32:45,102 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_date_range_large[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 43%][0m2021-01-13 15:32:46,178 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_date_range_large[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 43%][0m2021-01-13 15:32:47,257 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_date_range_large[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 43%][0m2021-01-13 15:32:48,347 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_after_empty[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 43%][0m2021-01-13 15:32:52,720 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_after_empty[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 43%][0m2021-01-13 15:32:57,063 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_after_empty[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 43%][0m2021-01-13 15:33:01,467 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_metadata[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 43%][0m
tests/integration/store/test_version_store.py::test_write_metadata[FwPointersCfg.HYBRID] 2021-01-13 15:33:03,618 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 43%][0m
tests/integration/store/test_version_store.py::test_write_metadata[FwPointersCfg.ENABLED] [31mFAILED[0m[31m [ 43%][0m
tests/integration/store/test_version_store.py::test_write_metadata_followed_by_append[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 43%][0m
tests/integration/store/test_version_store.py::test_write_metadata_followed_by_append[FwPointersCfg.HYBRID] [31mFAILED[0m[31m [ 44%][0m
tests/integration/store/test_version_store.py::test_write_metadata_followed_by_append[FwPointersCfg.ENABLED] 2021-01-13 15:33:13,981 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:13,982 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:13,982 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:13,982 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 44%][0m
tests/integration/store/test_version_store.py::test_write_metadata_new_symbol[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 44%][0m2021-01-13 15:33:14,992 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_metadata_new_symbol[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 44%][0m2021-01-13 15:33:15,928 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_metadata_new_symbol[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 44%][0m2021-01-13 15:33:16,848 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_metadata_after_append[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 44%][0m2021-01-13 15:33:17,781 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_metadata_after_append[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 44%][0m2021-01-13 15:33:18,717 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_metadata_after_append[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 44%][0m2021-01-13 15:33:19,668 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_metadata_purge_previous_versions[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 44%][0m
tests/integration/store/test_version_store.py::test_write_metadata_purge_previous_versions[FwPointersCfg.HYBRID] [31mFAILED[0m[31m [ 44%][0m
tests/integration/store/test_version_store.py::test_write_metadata_purge_previous_versions[FwPointersCfg.ENABLED] [31mFAILED[0m[31m [ 44%][0m
tests/integration/store/test_version_store.py::test_write_metadata_delete_symbol[FwPointersCfg.DISABLED] 2021-01-13 15:33:29,924 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:29,925 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:29,925 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:29,925 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 44%][0m
tests/integration/store/test_version_store.py::test_write_metadata_delete_symbol[FwPointersCfg.HYBRID] [31mFAILED[0m[31m [ 44%][0m
tests/integration/store/test_version_store.py::test_write_metadata_delete_symbol[FwPointersCfg.ENABLED] [31mFAILED[0m[31m [ 45%][0m
tests/integration/store/test_version_store.py::test_write_metadata_snapshots[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 45%][0m
tests/integration/store/test_version_store.py::test_write_metadata_snapshots[FwPointersCfg.HYBRID] 2021-01-13 15:33:34,236 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:34,236 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:34,237 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:34,237 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 45%][0m
tests/integration/store/test_version_store.py::test_write_metadata_snapshots[FwPointersCfg.ENABLED] [31mFAILED[0m[31m [ 45%][0m
tests/integration/store/test_version_store.py::test_restore_version[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 45%][0m
tests/integration/store/test_version_store.py::test_restore_version[FwPointersCfg.HYBRID] [31mFAILED[0m[31m [ 45%][0m
tests/integration/store/test_version_store.py::test_restore_version[FwPointersCfg.ENABLED] 2021-01-13 15:33:38,512 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:38,513 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:38,513 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:38,513 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 45%][0m
tests/integration/store/test_version_store.py::test_restore_version_followed_by_append[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 45%][0m2021-01-13 15:33:41,564 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_restore_version_followed_by_append[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 45%][0m2021-01-13 15:33:44,563 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_restore_version_followed_by_append[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 45%][0m2021-01-13 15:33:47,531 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_restore_version_purging_previous_versions[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 45%][0m
tests/integration/store/test_version_store.py::test_restore_version_purging_previous_versions[FwPointersCfg.HYBRID] [31mFAILED[0m[31m [ 45%][0m
tests/integration/store/test_version_store.py::test_restore_version_purging_previous_versions[FwPointersCfg.ENABLED] [31mFAILED[0m[31m [ 45%][0m
tests/integration/store/test_version_store.py::test_restore_version_non_existent_version[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_non_existent_version[FwPointersCfg.HYBRID] 2021-01-13 15:33:58,752 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:58,753 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:58,754 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:58,754 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:33:58,754 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_non_existent_version[FwPointersCfg.ENABLED] [31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_which_updated_only_metadata[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_which_updated_only_metadata[FwPointersCfg.HYBRID] [31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_which_updated_only_metadata[FwPointersCfg.ENABLED] [31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_then_snapshot[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_then_snapshot[FwPointersCfg.HYBRID] [31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_then_snapshot[FwPointersCfg.ENABLED] 2021-01-13 15:34:06,213 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:06,214 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:06,214 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_latest_snapshot_noop[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_latest_snapshot_noop[FwPointersCfg.HYBRID] [31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_latest_snapshot_noop[FwPointersCfg.ENABLED] [31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_latest_version_noop[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_latest_version_noop[FwPointersCfg.HYBRID] 2021-01-13 15:34:11,403 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:11,403 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:11,403 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:11,403 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:11,404 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 46%][0m
tests/integration/store/test_version_store.py::test_restore_version_latest_version_noop[FwPointersCfg.ENABLED] [31mFAILED[0m[31m [ 47%][0m
tests/integration/store/test_version_store.py::test_restore_version_snap_delete_symbol_restore[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 47%][0m
tests/integration/store/test_version_store.py::test_restore_version_snap_delete_symbol_restore[FwPointersCfg.HYBRID] [31mFAILED[0m[31m [ 47%][0m
tests/integration/store/test_version_store.py::test_restore_version_snap_delete_symbol_restore[FwPointersCfg.ENABLED] 2021-01-13 15:34:15,683 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:15,683 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:15,684 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:15,684 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 47%][0m
tests/integration/store/test_version_store.py::test_restore_from_version_with_deleted_symbol[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 47%][0m2021-01-13 15:34:16,686 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_restore_from_version_with_deleted_symbol[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 47%][0m2021-01-13 15:34:17,611 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_restore_from_version_with_deleted_symbol[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 47%][0m2021-01-13 15:34:18,541 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_previous_versions_retries_on_cleanup_error[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 47%][0m2021-01-13 15:34:19,508 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_previous_versions_retries_on_cleanup_error[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 47%][0m2021-01-13 15:34:20,474 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_previous_versions_retries_on_cleanup_error[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 47%][0m2021-01-13 15:34:21,442 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_previous_versions_retries_find_calls[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 47%][0m2021-01-13 15:34:22,364 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_previous_versions_retries_find_calls[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 47%][0m2021-01-13 15:34:23,287 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_previous_versions_retries_find_calls[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 47%][0m2021-01-13 15:34:24,212 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_append_does_not_duplicate_data_when_prune_fails[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 48%][0m
tests/integration/store/test_version_store.py::test_append_does_not_duplicate_data_when_prune_fails[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 48%][0m
tests/integration/store/test_version_store.py::test_append_does_not_duplicate_data_when_prune_fails[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 48%][0m
tests/integration/store/test_version_store.py::test_write_does_not_succeed_with_a_prune_error[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 48%][0m2021-01-13 15:34:28,067 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_does_not_succeed_with_a_prune_error[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 48%][0m2021-01-13 15:34:28,987 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_does_not_succeed_with_a_prune_error[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 48%][0m2021-01-13 15:34:29,893 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_keeps_version[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 48%][0m2021-01-13 15:34:30,828 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_keeps_version[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 48%][0m2021-01-13 15:34:31,771 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_keeps_version[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 48%][0m2021-01-13 15:34:32,677 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_empty_string_column_name [32mPASSED[0m[31m [ 48%][0m2021-01-13 15:34:33,580 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_list_versions_after_delete[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 48%][0m2021-01-13 15:34:34,496 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_list_versions_after_delete[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 48%][0m2021-01-13 15:34:35,411 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_snapshot_list_versions_after_delete[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 48%][0m2021-01-13 15:34:36,329 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_non_serializable_throws [32mPASSED[0m[31m [ 48%][0m2021-01-13 15:34:37,242 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_non_serializable_pickling_default[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:38,166 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_non_serializable_pickling_default[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:39,087 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_non_serializable_pickling_default[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:39,995 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_strict_no_daterange[FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:40,906 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_strict_no_daterange[FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:41,822 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_strict_no_daterange[FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:42,747 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_handler_check_default_false [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:43,638 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_handler_check_default_osenviron [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:44,528 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_handler_check_set_false [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:45,431 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_handler_check_set_true [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:46,333 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_df_with_objects_in_index [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:47,281 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_series_with_objects_in_index [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:48,208 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_series_with_some_objects[input_series0] [32mPASSED[0m[31m [ 49%][0m2021-01-13 15:34:49,133 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_write_series_with_some_objects[input_series1] [32mPASSED[0m[31m [ 50%][0m2021-01-13 15:34:50,067 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_df[FwPointersCfg.DISABLED] [31mFAILED[0m[31m [ 50%][0m
tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_df[FwPointersCfg.HYBRID] [31mFAILED[0m[31m [ 50%][0m
tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_df[FwPointersCfg.ENABLED] [31mFAILED[0m[31m [ 50%][0m
tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_series[FwPointersCfg.DISABLED] 2021-01-13 15:34:54,218 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:54,219 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:54,219 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:54,219 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 50%][0m
tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_series[FwPointersCfg.HYBRID] [31mFAILED[0m[31m [ 50%][0m
tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_series[FwPointersCfg.ENABLED] [31mFAILED[0m[31m [ 50%][0m
tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.DISABLED-FwPointersCfg.DISABLED-FwPointersCfg.DISABLED-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 50%][0m2021-01-13 15:34:57,304 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.ENABLED-FwPointersCfg.ENABLED-FwPointersCfg.ENABLED-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 50%][0m2021-01-13 15:34:58,292 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.HYBRID-FwPointersCfg.HYBRID-FwPointersCfg.HYBRID-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 50%][0m2021-01-13 15:34:59,296 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.HYBRID-FwPointersCfg.DISABLED-FwPointersCfg.HYBRID-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 50%][0m2021-01-13 15:35:00,299 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.HYBRID-FwPointersCfg.ENABLED-FwPointersCfg.HYBRID-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 50%][0m2021-01-13 15:35:01,296 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.ENABLED-FwPointersCfg.HYBRID-FwPointersCfg.ENABLED-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 50%][0m2021-01-13 15:35:02,274 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.DISABLED-FwPointersCfg.HYBRID-FwPointersCfg.DISABLED-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:03,253 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.DISABLED-FwPointersCfg.ENABLED-FwPointersCfg.DISABLED-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:04,243 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.ENABLED-FwPointersCfg.DISABLED-FwPointersCfg.ENABLED-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:05,241 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.ENABLED-FwPointersCfg.ENABLED-FwPointersCfg.DISABLED-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:06,264 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.ENABLED-FwPointersCfg.ENABLED-FwPointersCfg.HYBRID-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:07,311 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_mixed_scenarios[FwPointersCfg.ENABLED-FwPointersCfg.ENABLED-FwPointersCfg.HYBRID-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:08,346 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointers_writemetadata_enabled_disabled [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:09,346 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_fwpointer_enabled_write_delete_keep_version_append [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:10,338 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_version_arctic_version [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:11,266 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_mixed_fwpointer_configs [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:18,703 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_crossref_fwpointer_configs[FwPointersCfg.DISABLED-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:23,203 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_crossref_fwpointer_configs[FwPointersCfg.DISABLED-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:27,792 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_crossref_fwpointer_configs[FwPointersCfg.HYBRID-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:32,573 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_crossref_fwpointer_configs[FwPointersCfg.HYBRID-FwPointersCfg.ENABLED] [32mPASSED[0m[31m [ 51%][0m2021-01-13 15:35:37,726 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_crossref_fwpointer_configs[FwPointersCfg.ENABLED-FwPointersCfg.HYBRID] [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:42,348 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store.py::test_prune_crossref_fwpointer_configs[FwPointersCfg.ENABLED-FwPointersCfg.DISABLED] [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:46,841 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_audit.py::test_ArcticTransaction_can_do_first_writes [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:47,812 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_audit.py::test_ArcticTransaction_detects_concurrent_writes [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:48,801 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_audit.py::test_audit_writes [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:49,769 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_audit.py::test_metadata_changes_writes [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:50,768 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_audit.py::test_audit_read [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:51,774 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_audit.py::test_cleanup_orphaned_versions_integration [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:52,733 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_audit.py::test_corrupted_read_writes_new [32mPASSED[0m[31m [ 52%][0m
tests/integration/store/test_version_store_audit.py::test_write_after_delete [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:54,686 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_audit.py::test_ArcticTransaction_write_skips_for_exact_match [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:55,676 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_audit.py::test_ArcticTransaction_write_doesnt_skip_for_close_ts [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:56,651 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_corruption.py::test_no_corruption_restore_append_overlapping [32mPASSED[0m[31m [ 52%][0m2021-01-13 15:35:59,262 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_corruption.py::test_no_corruption_restore_writemeta_append [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:01,638 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_corruption.py::test_no_corruption_restore_append_non_overlapping_tstamps [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:05,745 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_corruption.py::test_restore_append_overlapping_corrupts_old [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:07,444 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_corruption.py::test_restore_append_overlapping_corrupts_last [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:09,131 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_corruption.py::test_append_fail_after_delete_noupsert [33mSKIPPED[0m[31m [ 53%][0m
tests/integration/store/test_version_store_corruption.py::test_append_without_corrupt_check [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:17,207 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_corruption.py::test_append_with_corrupt_check [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:18,921 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_corruption.py::test_fast_check_corruption [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:19,940 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/store/test_version_store_corruption.py::test_fast_is_safe_to_append [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:33,826 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_return_libraries_for_the_given_daterange[start0-end0-expected0] [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:34,586 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_return_libraries_for_the_given_daterange[start1-end1-expected1] [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:35,367 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_return_libraries_for_the_given_daterange[start2-end2-expected2] [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:36,124 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_return_libraries_for_the_given_daterange[start3-end3-expected3] [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:36,876 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_return_libraries_for_the_given_daterange[start4-end4-expected4] [32mPASSED[0m[31m [ 53%][0m2021-01-13 15:36:37,630 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_return_libraries_for_the_given_daterange[start5-end5-expected5] [32mPASSED[0m[31m [ 54%][0m2021-01-13 15:36:38,379 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_return_libraries_for_the_given_daterange[start6-end6-expected6] [32mPASSED[0m[31m [ 54%][0m2021-01-13 15:36:39,137 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_return_libraries_for_the_given_daterange[start7-end7-expected7] [32mPASSED[0m[31m [ 54%][0m2021-01-13 15:36:39,896 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_return_libraries_for_the_given_daterange[start8-end8-expected8] [32mPASSED[0m[31m [ 54%][0m2021-01-13 15:36:40,669 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_raise_exceptions_if_no_libraries_are_found_in_the_date_range_when_reading_data [32mPASSED[0m[31m [ 54%][0m2021-01-13 15:36:41,437 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_return_data_when_date_range_falls_in_a_single_underlying_library [31mFAILED[0m[31m [ 54%][0m
tests/integration/tickstore/test_toplevel.py::test_should_return_data_when_date_range_spans_libraries [32mPASSED[0m[31m [ 54%][0m2021-01-13 15:36:43,453 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_return_data_when_date_range_spans_libraries_even_if_one_returns_nothing 2021-01-13 15:36:44,435 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[31mFAILED[0m[31m [ 54%][0m
tests/integration/tickstore/test_toplevel.py::test_should_add_underlying_library_where_none_exists [32mPASSED[0m[31m [ 54%][0m2021-01-13 15:36:45,339 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_add_underlying_library_where_another_library_exists_in_a_non_overlapping_daterange [32mPASSED[0m[31m [ 54%][0m2021-01-13 15:36:46,198 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_raise_exception_if_library_does_not_exist [32mPASSED[0m[31m [ 54%][0m
tests/integration/tickstore/test_toplevel.py::test_should_raise_exception_if_date_range_for_library_overlaps_with_existing_libraries [32mPASSED[0m[31m [ 54%][0m
tests/integration/tickstore/test_toplevel.py::test_should_successfully_do_a_roundtrip_write_and_read_spanning_multiple_underlying_libraries 2021-01-13 15:36:48,911 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
[33mXFAIL[0m[31m [ 54%][0m
tests/integration/tickstore/test_toplevel.py::test_should_list_symbols_from_the_underlying_library[start0-end0-0-10] [32mPASSED[0m[31m [ 55%][0m2021-01-13 15:36:49,964 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_list_symbols_from_the_underlying_library[start1-end1-0-8] [32mPASSED[0m[31m [ 55%][0m2021-01-13 15:36:50,979 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_list_symbols_from_the_underlying_library[start2-end2-7-10] [32mPASSED[0m[31m [ 55%][0m2021-01-13 15:36:52,030 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_add_underlying_libraries_when_intialized [32mPASSED[0m[31m [ 55%][0m2021-01-13 15:36:52,999 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_should_write_top_level_with_list_of_dicts [31mFAILED[0m[31m [ 55%][0m
tests/integration/tickstore/test_toplevel.py::test_should_write_top_level_with_correct_timezone [31mFAILED[0m[31m [ 55%][0m
tests/integration/tickstore/test_toplevel.py::test_min_max_date [32mPASSED[0m[31m   [ 55%][0m2021-01-13 15:36:55,849 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_no_min_max_date [32mPASSED[0m[31m [ 55%][0m2021-01-13 15:36:56,642 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_get_libraries_no_data_raises_exception [32mPASSED[0m[31m [ 55%][0m2021-01-13 15:36:57,399 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_get_libraries_no_data_raises_exception_tzinfo_given [32mPASSED[0m[31m [ 55%][0m2021-01-13 15:36:58,141 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_toplevel.py::test_get_library_metadata [32mPASSED[0m[31m [ 55%][0m2021-01-13 15:36:59,079 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_delete.py::test_delete[tickstore] [32mPASSED[0m[31m [ 55%][0m2021-01-13 15:36:59,882 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_delete.py::test_delete_daterange[tickstore] [32mPASSED[0m[31m [ 55%][0m2021-01-13 15:37:00,681 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read[tickstore] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:01,488 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_data_is_modifiable[tickstore] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:02,281 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_allow_secondary[tickstore] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:03,077 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_symbol_as_column[tickstore] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:03,866 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_multiple_symbols[tickstore] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:04,672 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_all_cols_all_dtypes[tickstore-1] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:05,476 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_all_cols_all_dtypes[tickstore-100] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:06,275 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_date_range[tickstore] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:07,177 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_date_range_end_not_in_range[tickstore] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:07,964 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_date_range_default_timezone[tickstore-UTC] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:08,767 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_date_range_default_timezone[tickstore-Europe/London] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:09,584 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_date_range_default_timezone[tickstore-America/New_York] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:10,415 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_date_range_no_bounds[tickstore] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:11,247 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_date_range_BST[tickstore] [32mPASSED[0m[31m [ 56%][0m2021-01-13 15:37:12,054 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_no_data[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:12,836 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_write_no_tz[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:13,629 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_out_of_order[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:14,438 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_chunk_boundaries[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:15,259 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_spanning_chunks[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:16,056 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_inside_range[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:16,851 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_longs[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:17,665 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_with_image[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:18,482 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_with_metadata[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:19,267 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_strings[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:20,084 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_utf8_strings[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:20,884 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_read_unicode_strings[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:21,680 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_read.py::test_objects_fail[tickstore] [32mPASSED[0m[31m [ 57%][0m2021-01-13 15:37:22,476 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_write.py::test_ts_write_simple[tickstore] [32mPASSED[0m[31m [ 58%][0m2021-01-13 15:37:23,288 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_write.py::test_overlapping_load[tickstore] [32mPASSED[0m[31m [ 58%][0m2021-01-13 15:37:24,080 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_write.py::test_ts_write_pandas[tickstore] [32mPASSED[0m[31m [ 58%][0m2021-01-13 15:37:24,892 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_write.py::test_ts_write_named_col[tickstore] [32mPASSED[0m[31m [ 58%][0m2021-01-13 15:37:25,705 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/integration/tickstore/test_ts_write.py::test_millisecond_roundtrip[tickstore] [32mPASSED[0m[31m [ 58%][0m2021-01-13 15:37:26,497 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping

tests/unit/test_arctic.py::test_arctic_lazy_init [32mPASSED[0m[31m                  [ 58%][0m
tests/unit/test_arctic.py::test_arctic_lazy_init_ssl_true [32mPASSED[0m[31m         [ 58%][0m
tests/unit/test_arctic.py::test_connection_passed_warning_raised [32mPASSED[0m[31m  [ 58%][0m
tests/unit/test_arctic.py::test_arctic_auth [32mPASSED[0m[31m                       [ 58%][0m
tests/unit/test_arctic.py::test_arctic_auth_custom_app_name [32mPASSED[0m[31m       [ 58%][0m
tests/unit/test_arctic.py::test_arctic_connect_hostname [32mPASSED[0m[31m           [ 58%][0m
tests/unit/test_arctic.py::test_arctic_connect_with_environment_name [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_arctic.py::test_database_library_specifier[library-library-arctic] [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_arctic.py::test_database_library_specifier[user.library-library-arctic_user] [32mPASSED[0m[31m [ 58%][0m
tests/unit/test_arctic.py::test_arctic_repr [32mPASSED[0m[31m                       [ 59%][0m
tests/unit/test_arctic.py::test_lib_repr [32mPASSED[0m[31m                          [ 59%][0m
tests/unit/test_arctic.py::test_register_library_type [32mPASSED[0m[31m             [ 59%][0m
tests/unit/test_arctic.py::test_set_quota [32mPASSED[0m[31m                         [ 59%][0m
tests/unit/test_arctic.py::test_get_quota [32mPASSED[0m[31m                         [ 59%][0m
tests/unit/test_arctic.py::test_check_quota_Zero [32mPASSED[0m[31m                  [ 59%][0m
tests/unit/test_arctic.py::test_check_quota_None [32mPASSED[0m[31m                  [ 59%][0m
tests/unit/test_arctic.py::test_check_quota_Zero2 [32mPASSED[0m[31m                 [ 59%][0m
tests/unit/test_arctic.py::test_check_quota_countdown [32mPASSED[0m[31m             [ 59%][0m
tests/unit/test_arctic.py::test_check_quota [32mPASSED[0m[31m                       [ 59%][0m
tests/unit/test_arctic.py::test_check_quota_90_percent [32mPASSED[0m[31m            [ 59%][0m
tests/unit/test_arctic.py::test_check_quota_info [32mPASSED[0m[31m                  [ 59%][0m
tests/unit/test_arctic.py::test_check_quota_exceeded [32mPASSED[0m[31m              [ 59%][0m
tests/unit/test_arctic.py::test_initialize_library [32mPASSED[0m[31m                [ 60%][0m
tests/unit/test_arctic.py::test_initialize_library_too_many_ns [32mPASSED[0m[31m    [ 60%][0m
tests/unit/test_arctic.py::test_initialize_library_with_list_coll_names [32mPASSED[0m[31m [ 60%][0m
tests/unit/test_arctic.py::test_library_exists [32mPASSED[0m[31m                    [ 60%][0m
tests/unit/test_arctic.py::test_library_doesnt_exist [32mPASSED[0m[31m              [ 60%][0m
tests/unit/test_arctic.py::test_get_library [32mPASSED[0m[31m                       [ 60%][0m
tests/unit/test_arctic.py::test_get_library_not_initialized [32mPASSED[0m[31m       [ 60%][0m
tests/unit/test_arctic.py::test_get_library_auth_issue [32mPASSED[0m[31m            [ 60%][0m
tests/unit/test_arctic.py::test_get_library_not_registered [32mPASSED[0m[31m        [ 60%][0m
tests/unit/test_arctic.py::test_mongo_host_get_set [32mPASSED[0m[31m                [ 60%][0m
tests/unit/test_arctic.py::test_arctic_set_get_state [32mPASSED[0m[31m              [ 60%][0m
tests/unit/test_arctic.py::test__conn_auth_issue [32mPASSED[0m[31m                  [ 60%][0m
tests/unit/test_arctic.py::test_reset [32mPASSED[0m[31m                             [ 60%][0m
tests/unit/test_arctic.py::test_ArcticLibraryBinding_db [32mPASSED[0m[31m           [ 61%][0m
tests/unit/test_auth.py::test_authenticate [32mPASSED[0m[31m                        [ 61%][0m
tests/unit/test_auth.py::test_authenticate_fails [32mPASSED[0m[31m                  [ 61%][0m
tests/unit/test_auth.py::test_authenticate_fails_exception [32mPASSED[0m[31m        [ 61%][0m
tests/unit/test_compress.py::test_roundtrip[arctic] [32mPASSED[0m[31m               [ 61%][0m
tests/unit/test_compress.py::test_roundtrip[arcticHC] [32mPASSED[0m[31m             [ 61%][0m
tests/unit/test_compress.py::test_roundtrip_multi[1] [32mPASSED[0m[31m              [ 61%][0m
tests/unit/test_compress.py::test_roundtrip_multi[100.0] [32mPASSED[0m[31m          [ 61%][0m
tests/unit/test_compress.py::test_roundtrip_multi[1000.0] [32mPASSED[0m[31m         [ 61%][0m
tests/unit/test_compress.py::test_roundtrip_multi[1000000.0] [32mPASSED[0m[31m      [ 61%][0m
tests/unit/test_compress.py::test_roundtrip_arr[1-10] [32mPASSED[0m[31m             [ 61%][0m
tests/unit/test_compress.py::test_roundtrip_arr[100-10] [32mPASSED[0m[31m           [ 61%][0m
tests/unit/test_compress.py::test_roundtrip_arr[1000-10] [32mPASSED[0m[31m          [ 61%][0m
tests/unit/test_compress.py::test_roundtrip_arrHC[1-10] [32mPASSED[0m[31m           [ 61%][0m
tests/unit/test_compress.py::test_roundtrip_arrHC[100-10] [32mPASSED[0m[31m         [ 62%][0m
tests/unit/test_compress.py::test_roundtrip_arrHC[1000-10] [32mPASSED[0m[31m        [ 62%][0m
tests/unit/test_compress.py::test_arr_zero [32mPASSED[0m[31m                        [ 62%][0m
tests/unit/test_compression.py::test_compress [32mPASSED[0m[31m                     [ 62%][0m
tests/unit/test_compression.py::test_compress_LZ4 [32mPASSED[0m[31m                 [ 62%][0m
tests/unit/test_compression.py::test_compress_array [32mPASSED[0m[31m               [ 62%][0m
tests/unit/test_compression.py::test_compress_array_usesLZ4 [32mPASSED[0m[31m       [ 62%][0m
tests/unit/test_compression.py::test_compress_array_LZ4_sequential [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_compression.py::test_decompress [32mPASSED[0m[31m                   [ 62%][0m
tests/unit/test_compression.py::test_decompress_array [32mPASSED[0m[31m             [ 62%][0m
tests/unit/test_compression.py::test_compression_equal_regardless_parallel_mode [32mPASSED[0m[31m [ 62%][0m
tests/unit/test_compression.py::test_enable_parallel_lz4 [32mPASSED[0m[31m          [ 62%][0m
tests/unit/test_compression.py::test_compress_empty_string [32mPASSED[0m[31m        [ 62%][0m
tests/unit/test_decorators_unit.py::test_mongo_retry [32mPASSED[0m[31m              [ 63%][0m
tests/unit/test_decorators_unit.py::test_mongo_retry_hook_changes [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_decorators_unit.py::test_mongo_retry_fails [32mPASSED[0m[31m        [ 63%][0m
tests/unit/test_decorators_unit.py::test_retry_nested [32mPASSED[0m[31m             [ 63%][0m
tests/unit/test_decorators_unit.py::test_all_other_exceptions_logged [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_decorators_unit.py::test_other_exceptions_not_logged_outside_of_arctic [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_decorators_unit.py::test_auth_failure_no_retry [33mXFAIL[0m[31m     [ 63%][0m
tests/unit/test_decorators_unit.py::test_duplicate_key_failure_no_retry [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_decorators_unit.py::test_ServerSelectionTimeoutError_no_retry [32mPASSED[0m[31m [ 63%][0m
tests/unit/test_decorators_unit.py::test_get_host [32mPASSED[0m[31m                 [ 63%][0m
tests/unit/test_decorators_unit.py::test_get_host_list [32mPASSED[0m[31m            [ 63%][0m
tests/unit/test_decorators_unit.py::test_get_host_not_a_vs [32mPASSED[0m[31m        [ 63%][0m
tests/unit/test_fixtures.py::test_overlay_library_name [32mPASSED[0m[31m            [ 63%][0m
tests/unit/test_fixtures.py::test_overlay_library [32mPASSED[0m[31m                 [ 64%][0m
tests/unit/test_fixtures.py::test_tickstore_lib [32mPASSED[0m[31m                   [ 64%][0m
tests/unit/test_hooks.py::test_log_exception_hook [32mPASSED[0m[31m                 [ 64%][0m
tests/unit/test_hooks.py::test_get_mongodb_uri_hook [32mPASSED[0m[31m               [ 64%][0m
tests/unit/test_hooks.py::test_get_auth_hook [32mPASSED[0m[31m                      [ 64%][0m
tests/unit/test_hosts.py::test_get_arctic_lib_with_known_host [32mPASSED[0m[31m     [ 64%][0m
tests/unit/test_hosts.py::test_get_arctic_lib_with_unknown_host [32mPASSED[0m[31m   [ 64%][0m
tests/unit/test_hosts.py::test_get_arctic_connection_strings [32mPASSED[0m[31m      [ 64%][0m
tests/unit/test_hosts.py::test_get_arctic_malformed_connection_strings[donkey] [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_hosts.py::test_get_arctic_malformed_connection_strings[donkey:ride@blackpool] [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_hosts.py::test_get_arctic_malformed_connection_strings[donkey:ride] [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_multi_index.py::test__can_create_df_with_multiple_index [32mPASSED[0m[31m [ 64%][0m
tests/unit/test_multi_index.py::test__get_ts__asof_latest [32mPASSED[0m[31m         [ 64%][0m
tests/unit/test_multi_index.py::test__get_ts__asof_datetime [32mPASSED[0m[31m       [ 64%][0m
tests/unit/test_multi_index.py::test__get_ts__unsorted_index [32mPASSED[0m[31m      [ 65%][0m
tests/unit/test_multi_index.py::test_fancy_group_by_multi_index [32mPASSED[0m[31m   [ 65%][0m
tests/unit/test_multi_index.py::test__minmax_last [32mPASSED[0m[31m                 [ 65%][0m
tests/unit/test_multi_index.py::test__minmax_first [32mPASSED[0m[31m                [ 65%][0m
tests/unit/test_multi_index.py::test__within_numeric_first [32mPASSED[0m[31m        [ 65%][0m
tests/unit/test_multi_index.py::test__within_numeric_last [32mPASSED[0m[31m         [ 65%][0m
tests/unit/test_multi_index.py::test__first_within_datetime [32mPASSED[0m[31m       [ 65%][0m
tests/unit/test_multi_index.py::test__last_within_datetime [32mPASSED[0m[31m        [ 65%][0m
tests/unit/test_multi_index.py::test__can_insert_row [32mPASSED[0m[31m              [ 65%][0m
tests/unit/test_multi_index.py::test__can_append_row [32mPASSED[0m[31m              [ 65%][0m
tests/unit/test_multi_index.py::test_fancy_group_by_raises [32mPASSED[0m[31m        [ 65%][0m
tests/unit/test_util.py::test_are_equals_not_df [32mPASSED[0m[31m                   [ 65%][0m
tests/unit/test_util.py::test_enable_sharding_hashed [32mPASSED[0m[31m              [ 65%][0m
tests/unit/chunkstore/test_date_chunker.py::test_date_filter [32mPASSED[0m[31m      [ 66%][0m
tests/unit/chunkstore/test_date_chunker.py::test_date_filter_no_index [32mPASSED[0m[31m [ 66%][0m
tests/unit/chunkstore/test_date_chunker.py::test_date_filter_with_pd_date_range [32mPASSED[0m[31m [ 66%][0m
tests/unit/chunkstore/test_date_chunker.py::test_to_chunks_exceptions [32mPASSED[0m[31m [ 66%][0m
tests/unit/chunkstore/test_date_chunker.py::test_exclude [32mPASSED[0m[31m          [ 66%][0m
tests/unit/chunkstore/test_date_chunker.py::test_exclude_no_index [32mPASSED[0m[31m [ 66%][0m
tests/unit/chunkstore/test_date_chunker.py::test_with_tuples [32mPASSED[0m[31m      [ 66%][0m
tests/unit/chunkstore/test_passthrough_chunker.py::test_pass_thru [32mPASSED[0m[31m [ 66%][0m
tests/unit/date/test_daterange.py::test_daterange_bounding[unbounded_left] [32mPASSED[0m[31m [ 66%][0m
tests/unit/date/test_daterange.py::test_daterange_bounding[unbounded] [32mPASSED[0m[31m [ 66%][0m
tests/unit/date/test_daterange.py::test_daterange_bounding[unbounded_right] [32mPASSED[0m[31m [ 66%][0m
tests/unit/date/test_daterange.py::test_daterange_bounding[open_open] [32mPASSED[0m[31m [ 66%][0m
tests/unit/date/test_daterange.py::test_daterange_bounding[open_closed] [32mPASSED[0m[31m [ 66%][0m
tests/unit/date/test_daterange.py::test_daterange_bounding[closed_open] [32mPASSED[0m[31m [ 66%][0m
tests/unit/date/test_daterange.py::test_daterange_bounding[closed_by_default] [32mPASSED[0m[31m [ 67%][0m
tests/unit/date/test_daterange.py::test_daterange_bounding[closed_explicitly] [32mPASSED[0m[31m [ 67%][0m
tests/unit/date/test_daterange.py::test_daterange_arg_parsing[date_range0] [32mPASSED[0m[31m [ 67%][0m
tests/unit/date/test_daterange.py::test_daterange_arg_parsing[date_range1] [32mPASSED[0m[31m [ 67%][0m
tests/unit/date/test_daterange.py::test_daterange_arg_parsing[date_range2] [32mPASSED[0m[31m [ 67%][0m
tests/unit/date/test_daterange.py::test_daterange_arg_parsing[date_range3] [32mPASSED[0m[31m [ 67%][0m
tests/unit/date/test_daterange.py::test_daterange_eq [32mPASSED[0m[31m              [ 67%][0m
tests/unit/date/test_daterange.py::test_daterange_hash [32mPASSED[0m[31m            [ 67%][0m
tests/unit/date/test_daterange.py::test_daterange_invalid_start [32mPASSED[0m[31m   [ 67%][0m
tests/unit/date/test_daterange.py::test_daterange_invalid_end [32mPASSED[0m[31m     [ 67%][0m
tests/unit/date/test_daterange.py::test_daterange_index [32mPASSED[0m[31m           [ 67%][0m
tests/unit/date/test_daterange.py::test_daterange_index_error [32mPASSED[0m[31m     [ 67%][0m
tests/unit/date/test_daterange.py::test_as_dates [32mPASSED[0m[31m                  [ 67%][0m
tests/unit/date/test_daterange.py::test_string_to_daterange[20110101-expected_ts0-expected_dt0] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_string_to_daterange[20110101-20110102-expected_ts1-expected_dt1] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_string_to_daterange[201101011030-expected_ts2-expected_dt2] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_string_to_daterange[-201101011030-expected_ts3-expected_dt3] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_string_to_daterange[201101011030--expected_ts4-expected_dt4] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_string_to_daterange[(20110101-20110102)-expected_ts5-expected_dt5] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_string_to_daterange[(20110101-20110102]-expected_ts6-expected_dt6] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_string_to_daterange[[20110101-20110102)-expected_ts7-expected_dt7] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_string_to_daterange[[20110101-20110102]-expected_ts8-expected_dt8] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_string_to_daterange_raises [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_mongo_query[date_range0-expected0] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_mongo_query[date_range1-expected1] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_mongo_query[date_range2-expected2] [32mPASSED[0m[31m [ 68%][0m
tests/unit/date/test_daterange.py::test_mongo_query[date_range3-expected3] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_mongo_query[date_range4-expected4] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_mongo_query[date_range5-expected5] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_mongo_query[date_range6-expected6] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_mongo_query[date_range7-expected7] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_get_date_bounds[date_range0-expected0] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_get_date_bounds[date_range1-expected1] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_get_date_bounds[date_range2-expected2] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_get_date_bounds[date_range3-expected3] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_get_date_bounds[date_range4-expected4] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_get_date_bounds[date_range5-expected5] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_get_date_bounds[date_range6-expected6] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_get_date_bounds[date_range7-expected7] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_intersection_with_self[dr0] [32mPASSED[0m[31m [ 69%][0m
tests/unit/date/test_daterange.py::test_intersection_with_self[dr1] [32mPASSED[0m[31m [ 70%][0m
tests/unit/date/test_daterange.py::test_intersection_with_self[dr2] [32mPASSED[0m[31m [ 70%][0m
tests/unit/date/test_daterange.py::test_intersection_with_self[dr3] [32mPASSED[0m[31m [ 70%][0m
tests/unit/date/test_daterange.py::test_intersection_with_self[dr4] [32mPASSED[0m[31m [ 70%][0m
tests/unit/date/test_daterange.py::test_intersection_with_self[dr5] [32mPASSED[0m[31m [ 70%][0m
tests/unit/date/test_daterange.py::test_intersection_with_self[dr6] [32mPASSED[0m[31m [ 70%][0m
tests/unit/date/test_daterange.py::test_intersection_returns_inner_boundaries [32mPASSED[0m[31m [ 70%][0m
tests/unit/date/test_daterange.py::test_intersection_preserves_boundaries [32mPASSED[0m[31m [ 70%][0m
tests/unit/date/test_daterange.py::test_intersection_contains [32mPASSED[0m[31m     [ 70%][0m
tests/unit/date/test_datetime_to_ms_roundtrip.py::test_UTC_roundtrip [32mPASSED[0m[31m [ 70%][0m
tests/unit/date/test_datetime_to_ms_roundtrip.py::test_weird_get_tz_local [32mPASSED[0m[31m [ 70%][0m
tests/unit/date/test_datetime_to_ms_roundtrip.py::test_pytz_London [33mXFAIL[0m[31m [ 70%][0m
tests/unit/date/test_datetime_to_ms_roundtrip.py::test_mktz_London [32mPASSED[0m[31m [ 70%][0m
tests/unit/date/test_datetime_to_ms_roundtrip.py::test_datetime_roundtrip_local_no_tz [32mPASSED[0m[31m [ 71%][0m
tests/unit/date/test_datetime_to_ms_roundtrip.py::test_datetime_roundtrip_local_tz [32mPASSED[0m[31m [ 71%][0m
tests/unit/date/test_datetime_to_ms_roundtrip.py::test_datetime_roundtrip_est_tz [32mPASSED[0m[31m [ 71%][0m
tests/unit/date/test_datetime_to_ms_roundtrip.py::test_millisecond_conversion[807000-1074069004807] [32mPASSED[0m[31m [ 71%][0m
tests/unit/date/test_datetime_to_ms_roundtrip.py::test_millisecond_conversion[807243-1074069004807] [32mPASSED[0m[31m [ 71%][0m
tests/unit/date/test_datetime_to_ms_roundtrip.py::test_millisecond_conversion[807675-1074069004807] [32mPASSED[0m[31m [ 71%][0m
tests/unit/date/test_mktz.py::test_mktz [32mPASSED[0m[31m                           [ 71%][0m
tests/unit/date/test_mktz.py::test_mktz_noarg [32mPASSED[0m[31m                     [ 71%][0m
tests/unit/date/test_mktz.py::test_mktz_zone [32mPASSED[0m[31m                      [ 71%][0m
tests/unit/date/test_mktz.py::test_mktz_fails_if_invalid_timezone [32mPASSED[0m[31m [ 71%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz0-pdt0] [32mPASSED[0m[31m [ 71%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz0-pdt1] [32mPASSED[0m[31m [ 71%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz0-pdt2] [32mPASSED[0m[31m [ 71%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz0-pdt3] [32mPASSED[0m[31m [ 71%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz0-pdt4] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz0-pdt5] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz1-pdt0] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz1-pdt1] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz1-pdt2] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz1-pdt3] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz1-pdt4] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz1-pdt5] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz2-pdt0] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz2-pdt1] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz2-pdt2] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz2-pdt3] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz2-pdt4] [32mPASSED[0m[31m [ 72%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz2-pdt5] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz3-pdt0] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz3-pdt1] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz3-pdt2] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz3-pdt3] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz3-pdt4] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz3-pdt5] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz4-pdt0] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz4-pdt1] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz4-pdt2] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz4-pdt3] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz4-pdt4] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz4-pdt5] [32mPASSED[0m[31m [ 73%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz5-pdt0] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz5-pdt1] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz5-pdt2] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz5-pdt3] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz5-pdt4] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz5-pdt5] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz6-pdt0] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz6-pdt1] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz6-pdt2] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz6-pdt3] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz6-pdt4] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back[local_tz6-pdt5] [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_datetime_to_ms_and_back_microseconds [32mPASSED[0m[31m [ 74%][0m
tests/unit/date/test_util.py::test_daterange_closedclosed_None [32mPASSED[0m[31m    [ 74%][0m
tests/unit/date/test_util.py::test_daterange_closedclosed [32mPASSED[0m[31m         [ 75%][0m
tests/unit/date/test_util.py::test_daterange_closedclosed_no_tz [32mPASSED[0m[31m   [ 75%][0m
tests/unit/date/test_util.py::test_to_dt_0 [32mPASSED[0m[31m                        [ 75%][0m
tests/unit/date/test_util.py::test_to_dt_0_default [32mPASSED[0m[31m                [ 75%][0m
tests/unit/date/test_util.py::test_to_dt_dt_no_tz [32mPASSED[0m[31m                 [ 75%][0m
tests/unit/date/test_util.py::test_to_dt_dt_no_tz_default [32mPASSED[0m[31m         [ 75%][0m
tests/unit/date/test_util.py::test_to_dt_dt_tz [32mPASSED[0m[31m                    [ 75%][0m
tests/unit/date/test_util.py::test_to_dt_dt_tz_default [32mPASSED[0m[31m            [ 75%][0m
tests/unit/date/test_util.py::test_daterange_raises [32mPASSED[0m[31m               [ 75%][0m
tests/unit/date/test_util.py::test_daterange_eq [32mPASSED[0m[31m                   [ 75%][0m
tests/unit/date/test_util.py::test_daterange_lt [32mPASSED[0m[31m                   [ 75%][0m
tests/unit/date/test_util.py::test_utc_dt_to_local_dt [32mPASSED[0m[31m             [ 75%][0m
tests/unit/scripts/test_arctic_create_user.py::test_main_minimal [32mPASSED[0m[31m  [ 75%][0m
tests/unit/scripts/test_arctic_create_user.py::test_main_with_db [32mPASSED[0m[31m  [ 76%][0m
tests/unit/scripts/test_arctic_create_user.py::test_main_with_db_write [32mPASSED[0m[31m [ 76%][0m
tests/unit/scripts/test_arctic_create_user.py::test_no_auth [32mPASSED[0m[31m       [ 76%][0m
tests/unit/scripts/test_arctic_fsck.py::test_main [32mPASSED[0m[31m                 [ 76%][0m
tests/unit/scripts/test_arctic_fsck.py::test_main_dry_run [32mPASSED[0m[31m         [ 76%][0m
tests/unit/scripts/test_initialize_library.py::test_init_library [32mPASSED[0m[31m  [ 76%][0m
tests/unit/scripts/test_initialize_library.py::test_init_library_no_admin [32mPASSED[0m[31m [ 76%][0m
tests/unit/scripts/test_initialize_library.py::test_init_library_hashed [32mPASSED[0m[31m [ 76%][0m
tests/unit/scripts/test_initialize_library.py::test_init_library_no_admin_no_user_creds [32mPASSED[0m[31m [ 76%][0m
tests/unit/scripts/test_initialize_library.py::test_bad_library_name [32mPASSED[0m[31m [ 76%][0m
tests/unit/scripts/test_utils.py::test_do_db_auth [32mPASSED[0m[31m                 [ 76%][0m
tests/unit/scripts/test_utils.py::test_do_db_auth_no_admin [32mPASSED[0m[31m        [ 76%][0m
tests/unit/scripts/test_utils.py::test_do_db_auth_no_user_creds [32mPASSED[0m[31m   [ 76%][0m
tests/unit/scripts/test_utils.py::test_do_db_auth_no_admin_user_creds_fails [32mPASSED[0m[31m [ 76%][0m
tests/unit/scripts/test_utils.py::test_do_db_auth_admin_user_creds_fails [32mPASSED[0m[31m [ 77%][0m
tests/unit/scripts/test_utils.py::test_do_db_auth_role [32mPASSED[0m[31m            [ 77%][0m
tests/unit/serialization/test_incremental.py::test_incremental_bad_init [32mPASSED[0m[31m [ 77%][0m
tests/unit/serialization/test_incremental.py::test_none_df [32mPASSED[0m[31m        [ 77%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[onerow] [32mPASSED[0m[31m [ 77%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[small] [32mPASSED[0m[31m [ 77%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[medium] [32mPASSED[0m[31m [ 77%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[large] [32mPASSED[0m[31m [ 77%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[empty] [32mPASSED[0m[31m [ 77%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[empty_index] [32mPASSED[0m[31m [ 77%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[with_some_objects] [32mPASSED[0m[31m [ 77%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[large_with_some_objects] [32mPASSED[0m[31m [ 77%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[with_string] [32mPASSED[0m[31m [ 77%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[with_unicode] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[with_some_none] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[multiindex] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[multiindex_with_object] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[empty_multiindex] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[large_multi_index] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[empty_multicolumn] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[multi_column_no_multiindex] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[large_multi_column] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[multi_column_int_levels] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[multi_column_and_multi_index] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[multi_column_with_some_objects] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[n_dimensional_df] [32mPASSED[0m[31m [ 78%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[mixed_dtypes_df] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_pandas_to_recarray[index_tz_aware] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[onerow] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[small] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[medium] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[large] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[empty] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[empty_index] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[with_some_objects] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[large_with_some_objects] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[with_string] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[with_unicode] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[with_some_none] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[multiindex] [32mPASSED[0m[31m [ 79%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[multiindex_with_object] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[empty_multiindex] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[large_multi_index] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[empty_multicolumn] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[multi_column_no_multiindex] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[large_multi_column] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[multi_column_int_levels] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[multi_column_and_multi_index] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[multi_column_with_some_objects] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[n_dimensional_df] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[mixed_dtypes_df] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_pandas_to_recarray[index_tz_aware] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[onerow] [32mPASSED[0m[31m [ 80%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[small] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[medium] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[large] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[empty] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[empty_index] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[with_some_objects] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[large_with_some_objects] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[with_string] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[with_unicode] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[with_some_none] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[multiindex] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[multiindex_with_object] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[empty_multiindex] [32mPASSED[0m[31m [ 81%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[large_multi_index] [32mPASSED[0m[31m [ 82%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[empty_multicolumn] [32mPASSED[0m[31m [ 82%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[multi_column_no_multiindex] [32mPASSED[0m[31m [ 82%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[large_multi_column] [32mPASSED[0m[31m [ 82%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[multi_column_int_levels] [32mPASSED[0m[31m [ 82%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[multi_column_and_multi_index] [32mPASSED[0m[31m [ 82%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[multi_column_with_some_objects] [32mPASSED[0m[31m [ 82%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[n_dimensional_df] [32mPASSED[0m[31m [ 82%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[mixed_dtypes_df] [32mPASSED[0m[31m [ 82%][0m
tests/unit/serialization/test_incremental.py::test_serialize_incremental_chunk_size_pandas_to_recarray[index_tz_aware] [32mPASSED[0m[31m [ 82%][0m
tests/unit/serialization/test_incremental.py::test_shape[onerow] [32mPASSED[0m[31m  [ 82%][0m
tests/unit/serialization/test_incremental.py::test_shape[small] [32mPASSED[0m[31m   [ 82%][0m
tests/unit/serialization/test_incremental.py::test_shape[medium] [32mPASSED[0m[31m  [ 82%][0m
tests/unit/serialization/test_incremental.py::test_shape[large] [32mPASSED[0m[31m   [ 82%][0m
tests/unit/serialization/test_incremental.py::test_shape[empty] [32mPASSED[0m[31m   [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[empty_index] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[with_some_objects] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[large_with_some_objects] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[with_string] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[with_unicode] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[with_some_none] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[multiindex] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[multiindex_with_object] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[empty_multiindex] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[large_multi_index] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[empty_multicolumn] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[multi_column_no_multiindex] [32mPASSED[0m[31m [ 83%][0m
tests/unit/serialization/test_incremental.py::test_shape[large_multi_column] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_shape[multi_column_int_levels] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_shape[multi_column_and_multi_index] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_shape[multi_column_with_some_objects] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_shape[n_dimensional_df] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_shape[mixed_dtypes_df] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_shape[index_tz_aware] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_generator_bytes_range[-10--10] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_generator_bytes_range[-10-490] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_generator_bytes_range[-10-990] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_generator_bytes_range[-10-1490] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_generator_bytes_range[490-490] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_generator_bytes_range[490-990] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_generator_bytes_range[490-1490] [32mPASSED[0m[31m [ 84%][0m
tests/unit/serialization/test_incremental.py::test_generator_bytes_range[990-990] [32mPASSED[0m[31m [ 85%][0m
tests/unit/serialization/test_incremental.py::test_generator_bytes_range[990-1490] [32mPASSED[0m[31m [ 85%][0m
tests/unit/serialization/test_incremental.py::test_generator_bytes_range[1490-1490] [32mPASSED[0m[31m [ 85%][0m
tests/unit/serialization/test_numpy_arrays.py::test_frame_converter [32mPASSED[0m[31m [ 85%][0m
tests/unit/serialization/test_numpy_arrays.py::test_with_strings [32mPASSED[0m[31m  [ 85%][0m
tests/unit/serialization/test_numpy_arrays.py::test_with_objects_raises [32mPASSED[0m[31m [ 85%][0m
tests/unit/serialization/test_numpy_arrays.py::test_without_index [32mPASSED[0m[31m [ 85%][0m
tests/unit/serialization/test_numpy_arrays.py::test_with_index [32mPASSED[0m[31m    [ 85%][0m
tests/unit/serialization/test_numpy_arrays.py::test_with_nans [32mPASSED[0m[31m     [ 85%][0m
tests/unit/serialization/test_numpy_arrays.py::test_empty_dataframe [32mPASSED[0m[31m [ 85%][0m
tests/unit/serialization/test_numpy_arrays.py::test_empty_columns [32mPASSED[0m[31m [ 85%][0m
tests/unit/serialization/test_numpy_arrays.py::test_string_cols_with_nans [32mPASSED[0m[31m [ 85%][0m
tests/unit/serialization/test_numpy_arrays.py::test_objify_with_missing_columns [32mPASSED[0m[31m [ 85%][0m
tests/unit/serialization/test_numpy_arrays.py::test_multi_column_fail [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_arrays.py::test_dataframe_writable_after_objify [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_to_primitive_timestamps [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_to_primitive_fixed_length_strings [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_can_convert_to_records_without_objects_returns_false_on_exception_in_to_records[True] [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_can_convert_to_records_without_objects_returns_false_on_exception_in_to_records[False] [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_can_convert_to_records_without_objects_returns_false_when_records_have_object_dtype[True] [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_can_convert_to_records_without_objects_returns_false_when_records_have_object_dtype[False] [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_can_convert_to_records_without_objects_returns_false_when_records_have_arrays_in_them[True] [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_can_convert_to_records_without_objects_returns_false_when_records_have_arrays_in_them[False] [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_can_convert_to_records_without_objects_returns_true_otherwise[True] [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_can_convert_to_records_without_objects_returns_true_otherwise[False] [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_can_convert_to_records_mixed_object_column_string_nan[False] [32mPASSED[0m[31m [ 86%][0m
tests/unit/serialization/test_numpy_records.py::test_can_convert_to_records_mixed_object_column_string_nan[True] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[onerow] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[small] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[medium] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[large] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[empty] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[empty_index] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[with_some_objects] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[large_with_some_objects] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[with_string] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[with_unicode] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[with_some_none] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[multiindex] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[multiindex_with_object] [32mPASSED[0m[31m [ 87%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[empty_multiindex] [32mPASSED[0m[31m [ 88%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[large_multi_index] [32mPASSED[0m[31m [ 88%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[empty_multicolumn] [32mPASSED[0m[31m [ 88%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[multi_column_no_multiindex] [32mPASSED[0m[31m [ 88%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[large_multi_column] [32mPASSED[0m[31m [ 88%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[multi_column_int_levels] [32mPASSED[0m[31m [ 88%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[multi_column_and_multi_index] [32mPASSED[0m[31m [ 88%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[multi_column_with_some_objects] [32mPASSED[0m[31m [ 88%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[n_dimensional_df] [32mPASSED[0m[31m [ 88%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[mixed_dtypes_df] [32mPASSED[0m[31m [ 88%][0m
tests/unit/serialization/test_pandas_is_serializable.py::test_dataframe_confirm_fast_check_compatibility[index_tz_aware] [32mPASSED[0m[31m [ 88%][0m
tests/unit/store/test_bitemporal_store.py::test_add_observe_dt_index [32mPASSED[0m[31m [ 88%][0m
tests/unit/store/test_bson_store.py::test_enable_sharding [32mPASSED[0m[31m         [ 88%][0m
tests/unit/store/test_bson_store.py::test_find [32mPASSED[0m[31m                    [ 89%][0m
tests/unit/store/test_bson_store.py::test_find_one [32mPASSED[0m[31m                [ 89%][0m
tests/unit/store/test_bson_store.py::test_insert_one [32mPASSED[0m[31m              [ 89%][0m
tests/unit/store/test_bson_store.py::test_insert_many [32mPASSED[0m[31m             [ 89%][0m
tests/unit/store/test_bson_store.py::test_replace_one [32mPASSED[0m[31m             [ 89%][0m
tests/unit/store/test_bson_store.py::test_update_one [32mPASSED[0m[31m              [ 89%][0m
tests/unit/store/test_bson_store.py::test_update_many [32mPASSED[0m[31m             [ 89%][0m
tests/unit/store/test_bson_store.py::test_find_one_and_replace [32mPASSED[0m[31m    [ 89%][0m
tests/unit/store/test_bson_store.py::test_find_one_and_update [32mPASSED[0m[31m     [ 89%][0m
tests/unit/store/test_bson_store.py::test_find_one_and_delete [32mPASSED[0m[31m     [ 89%][0m
tests/unit/store/test_bson_store.py::test_bulk_write [32mPASSED[0m[31m              [ 89%][0m
tests/unit/store/test_bson_store.py::test_delete_one [32mPASSED[0m[31m              [ 89%][0m
tests/unit/store/test_bson_store.py::test_count [32mPASSED[0m[31m                   [ 89%][0m
tests/unit/store/test_bson_store.py::test_distinct [32mPASSED[0m[31m                [ 89%][0m
tests/unit/store/test_bson_store.py::test_delete_many [32mPASSED[0m[31m             [ 90%][0m
tests/unit/store/test_bson_store.py::test_create_index [32mPASSED[0m[31m            [ 90%][0m
tests/unit/store/test_bson_store.py::test_drop_index [32mPASSED[0m[31m              [ 90%][0m
tests/unit/store/test_bson_store.py::test_index_information [32mPASSED[0m[31m       [ 90%][0m
tests/unit/store/test_metadata_store.py::test_ensure_index [32mPASSED[0m[31m        [ 90%][0m
tests/unit/store/test_metadata_store.py::test_list_symbols_simple [32mPASSED[0m[31m [ 90%][0m
tests/unit/store/test_metadata_store.py::test_list_symbols_regex [32mPASSED[0m[31m  [ 90%][0m
tests/unit/store/test_metadata_store.py::test_list_symbols_as_of [32mPASSED[0m[31m  [ 90%][0m
tests/unit/store/test_metadata_store.py::test_list_symbols_as_of_regex [32mPASSED[0m[31m [ 90%][0m
tests/unit/store/test_metadata_store.py::test_list_symbols_metadata_query [32mPASSED[0m[31m [ 90%][0m
tests/unit/store/test_metadata_store.py::test_list_symbols_all_options [32mPASSED[0m[31m [ 90%][0m
tests/unit/store/test_ndarray_store.py::test_dtype_parsing [32mPASSED[0m[31m        [ 90%][0m
tests/unit/store/test_ndarray_store.py::test_promote_dtype_handles_string_increase [32mPASSED[0m[31m [ 90%][0m
tests/unit/store/test_ndarray_store.py::test_promote_dtype_handles_string_decrease [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_ndarray_store.py::test_promote_dtype_handles_new_column [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_ndarray_store.py::test_promote_dtype_handles_rearrangement_of_columns_favouring_dtype1 [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_ndarray_store.py::test_promote_dtype_throws_if_column_is_removed [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_ndarray_store.py::test_concat_and_rewrite_checks_chunk_count [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_ndarray_store.py::test_concat_and_rewrite_checks_written [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_ndarray_store.py::test_concat_and_rewrite_checks_different_id [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_ndarray_store.py::test_concat_and_rewrite_checks_fewer_updated [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_pandas_ndarray_store.py::test_panel_converted_to_dataframe_and_stacked_to_write [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_pandas_ndarray_store.py::test_panel_append_not_supported [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_pandas_ndarray_store.py::test_panel_converted_from_dataframe_for_reading [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_pandas_ndarray_store.py::test_raises_upon_empty_panel_write [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_pandas_ndarray_store.py::test_read_multi_index_with_no_ts_info [32mPASSED[0m[31m [ 91%][0m
tests/unit/store/test_pickle_store.py::test_write [32mPASSED[0m[31m                 [ 92%][0m
tests/unit/store/test_pickle_store.py::test_write_object [32mPASSED[0m[31m          [ 92%][0m
tests/unit/store/test_pickle_store.py::test_read [32mPASSED[0m[31m                  [ 92%][0m
tests/unit/store/test_pickle_store.py::test_read_object_backwards_compat [32mPASSED[0m[31m [ 92%][0m
tests/unit/store/test_pickle_store.py::test_read_object_2 [32mPASSED[0m[31m         [ 92%][0m
tests/unit/store/test_pickle_store.py::test_read_with_base_version_id [32mPASSED[0m[31m [ 92%][0m
tests/unit/store/test_pickle_store.py::test_read_backward_compatibility [33mXFAIL[0m[31m [ 92%][0m
tests/unit/store/test_pickle_store.py::test_unpickle_highest_protocol [32mPASSED[0m[31m [ 92%][0m
tests/unit/store/test_pickle_store.py::test_pickle_chunk_V1_read [32mPASSED[0m[31m  [ 92%][0m
tests/unit/store/test_pickle_store.py::test_pickle_store_future_version [32mPASSED[0m[31m [ 92%][0m
tests/unit/store/test_version_item.py::test_versioned_item_str [32mPASSED[0m[31m    [ 92%][0m
tests/unit/store/test_version_item.py::test_versioned_item_default_host [32mPASSED[0m[31m [ 92%][0m
tests/unit/store/test_version_item.py::test_versioned_item_str_handles_none [32mPASSED[0m[31m [ 92%][0m
tests/unit/store/test_version_item.py::test_versioned_item_metadata_dict [32mPASSED[0m[31m [ 92%][0m
tests/unit/store/test_version_store.py::test_delete_version_version_not_found [32mPASSED[0m[31m [ 93%][0m
tests/unit/store/test_version_store.py::test_list_versions_localTime [32mPASSED[0m[31m [ 93%][0m
tests/unit/store/test_version_store.py::test_list_versions_no_snapshot [32mPASSED[0m[31m [ 93%][0m
tests/unit/store/test_version_store.py::test__read_preference__allow_secondary_true [32mPASSED[0m[31m [ 93%][0m
tests/unit/store/test_version_store.py::test__read_preference__allow_secondary_false [32mPASSED[0m[31m [ 93%][0m
tests/unit/store/test_version_store.py::test__read_preference__default_true [32mPASSED[0m[31m [ 93%][0m
tests/unit/store/test_version_store.py::test__read_preference__default_false [32mPASSED[0m[31m [ 93%][0m
tests/unit/store/test_version_store.py::test_get_version_allow_secondary_True [32mPASSED[0m[31m [ 93%][0m
tests/unit/store/test_version_store.py::test_get_version_allow_secondary_user_override_False [32mPASSED[0m[31m [ 93%][0m
tests/unit/store/test_version_store.py::test_read_as_of_LondonTime [32mPASSED[0m[31m [ 93%][0m
tests/unit/store/test_version_store.py::test_read_as_of_NotNaive [32mPASSED[0m[31m  [ 93%][0m
tests/unit/store/test_version_store.py::test_read_metadata_no_asof [32mPASSED[0m[31m [ 93%][0m
tests/unit/store/test_version_store.py::test_write_check_quota [32mPASSED[0m[31m    [ 93%][0m
tests/unit/store/test_version_store.py::test_initialize_library [32mPASSED[0m[31m   [ 94%][0m
tests/unit/store/test_version_store.py::test_ensure_index [32mPASSED[0m[31m         [ 94%][0m
tests/unit/store/test_version_store.py::test_prune_previous_versions_0_timeout [32mPASSED[0m[31m [ 94%][0m
tests/unit/store/test_version_store.py::test_read_handles_operation_failure [32mPASSED[0m[31m [ 94%][0m
tests/unit/store/test_version_store.py::test_read_reports_random_errors [32mPASSED[0m[31m [ 94%][0m
tests/unit/store/test_version_store.py::test_snapshot [32mPASSED[0m[31m             [ 94%][0m
tests/unit/store/test_version_store.py::test_list_symbols_default_pipeline [32mPASSED[0m[31m [ 94%][0m
tests/unit/store/test_version_store.py::test_snapshot_duplicate_raises_exception [32mPASSED[0m[31m [ 94%][0m
tests/unit/store/test_version_store.py::test_write_metadata_no_previous_data [32mPASSED[0m[31m [ 94%][0m
tests/unit/store/test_version_store.py::test_write_metadata_with_previous_data [32mPASSED[0m[31m [ 94%][0m
tests/unit/store/test_version_store.py::test_write_empty_metadata [32mPASSED[0m[31m [ 94%][0m
tests/unit/store/test_version_store.py::test_write_metadata_insert_version_dupkeyerror [32mPASSED[0m[31m [ 94%][0m
tests/unit/store/test_version_store.py::test_write_metadata_insert_version_opfailure [32mPASSED[0m[31m [ 94%][0m
tests/unit/store/test_version_store.py::test_restore_version [32mPASSED[0m[31m      [ 94%][0m
tests/unit/store/test_version_store.py::test_restore_version_data_missing_symbol [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store.py::test_restore_last_version [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store.py::test_write_error_clean_retry [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store.py::test_write_insert_version_duplicatekey [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store.py::test_write_insert_version_operror [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store.py::test_append_error_clean_retry [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store.py::test_append_insert_version_duplicatekey [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store.py::test_append_insert_version_operror [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store_audit.py::test_data_change [32mPASSED[0m[31m    [ 95%][0m
tests/unit/store/test_version_store_audit.py::test_ArcticTransaction_simple [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store_audit.py::test_ArticTransaction_no_audit [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store_audit.py::test_ArcticTransaction_writes_if_metadata_changed [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store_audit.py::test_ArcticTransaction_writes_if_base_data_corrupted [32mPASSED[0m[31m [ 95%][0m
tests/unit/store/test_version_store_audit.py::test_ArcticTransaction_writes_no_data_found [32mPASSED[0m[31m [ 96%][0m
tests/unit/store/test_version_store_audit.py::test_ArcticTransaction_writes_no_data_found_deleted [32mPASSED[0m[31m [ 96%][0m
tests/unit/store/test_version_store_audit.py::test_ArcticTransaction_does_nothing_when_data_not_modified [32mPASSED[0m[31m [ 96%][0m
tests/unit/store/test_version_store_audit.py::test_ArcticTransaction_does_nothing_when_data_is_None [32mPASSED[0m[31m [ 96%][0m
tests/unit/store/test_version_store_audit.py::test_ArcticTransaction_guards_against_inconsistent_ts [32mPASSED[0m[31m [ 96%][0m
tests/unit/store/test_version_store_audit.py::test_ArcticTransaction_detects_concurrent_writes [31mFAILED[0m[31m [ 96%][0m
tests/unit/store/test_version_store_utils.py::test_split_arrs_empty [32mPASSED[0m[31m [ 96%][0m
tests/unit/store/test_version_store_utils.py::test_split_arrs [32mPASSED[0m[31m     [ 96%][0m
tests/unit/store/test_version_store_utils.py::test_checksum [32mPASSED[0m[31m       [ 96%][0m
tests/unit/store/test_version_store_utils.py::test_checksum_handles_p3strs_and_binary [32mPASSED[0m[31m [ 96%][0m
tests/unit/store/test_version_store_utils.py::test_version_base_or_id [32mPASSED[0m[31m [ 96%][0m
tests/unit/tickstore/test_tickstore.py::test_mongo_date_range_query [32mPASSED[0m[31m [ 96%][0m
tests/unit/tickstore/test_tickstore.py::test_mongo_date_range_query_asserts [32mPASSED[0m[31m [ 96%][0m
tests/unit/tickstore/test_tickstore.py::test_strify_tickstore [32mPASSED[0m[31m     [ 97%][0m
tests/unit/tickstore/test_tickstore.py::test_tickstore_to_bucket_no_image [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_tickstore.py::test_tickstore_to_bucket_with_image [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_tickstore.py::test_tickstore_to_bucket_always_forwards [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_tickstore.py::test_tickstore_to_bucket_always_forwards_image [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_tickstore.py::test_tickstore_pandas_to_bucket_image [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_tickstore.py::test__read_preference__allow_secondary_true [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_tickstore.py::test__read_preference__allow_secondary_false [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_tickstore.py::test__read_preference__default_true [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_tickstore.py::test__read_preference__default_false [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_exception_if_daterange_is_not_provided [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_exception_if_date_range_does_not_contain_start_date [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_exception_if_date_range_does_not_contain_end_date [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_exception_if_date_range_does_not_contain_start_and_end_date [32mPASSED[0m[31m [ 97%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_exception_and_log_an_error_if_an_invalid_library_name_is_added [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_exception_if_date_range_overlaps [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_add_library_to_colllection_if_date_range_is_on_UTC_or_naive_day_boundaries[start0-end0-expected_start0-expected_end0] [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_add_library_to_colllection_if_date_range_is_on_UTC_or_naive_day_boundaries[start1-end1-expected_start1-expected_end1] [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_add_library_to_colllection_if_date_range_is_on_UTC_or_naive_day_boundaries[start2-end2-expected_start2-expected_end2] [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_error_add_library_is_called_with_a_date_range_not_on_day_boundaries[start0-end0] [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_error_add_library_is_called_with_a_date_range_not_on_day_boundaries[start1-end1] [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_error_add_library_is_called_with_a_date_range_not_on_day_boundaries[start2-end2] [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_error_add_library_is_called_with_a_date_range_not_on_day_boundaries[start3-end3] [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_error_add_library_is_called_with_a_date_range_not_on_day_boundaries[start4-end4] [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_error_add_library_is_called_with_a_date_range_not_on_day_boundaries[start5-end5] [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_error_add_library_is_called_with_a_date_range_not_on_day_boundaries[start6-end6] [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_error_add_library_is_called_with_a_date_range_not_on_day_boundaries[start7-end7] [32mPASSED[0m[31m [ 98%][0m
tests/unit/tickstore/test_toplevel.py::test_raise_error_add_library_is_called_with_a_date_range_not_on_day_boundaries[start8-end8] [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_slice_pandas_dataframe[start0-end0-0-3] [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_slice_pandas_dataframe[start1-end1-0-3] [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_slice_pandas_dataframe[start2-end2-1-3] [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_slice_pandas_dataframe[start3-end3-1-2] [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_slice_pandas_dataframe[start4-end4-0-3] [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_slice_list_of_dicts[start0-end0-0-3] [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_slice_list_of_dicts[start1-end1-0-3] [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_slice_list_of_dicts[start2-end2-1-3] [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_slice_list_of_dicts[start3-end3-1-2] [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_slice_list_of_dicts[start4-end4-0-3] [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_write_pandas_data_to_right_libraries [32mPASSED[0m[31m [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_read [32mPASSED[0m[31m                  [ 99%][0m
tests/unit/tickstore/test_toplevel.py::test_slice_raises [32mPASSED[0m[31m          [100%][0m

=================================== FAILURES ===================================
[31m[1m____________________________ test_overwrite_series _____________________________[0m

chunkstore_lib = <ChunkStore at 0x7f84f56b62e8>
    <ArcticLibrary at 0x7f84f56b6f98, arctic_test.TEST>
        <Arctic at 0x7f84f56b6e10, connected to MongoClient(host=['127.67.249.105:29765'], document_class=dict, tz_aware=False, connect=True)>

    def test_overwrite_series(chunkstore_lib):
        s = pd.Series([1], index=pd.date_range('2016-01-01',
                                               '2016-01-01',
                                               name='date'),
                      name='vals')
    
        chunkstore_lib.write('test', s)
        chunkstore_lib.write('test', s + 1)
>       assert_series_equal(chunkstore_lib.read('test'), s + 1)
[1m[31mE       AssertionError: (None, <Day>)[0m

[1m[31mtests/integration/chunkstore/test_chunkstore.py[0m:716: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:23:23.283+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:23:23.285+0000 I CONTROL  [initandlisten] MongoDB starting : pid=8810 port=29765 dbpath=/tmp/tmpkij50nzc 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:23:23.285+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:23:23.285+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:23:23.285+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:23:23.285+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:23:23.285+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:23:23.285+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:23:23.285+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:23:23.285+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:23:23.285+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:23:23.285+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 29765, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpkij50nzc", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:23:23.285+0000 I STORAGE  [initandlisten] 
2021-01-13T15:23:23.285+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:23:23.285+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:23:23.286+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:23:23.782+0000 I STORAGE  [initandlisten] WiredTiger message [1610551403:782313][8810:0x7fb7d3889a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:23:23.793+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:23:23.818+0000 I CONTROL  [initandlisten] 
2021-01-13T15:23:23.818+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:23:23.818+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:23:23.818+0000 I CONTROL  [initandlisten] 
2021-01-13T15:23:23.818+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: cc92fd3f-b693-4f47-9612-cad0808545a2
2021-01-13T15:23:23.835+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:23:23.835+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:23:23.835+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:23:23.835+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:23:23.835+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 816e217d-c1d8-4aef-90f2-5fffcac18882
2021-01-13T15:23:23.855+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:23:23.855+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpkij50nzc/diagnostic.data'
2021-01-13T15:23:23.856+0000 I NETWORK  [initandlisten] waiting for connections on port 29765
2021-01-13T15:23:23.856+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:23:23.856+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:23:23.856+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: aa50d5e4-78d7-4b48-a88c-934abe63457e
2021-01-13T15:23:23.880+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:45890 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:23:23.881+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:45892 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:23:23.884+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:23:23.884+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:23:23.884+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:45894 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:23:23.885+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:23:23.888+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:45896 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:23:23.892+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:23:23.892+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 7d7c5b44-8fe7-4beb-a916-043c7b4f5c1f
2021-01-13T15:23:23.922+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:23:23.922+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:23:23.922+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:23:23.922+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-4474542826293819909
2021-01-13T15:23:23.922+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:23:23.925+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:23:23.925+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: e851ed23-9f40-4e81-bac5-4a6c7a11822a
2021-01-13T15:23:23.945+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.symbols with generated UUID: 81ad9adb-5d83-47b0-9082-898e96fc2e9b
2021-01-13T15:23:23.963+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.symbols as collection version: <unsharded>
2021-01-13T15:23:23.976+0000 I INDEX    [conn4] build index on: arctic_test.TEST.symbols properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_test.TEST.symbols", background: true }
2021-01-13T15:23:23.976+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:23:23.977+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 0b2f6b24-8222-4fe4-a168-2ef4e03ef63f
2021-01-13T15:23:24.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:23:24.013+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { sy: "hashed" }, name: "sy_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:23:24.013+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:23:24.014+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:23:24.025+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, sh: 1 }, name: "sy_1_sh_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:23:24.025+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:23:24.036+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, s: 1, e: 1, sg: 1 }, name: "sy_1_s_1_e_1_sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:23:24.036+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:23:24.048+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, s: 1, sg: 1 }, name: "sy_1_s_1_sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:23:24.048+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:23:24.060+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { sg: 1 }, name: "sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:23:24.060+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:23:24.061+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.metadata with generated UUID: 0c6f56d1-70ed-4069-9534-abba8b14bb36
2021-01-13T15:23:24.081+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.metadata as collection version: <unsharded>
2021-01-13T15:23:24.091+0000 I INDEX    [conn4] build index on: arctic_test.TEST.metadata properties: { v: 2, unique: true, key: { sy: 1, s: 1, e: 1 }, name: "sy_1_s_1_e_1", ns: "arctic_test.TEST.metadata", background: true }
2021-01-13T15:23:24.091+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:23:23,259 DEBUG pytest_shutil.workspace 
2021-01-13 15:23:23,259 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:23:23,259 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpkij50nzc
2021-01-13 15:23:23,259 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:23:23,259 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:23:23,259 DEBUG pytest_shutil.workspace 
2021-01-13 15:23:23,260 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:23:23,267 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=29765 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpkij50nzc
2021-01-13 15:23:23,268 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:23:23,269 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:23:23,269 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:29765
2021-01-13 15:23:23,875 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:23:23,875 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:29765
2021-01-13 15:23:23,886 DEBUG pytest_server_fixtures.base2 waited 0:00:00.617450 for server to start successfully
2021-01-13 15:23:23,887 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:23:23,887 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:23:24,091 INFO arctic.chunkstore.chunkstore Trying to enable sharding...
2021-01-13 15:23:24,093 WARNING arctic.chunkstore.chunkstore Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpkij50nzc
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=29765 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpkij50nzc
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:29765
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:29765
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.617450 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.chunkstore.chunkstore:chunkstore.py:46 Trying to enable sharding...
[33mWARNING [0m arctic.chunkstore.chunkstore:chunkstore.py:50 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:23:24.100+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:23:24.101+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:23:24,111 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:23:24,291 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 8810 (total_procs_to_kill=1)
2021-01-13 15:23:24,292 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:23:24,292 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:23:24,296 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:23:24,296 DEBUG pytest_shutil.workspace 
2021-01-13 15:23:24,296 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:23:24,296 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpkij50nzc
2021-01-13 15:23:24,296 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:23:24,296 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 8810 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpkij50nzc
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_____________________________ test_quarterly_data ______________________________[0m

chunkstore_lib = <ChunkStore at 0x7f84f54430b8>
    <ArcticLibrary at 0x7f84f5445160, arctic_test.TEST>
        <Arctic at 0x7f84f5466710, connected to MongoClient(host=['127.67.249.105:1069'], document_class=dict, tz_aware=False, connect=True)>

    def test_quarterly_data(chunkstore_lib):
        df = DataFrame(data={'data': np.random.randint(0, 100, size=366)},
                       index=pd.date_range('2016-01-01', '2016-12-31'))
        df.index.name = 'date'
    
        chunkstore_lib.write('quarterly', df, chunk_size='Q')
>       assert_frame_equal(df, chunkstore_lib.read('quarterly'))
[1m[31mE       AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/chunkstore/test_chunkstore.py[0m:1037: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:24:08.668+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:24:08.671+0000 I CONTROL  [initandlisten] MongoDB starting : pid=9587 port=1069 dbpath=/tmp/tmprlw3hlxd 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:24:08.671+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:24:08.671+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:24:08.671+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:24:08.671+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:24:08.671+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:24:08.671+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:24:08.671+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:24:08.671+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:24:08.671+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:24:08.671+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 1069, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmprlw3hlxd", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:24:08.671+0000 I STORAGE  [initandlisten] 
2021-01-13T15:24:08.671+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:24:08.671+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:24:08.671+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:24:09.167+0000 I STORAGE  [initandlisten] WiredTiger message [1610551449:167491][9587:0x7faaeeac3a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:24:09.181+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:24:09.207+0000 I CONTROL  [initandlisten] 
2021-01-13T15:24:09.207+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:24:09.207+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:24:09.207+0000 I CONTROL  [initandlisten] 
2021-01-13T15:24:09.207+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: f46ab652-d741-4951-84cb-db73cacfbcff
2021-01-13T15:24:09.225+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:24:09.225+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:24:09.225+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:24:09.225+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:24:09.225+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 22ab1b58-270b-4c11-aa1a-f4291a700ae4
2021-01-13T15:24:09.244+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:24:09.244+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmprlw3hlxd/diagnostic.data'
2021-01-13T15:24:09.245+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:24:09.245+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 6faa9074-383f-40a0-939c-c42c036f2a04
2021-01-13T15:24:09.246+0000 I NETWORK  [initandlisten] waiting for connections on port 1069
2021-01-13T15:24:09.264+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:50470 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:09.265+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:50472 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:09.270+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:50474 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:09.271+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:50476 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:09.275+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:24:09.275+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:24:09.275+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:24:09.275+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--6812506836575903637
2021-01-13T15:24:09.275+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:09.275+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:24:09.278+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:24:09.278+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 8f1a1bfa-adc5-4c5f-9dec-ff9d348dd78e
2021-01-13T15:24:09.309+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:24:09.309+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:24:09.309+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:24:09.310+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--6812506836575903637
2021-01-13T15:24:09.310+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:09.312+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:24:09.312+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 68dd9827-1ebd-4e1d-8feb-68399ac94537
2021-01-13T15:24:09.332+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.symbols with generated UUID: 6860fc54-7b2c-4367-9283-d6c179b64f20
2021-01-13T15:24:09.352+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.symbols as collection version: <unsharded>
2021-01-13T15:24:09.364+0000 I INDEX    [conn4] build index on: arctic_test.TEST.symbols properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_test.TEST.symbols", background: true }
2021-01-13T15:24:09.364+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:09.365+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 28dfe89e-4a4f-4086-bea6-5a9fb17845c9
2021-01-13T15:24:09.402+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { sy: "hashed" }, name: "sy_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:09.403+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:09.404+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:24:09.416+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, sh: 1 }, name: "sy_1_sh_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:09.416+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:09.427+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, s: 1, e: 1, sg: 1 }, name: "sy_1_s_1_e_1_sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:09.427+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:09.440+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, s: 1, sg: 1 }, name: "sy_1_s_1_sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:09.440+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:09.452+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { sg: 1 }, name: "sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:09.452+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:09.453+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.metadata with generated UUID: be571a07-a1eb-46e2-8464-a9ce0b4887bd
2021-01-13T15:24:09.473+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.metadata as collection version: <unsharded>
2021-01-13T15:24:09.482+0000 I INDEX    [conn4] build index on: arctic_test.TEST.metadata properties: { v: 2, unique: true, key: { sy: 1, s: 1, e: 1 }, name: "sy_1_s_1_e_1", ns: "arctic_test.TEST.metadata", background: true }
2021-01-13T15:24:09.482+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:24:08,644 DEBUG pytest_shutil.workspace 
2021-01-13 15:24:08,644 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:08,644 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmprlw3hlxd
2021-01-13 15:24:08,644 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:24:08,644 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:08,644 DEBUG pytest_shutil.workspace 
2021-01-13 15:24:08,645 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:24:08,653 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=1069 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmprlw3hlxd
2021-01-13 15:24:08,654 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:24:08,655 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:24:08,655 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:1069
2021-01-13 15:24:09,260 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:24:09,261 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:1069
2021-01-13 15:24:09,269 DEBUG pytest_server_fixtures.base2 waited 0:00:00.614636 for server to start successfully
2021-01-13 15:24:09,269 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:24:09,270 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:24:09,482 INFO arctic.chunkstore.chunkstore Trying to enable sharding...
2021-01-13 15:24:09,485 WARNING arctic.chunkstore.chunkstore Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmprlw3hlxd
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=1069 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmprlw3hlxd
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:1069
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:1069
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.614636 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.chunkstore.chunkstore:chunkstore.py:46 Trying to enable sharding...
[33mWARNING [0m arctic.chunkstore.chunkstore:chunkstore.py:50 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:24:09.493+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:24:09.493+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:24:09,504 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:24:09,697 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 9587 (total_procs_to_kill=1)
2021-01-13 15:24:09,698 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:24:09,698 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:24:09,702 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:24:09,702 DEBUG pytest_shutil.workspace 
2021-01-13 15:24:09,702 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:09,702 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmprlw3hlxd
2021-01-13 15:24:09,703 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:09,703 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 9587 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmprlw3hlxd
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m______________________________ test_date_interval ______________________________[0m

chunkstore_lib = <ChunkStore at 0x7f84f4814470>
    <ArcticLibrary at 0x7f84f48306d8, arctic_test.TEST>
        <Arctic at 0x7f84f4814f28, connected to MongoClient(host=['127.67.249.105:7530'], document_class=dict, tz_aware=False, connect=True)>

    def test_date_interval(chunkstore_lib):
        date_range = pd.date_range(start=dt(2017, 5, 1), periods=8, freq='D')
    
        df = DataFrame(data={'data': range(8)},
                       index=DatetimeIndex(date_range, name='date'))
    
        # test with index
        chunkstore_lib.write('test', df, chunk_size='D')
    
        ret = chunkstore_lib.read('test', chunk_range=DateRange(dt(2017, 5, 2), dt(2017, 5, 5), CLOSED_OPEN))
>       assert_frame_equal(ret, df[1:4])
[1m[31mE       AssertionError: (None, <Day>)[0m

[1m[31mtests/integration/chunkstore/test_fixes.py[0m:75: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:24:36.966+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:24:36.969+0000 I CONTROL  [initandlisten] MongoDB starting : pid=10297 port=7530 dbpath=/tmp/tmpwkcv7clc 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:24:36.969+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:24:36.969+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:24:36.969+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:24:36.969+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:24:36.969+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:24:36.969+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:24:36.969+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:24:36.969+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:24:36.969+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:24:36.969+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 7530, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpwkcv7clc", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:24:36.969+0000 I STORAGE  [initandlisten] 
2021-01-13T15:24:36.969+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:24:36.969+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:24:36.969+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:24:37.469+0000 I STORAGE  [initandlisten] WiredTiger message [1610551477:469651][10297:0x7f346ec3fa80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:24:37.482+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:24:37.506+0000 I CONTROL  [initandlisten] 
2021-01-13T15:24:37.506+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:24:37.506+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:24:37.506+0000 I CONTROL  [initandlisten] 
2021-01-13T15:24:37.506+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 2af5b5a7-8eba-452a-8da7-c567eaabcf3d
2021-01-13T15:24:37.524+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:24:37.524+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:24:37.524+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:24:37.525+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:24:37.525+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 4917d5d0-5fe7-43fe-b5e9-fcacfd187aa6
2021-01-13T15:24:37.546+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:24:37.546+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpwkcv7clc/diagnostic.data'
2021-01-13T15:24:37.547+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:24:37.547+0000 I NETWORK  [initandlisten] waiting for connections on port 7530
2021-01-13T15:24:37.547+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:24:37.547+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 453b8deb-7d80-4c1c-97c3-027466bb0638
2021-01-13T15:24:37.562+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:45080 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:37.564+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:45082 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:37.568+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:45084 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:37.571+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:45086 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:37.574+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:24:37.574+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:24:37.574+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:24:37.574+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--2207326711406740824
2021-01-13T15:24:37.574+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:37.577+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:24:37.577+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 3bea7b0d-6d34-44c4-b59c-7b77d3632136
2021-01-13T15:24:37.607+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:24:37.607+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:24:37.607+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:24:37.607+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--2207326711406740824
2021-01-13T15:24:37.607+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:37.610+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:24:37.610+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 7279b5d8-ad44-4ef6-8577-1d26497ae911
2021-01-13T15:24:37.630+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.symbols with generated UUID: 3ad7790a-2212-4f0b-ab50-c96da740f320
2021-01-13T15:24:37.649+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.symbols as collection version: <unsharded>
2021-01-13T15:24:37.659+0000 I INDEX    [conn4] build index on: arctic_test.TEST.symbols properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_test.TEST.symbols", background: true }
2021-01-13T15:24:37.659+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:37.660+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 2e6e49ba-4d63-4a4c-a3c7-f6cee9086134
2021-01-13T15:24:37.690+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { sy: "hashed" }, name: "sy_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:37.690+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:37.691+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:24:37.703+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, sh: 1 }, name: "sy_1_sh_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:37.703+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:37.714+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, s: 1, e: 1, sg: 1 }, name: "sy_1_s_1_e_1_sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:37.714+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:37.726+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, s: 1, sg: 1 }, name: "sy_1_s_1_sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:37.726+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:37.738+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { sg: 1 }, name: "sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:37.738+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:37.739+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.metadata with generated UUID: 365935bd-e961-4c7f-9e16-4a9b09cff787
2021-01-13T15:24:37.758+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.metadata as collection version: <unsharded>
2021-01-13T15:24:37.767+0000 I INDEX    [conn4] build index on: arctic_test.TEST.metadata properties: { v: 2, unique: true, key: { sy: 1, s: 1, e: 1 }, name: "sy_1_s_1_e_1", ns: "arctic_test.TEST.metadata", background: true }
2021-01-13T15:24:37.768+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:24:36,941 DEBUG pytest_shutil.workspace 
2021-01-13 15:24:36,941 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:36,941 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpwkcv7clc
2021-01-13 15:24:36,941 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:24:36,942 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:36,942 DEBUG pytest_shutil.workspace 
2021-01-13 15:24:36,942 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:24:36,951 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=7530 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpwkcv7clc
2021-01-13 15:24:36,952 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:24:36,952 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:24:36,953 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:7530
2021-01-13 15:24:37,559 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:24:37,559 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:7530
2021-01-13 15:24:37,569 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616258 for server to start successfully
2021-01-13 15:24:37,569 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:24:37,570 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:24:37,768 INFO arctic.chunkstore.chunkstore Trying to enable sharding...
2021-01-13 15:24:37,770 WARNING arctic.chunkstore.chunkstore Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpwkcv7clc
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=7530 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpwkcv7clc
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:7530
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:7530
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616258 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.chunkstore.chunkstore:chunkstore.py:46 Trying to enable sharding...
[33mWARNING [0m arctic.chunkstore.chunkstore:chunkstore.py:50 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:24:37.779+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:24:37.780+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:24:37,789 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:24:37,854 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 10297 (total_procs_to_kill=1)
2021-01-13 15:24:37,855 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:24:37,855 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:24:37,859 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:24:37,860 DEBUG pytest_shutil.workspace 
2021-01-13 15:24:37,860 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:37,860 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpwkcv7clc
2021-01-13 15:24:37,860 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:37,860 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 10297 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpwkcv7clc
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m______________________________ test_missing_cols _______________________________[0m

chunkstore_lib = <ChunkStore at 0x7f84f481f390>
    <ArcticLibrary at 0x7f84f4804b00, arctic_test.TEST>
        <Arctic at 0x7f84f4804cf8, connected to MongoClient(host=['127.67.249.105:26936'], document_class=dict, tz_aware=False, connect=True)>

    def test_missing_cols(chunkstore_lib):
        index = DatetimeIndex(pd.date_range('2019-01-01', periods=3, freq='D'), name='date')
        index2 = DatetimeIndex(pd.date_range('2019-01-04', periods=3, freq='D'), name='date')
        expected_index = DatetimeIndex(pd.date_range('2019-01-01', periods=6, freq='D'), name='date')
        expected_df = DataFrame({'A': [1, 2, 3, 40, 50, 60], 'B': [5.0,6.0,7.0, np.nan, np.nan, np.nan]}, index=expected_index)
    
        df = pd.DataFrame({'A': [1, 2, 3], 'B': [5,6,7]}, index=index)
        chunkstore_lib.write('test', df, chunk_size='D')
    
        df = pd.DataFrame({'A': [40, 50, 60]}, index=index2)
        chunkstore_lib.append('test', df, chunk_size='D')
    
    
>       assert_frame_equal(chunkstore_lib.read('test'), expected_df)
[1m[31mE       AssertionError: (None, <Day>)[0m

[1m[31mtests/integration/chunkstore/test_fixes.py[0m:166: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:24:40.113+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:24:40.115+0000 I CONTROL  [initandlisten] MongoDB starting : pid=10402 port=26936 dbpath=/tmp/tmp7kuhlnrm 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:24:40.115+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:24:40.115+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:24:40.115+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:24:40.115+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:24:40.115+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:24:40.115+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:24:40.115+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:24:40.115+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:24:40.115+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:24:40.115+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 26936, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp7kuhlnrm", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:24:40.115+0000 I STORAGE  [initandlisten] 
2021-01-13T15:24:40.115+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:24:40.115+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:24:40.115+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:24:40.617+0000 I STORAGE  [initandlisten] WiredTiger message [1610551480:617067][10402:0x7f789913aa80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:24:40.631+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:24:40.658+0000 I CONTROL  [initandlisten] 
2021-01-13T15:24:40.658+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:24:40.658+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:24:40.658+0000 I CONTROL  [initandlisten] 
2021-01-13T15:24:40.658+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: ce1abe76-559e-481d-89ba-ba249e9f7110
2021-01-13T15:24:40.677+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:24:40.677+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:24:40.677+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:24:40.677+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:24:40.677+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 4008560c-fd78-4dfa-b49e-907e4a9cc6fb
2021-01-13T15:24:40.697+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:24:40.697+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp7kuhlnrm/diagnostic.data'
2021-01-13T15:24:40.698+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:24:40.699+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 89c8c8af-565b-437f-94a4-0eafbd43ba4c
2021-01-13T15:24:40.699+0000 I NETWORK  [initandlisten] waiting for connections on port 26936
2021-01-13T15:24:40.709+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:57768 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:40.711+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:57770 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:40.714+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:57772 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:40.718+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:57774 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:24:40.728+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:24:40.728+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:24:40.730+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:40.730+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:24:40.734+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:24:40.734+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: e0097198-302c-4d98-ad98-9c936276386f
2021-01-13T15:24:40.765+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:24:40.765+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:24:40.765+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:24:40.765+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--11147294422768186
2021-01-13T15:24:40.765+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:40.767+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:24:40.767+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 94055c5d-1180-4259-b3ba-b35709337264
2021-01-13T15:24:40.786+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.symbols with generated UUID: 8bdd8475-00fd-4c63-be86-68caf374ece6
2021-01-13T15:24:40.804+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.symbols as collection version: <unsharded>
2021-01-13T15:24:40.813+0000 I INDEX    [conn4] build index on: arctic_test.TEST.symbols properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_test.TEST.symbols", background: true }
2021-01-13T15:24:40.813+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:40.814+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 9feaeac5-7fb7-4626-9f13-3efbeba1cb14
2021-01-13T15:24:40.844+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { sy: "hashed" }, name: "sy_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:40.845+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:40.846+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:24:40.856+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, sh: 1 }, name: "sy_1_sh_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:40.856+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:40.867+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, s: 1, e: 1, sg: 1 }, name: "sy_1_s_1_e_1_sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:40.867+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:40.879+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { sy: 1, s: 1, sg: 1 }, name: "sy_1_s_1_sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:40.879+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:40.890+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { sg: 1 }, name: "sg_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:24:40.890+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:24:40.891+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.metadata with generated UUID: f2c675b1-7781-4a82-92b8-b51b9c10fa28
2021-01-13T15:24:40.908+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.metadata as collection version: <unsharded>
2021-01-13T15:24:40.918+0000 I INDEX    [conn4] build index on: arctic_test.TEST.metadata properties: { v: 2, unique: true, key: { sy: 1, s: 1, e: 1 }, name: "sy_1_s_1_e_1", ns: "arctic_test.TEST.metadata", background: true }
2021-01-13T15:24:40.918+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:24:40,087 DEBUG pytest_shutil.workspace 
2021-01-13 15:24:40,087 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:40,087 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp7kuhlnrm
2021-01-13 15:24:40,087 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:24:40,087 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:40,087 DEBUG pytest_shutil.workspace 
2021-01-13 15:24:40,088 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:24:40,097 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=26936 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp7kuhlnrm
2021-01-13 15:24:40,098 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:24:40,098 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:24:40,099 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:26936
2021-01-13 15:24:40,705 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:24:40,706 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:26936
2021-01-13 15:24:40,714 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615844 for server to start successfully
2021-01-13 15:24:40,715 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:24:40,716 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:24:40,919 INFO arctic.chunkstore.chunkstore Trying to enable sharding...
2021-01-13 15:24:40,921 WARNING arctic.chunkstore.chunkstore Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp7kuhlnrm
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=26936 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp7kuhlnrm
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:26936
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:26936
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615844 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.chunkstore.chunkstore:chunkstore.py:46 Trying to enable sharding...
[33mWARNING [0m arctic.chunkstore.chunkstore:chunkstore.py:50 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:24:40.932+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:24:40.933+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:24:41.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:24:40,942 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:24:41,028 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 10402 (total_procs_to_kill=1)
2021-01-13 15:24:41,029 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:24:41,029 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:24:41,033 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:24:41,033 DEBUG pytest_shutil.workspace 
2021-01-13 15:24:41,033 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:41,033 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp7kuhlnrm
2021-01-13 15:24:41,033 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:24:41,033 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 10402 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp7kuhlnrm
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_____________ test_save_read_pandas_series_with_unicode_index_name _____________[0m

library = <VersionStore at 0x7f84e7617908>
    <ArcticLibrary at 0x7f84e76b9a58, arctic_test.TEST>
        <Arctic at 0x7f84e7716dd8, connected to MongoClient(host=['127.67.249.105:12883'], document_class=dict, tz_aware=False, connect=True)>

    def test_save_read_pandas_series_with_unicode_index_name(library):
        df = Series(data=['A', 'BC', 'DEF'],
                    index=MultiIndex.from_tuples([(np.datetime64(dt(2013, 1, 1)),),
                                                  (np.datetime64(dt(2013, 1, 2)),),
                                                  (np.datetime64(dt(2013, 1, 3)),)], names=[u'DATETIME']))
        library.write('pandas', df)
>       saved_df = library.read('pandas').data

[1m[31mtests/integration/store/test_pandas_store.py[0m:78: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31marctic/store/version_store.py[0m:369: in read
    date_range=date_range, read_preference=read_preference, **kwargs)
[1m[31marctic/store/version_store.py[0m:453: in _do_read
    data = handler.read(self._arctic_lib, version, symbol, from_version=from_version, **kwargs)
[1m[31marctic/store/_pandas_ndarray_store.py[0m:179: in read
    return self.SERIALIZER.deserialize(item, force_bytes_to_unicode=force_bytes_to_unicode)
[1m[31marctic/serialization/numpy_records.py[0m:233: in deserialize
    index = self._index_from_records(item)
[1m[31marctic/serialization/numpy_records.py[0m:99: in _index_from_records
    rtn = rtn.tz_localize('UTC').tz_convert(recarr.dtype.metadata['index_tz'])
[1m[31m../../../virtualenv/python3.6.7/lib/python3.6/site-packages/pandas/core/indexes/extension.py[0m:78: in method
    result = attr(self._data, *args, **kwargs)
[1m[31m../../../virtualenv/python3.6.7/lib/python3.6/site-packages/pandas/core/arrays/datetimes.py[0m:798: in tz_convert
    tz = timezones.maybe_get_tz(tz)
[1m[31mpandas/_libs/tslibs/timezones.pyx[0m:91: in pandas._libs.tslibs.timezones.maybe_get_tz
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
[1m[31mE   TypeError: <class 'list'>[0m

[1m[31mpandas/_libs/tslibs/timezones.pyx[0m:114: TypeError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:28:41.449+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:28:41.451+0000 I CONTROL  [initandlisten] MongoDB starting : pid=18195 port=12883 dbpath=/tmp/tmpq5f97qr3 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:28:41.451+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:28:41.451+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:28:41.451+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:28:41.451+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:28:41.451+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:28:41.451+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:28:41.451+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:28:41.451+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:28:41.451+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:28:41.451+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 12883, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpq5f97qr3", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:28:41.451+0000 I STORAGE  [initandlisten] 
2021-01-13T15:28:41.451+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:28:41.451+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:28:41.451+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:28:41.948+0000 I STORAGE  [initandlisten] WiredTiger message [1610551721:948802][18195:0x7f6c296d2a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:28:41.960+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:28:41.985+0000 I CONTROL  [initandlisten] 
2021-01-13T15:28:41.985+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:28:41.985+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:28:41.985+0000 I CONTROL  [initandlisten] 
2021-01-13T15:28:41.985+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: c88ba948-b3fe-4cbe-abee-7769fd8ed284
2021-01-13T15:28:42.005+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:28:42.005+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:28:42.005+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:28:42.006+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:28:42.006+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 10601226-5c1d-492d-9d6a-26d61ec7f3fc
2021-01-13T15:28:42.025+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:28:42.025+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpq5f97qr3/diagnostic.data'
2021-01-13T15:28:42.026+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:28:42.026+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 1ebb48a2-f1b6-4e4d-88c3-cc6b53573181
2021-01-13T15:28:42.027+0000 I NETWORK  [initandlisten] waiting for connections on port 12883
2021-01-13T15:28:42.045+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:42122 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:28:42.046+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:42124 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:28:42.050+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:42126 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:28:42.053+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:42128 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:28:42.053+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:28:42.053+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:28:42.054+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:42.055+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:28:42.058+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:28:42.058+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 2d617164-1c37-4949-b82a-bf7559406049
2021-01-13T15:28:42.088+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:28:42.088+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:28:42.088+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:28:42.088+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-7524330048963207729
2021-01-13T15:28:42.088+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:42.090+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:28:42.090+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: c6c75906-28f7-4e16-849d-31636b432a39
2021-01-13T15:28:42.110+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: b9cfb632-f26c-4576-8529-9dbb97c527f9
2021-01-13T15:28:42.126+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:28:42.135+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:28:42.135+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:42.136+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 6c9db431-2b40-453d-8323-2783ebb6acc3
2021-01-13T15:28:42.165+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:28:42.165+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:42.166+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:28:42.175+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:28:42.175+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:42.176+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: d3e59a92-d787-40c4-8b7e-8a1df3adb810
2021-01-13T15:28:42.198+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:28:42.208+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:28:42.208+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:42.209+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 4f4bff30-5daa-42e1-8daf-e869a4e4ab1e
2021-01-13T15:28:42.237+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:28:42.238+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:42.239+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:28:42.249+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:28:42.249+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:42.259+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:28:42.259+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:42.269+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:28:42.270+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:28:41,423 DEBUG pytest_shutil.workspace 
2021-01-13 15:28:41,423 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:28:41,424 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpq5f97qr3
2021-01-13 15:28:41,424 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:28:41,424 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:28:41,424 DEBUG pytest_shutil.workspace 
2021-01-13 15:28:41,424 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:28:41,434 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=12883 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpq5f97qr3
2021-01-13 15:28:41,434 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:28:41,435 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:28:41,435 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:12883
2021-01-13 15:28:42,041 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:28:42,042 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:12883
2021-01-13 15:28:42,051 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615640 for server to start successfully
2021-01-13 15:28:42,051 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:28:42,052 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:28:42,277 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:28:42,279 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpq5f97qr3
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=12883 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpq5f97qr3
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:12883
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:12883
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615640 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:28:42.288+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:28:42.289+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:28:42,300 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:28:42,303 INFO arctic.serialization.numpy_records Series has no name, defaulting to 'values'
2021-01-13 15:28:42,304 INFO arctic.serialization.numpy_records Series has no name, defaulting to 'values'
2021-01-13 15:28:42,308 DEBUG arctic.store.version_store Finished writing versions for pandas
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[32mINFO    [0m arctic.serialization.numpy_records:numpy_records.py:227 Series has no name, defaulting to 'values'
[32mINFO    [0m arctic.serialization.numpy_records:numpy_records.py:227 Series has no name, defaulting to 'values'
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for pandas
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:28:42,656 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 18195 (total_procs_to_kill=1)
2021-01-13 15:28:42,656 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:28:42,657 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:28:42,661 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:28:42,661 DEBUG pytest_shutil.workspace 
2021-01-13 15:28:42,661 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:28:42,661 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpq5f97qr3
2021-01-13 15:28:42,661 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:28:42,661 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 18195 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpq5f97qr3
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m___________ test_save_read_pandas_dataframe_with_unicode_index_name ____________[0m

library = <VersionStore at 0x7f84e47c3a58>
    <ArcticLibrary at 0x7f84e47c3b38, arctic_test.TEST>
        <Arctic at 0x7f84f4042fd0, connected to MongoClient(host=['127.67.249.105:25202'], document_class=dict, tz_aware=False, connect=True)>

    def test_save_read_pandas_dataframe_with_unicode_index_name(library):
        df = DataFrame(data=['A', 'BC', 'DEF'],
                       index=MultiIndex.from_tuples([(np.datetime64(dt(2013, 1, 1)),),
                                                     (np.datetime64(dt(2013, 1, 2)),),
                                                     (np.datetime64(dt(2013, 1, 3)),)], names=[u'DATETIME']))
        library.write('pandas', df)
>       saved_df = library.read('pandas').data

[1m[31mtests/integration/store/test_pandas_store.py[0m:102: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31marctic/store/version_store.py[0m:369: in read
    date_range=date_range, read_preference=read_preference, **kwargs)
[1m[31marctic/store/version_store.py[0m:453: in _do_read
    data = handler.read(self._arctic_lib, version, symbol, from_version=from_version, **kwargs)
[1m[31marctic/store/_pandas_ndarray_store.py[0m:209: in read
    return self.SERIALIZER.deserialize(item, force_bytes_to_unicode=force_bytes_to_unicode)
[1m[31marctic/serialization/numpy_records.py[0m:286: in deserialize
    index = self._index_from_records(item)
[1m[31marctic/serialization/numpy_records.py[0m:99: in _index_from_records
    rtn = rtn.tz_localize('UTC').tz_convert(recarr.dtype.metadata['index_tz'])
[1m[31m../../../virtualenv/python3.6.7/lib/python3.6/site-packages/pandas/core/indexes/extension.py[0m:78: in method
    result = attr(self._data, *args, **kwargs)
[1m[31m../../../virtualenv/python3.6.7/lib/python3.6/site-packages/pandas/core/arrays/datetimes.py[0m:798: in tz_convert
    tz = timezones.maybe_get_tz(tz)
[1m[31mpandas/_libs/tslibs/timezones.pyx[0m:91: in pandas._libs.tslibs.timezones.maybe_get_tz
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
[1m[31mE   TypeError: <class 'list'>[0m

[1m[31mpandas/_libs/tslibs/timezones.pyx[0m:114: TypeError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:28:44.517+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:28:44.520+0000 I CONTROL  [initandlisten] MongoDB starting : pid=18300 port=25202 dbpath=/tmp/tmpc051lvmz 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:28:44.520+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:28:44.520+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:28:44.520+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:28:44.520+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:28:44.520+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:28:44.520+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:28:44.520+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:28:44.520+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:28:44.520+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:28:44.520+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 25202, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpc051lvmz", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:28:44.520+0000 I STORAGE  [initandlisten] 
2021-01-13T15:28:44.520+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:28:44.520+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:28:44.520+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:28:45.015+0000 I STORAGE  [initandlisten] WiredTiger message [1610551725:15939][18300:0x7f8b7e91ca80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:28:45.029+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:28:45.051+0000 I CONTROL  [initandlisten] 
2021-01-13T15:28:45.052+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:28:45.052+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:28:45.052+0000 I CONTROL  [initandlisten] 
2021-01-13T15:28:45.052+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 420afd50-638e-4657-8060-dac5a4785078
2021-01-13T15:28:45.071+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:28:45.071+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:28:45.071+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:28:45.071+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:28:45.071+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: d031ee56-c28d-4424-8bfb-5bf227f3915e
2021-01-13T15:28:45.092+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:28:45.093+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpc051lvmz/diagnostic.data'
2021-01-13T15:28:45.094+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:28:45.094+0000 I NETWORK  [initandlisten] waiting for connections on port 25202
2021-01-13T15:28:45.094+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:28:45.094+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 270e0328-3044-4df1-b7db-e3ad93cd32e0
2021-01-13T15:28:45.113+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:33334 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:28:45.114+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:33336 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:28:45.119+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:33338 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:28:45.121+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:33340 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:28:45.124+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:28:45.124+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:28:45.124+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:28:45.124+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-1183500576225725866
2021-01-13T15:28:45.124+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:45.128+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:28:45.128+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: d7a246a0-4486-4fe2-8459-613e895984c9
2021-01-13T15:28:45.159+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:28:45.159+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:28:45.159+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:28:45.159+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-1183500576225725866
2021-01-13T15:28:45.159+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:45.162+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:28:45.162+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 408ff06d-bd63-4060-af3a-cf11d3569c55
2021-01-13T15:28:45.183+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: aca5aae9-89bf-4ae7-82f6-7c3dacc96ade
2021-01-13T15:28:45.200+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:28:45.211+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:28:45.211+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:45.212+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 9864424f-2235-4e81-9d4a-f1ee8a26ffba
2021-01-13T15:28:45.242+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:28:45.242+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:45.243+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:28:45.253+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:28:45.253+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:45.254+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: dd282752-8092-49c5-bf37-b6b4b050d362
2021-01-13T15:28:45.273+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:28:45.285+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:28:45.285+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:45.286+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: ee3066ab-f437-484c-b853-771b1460e785
2021-01-13T15:28:45.316+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:28:45.316+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:45.317+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:28:45.329+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:28:45.329+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:45.340+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:28:45.341+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:28:45.353+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:28:45.353+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:28:44,492 DEBUG pytest_shutil.workspace 
2021-01-13 15:28:44,492 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:28:44,492 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpc051lvmz
2021-01-13 15:28:44,492 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:28:44,492 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:28:44,492 DEBUG pytest_shutil.workspace 
2021-01-13 15:28:44,493 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:28:44,502 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=25202 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpc051lvmz
2021-01-13 15:28:44,503 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:28:44,503 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:28:44,504 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:25202
2021-01-13 15:28:45,109 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:28:45,110 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:25202
2021-01-13 15:28:45,119 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615977 for server to start successfully
2021-01-13 15:28:45,120 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:28:45,121 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:28:45,360 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:28:45,362 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpc051lvmz
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=25202 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpc051lvmz
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:25202
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:25202
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615977 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:28:45.371+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:28:45.372+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:28:45,382 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:28:45,386 INFO arctic.serialization.numpy_records Dataframe column names converted to strings
2021-01-13 15:28:45,386 INFO arctic.serialization.numpy_records Dataframe column names converted to strings
2021-01-13 15:28:45,390 DEBUG arctic.store.version_store Finished writing versions for pandas
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[32mINFO    [0m arctic.serialization.numpy_records:numpy_records.py:272 Dataframe column names converted to strings
[32mINFO    [0m arctic.serialization.numpy_records:numpy_records.py:272 Dataframe column names converted to strings
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for pandas
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:28:45,605 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 18300 (total_procs_to_kill=1)
2021-01-13 15:28:45,605 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:28:45,605 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:28:45,609 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:28:45,609 DEBUG pytest_shutil.workspace 
2021-01-13 15:28:45,610 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:28:45,610 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpc051lvmz
2021-01-13 15:28:45,610 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:28:45,610 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 18300 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpc051lvmz
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m________________________ test_daterange_large_DataFrame ________________________[0m

library = <VersionStore at 0x7f84e7649f28>
    <ArcticLibrary at 0x7f84e47a8550, arctic_test.TEST>
        <Arctic at 0x7f84f415b5c0, connected to MongoClient(host=['127.67.249.105:4954'], document_class=dict, tz_aware=False, connect=True)>

    def test_daterange_large_DataFrame(library):
        df = DataFrame(index=date_range(dt(2001, 1, 1), freq='S', periods=30 * 1024),
                       data=np.tile(np.arange(30 * 1024), 100).reshape((-1, 100)))
        df.columns = [str(c) for c in df.columns]
        library.write('MYARR', df)
        # assert saved
        saved_arr = library.read('MYARR').data
>       assert_frame_equal(df, saved_arr, check_names=False)
[1m[31mE       AssertionError: (<Second>, None)[0m

[1m[31mtests/integration/store/test_pandas_store.py[0m:805: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:30:22.685+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:30:22.688+0000 I CONTROL  [initandlisten] MongoDB starting : pid=21749 port=4954 dbpath=/tmp/tmptx6fx1a6 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:30:22.688+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:30:22.688+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:30:22.688+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:30:22.688+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:30:22.688+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:30:22.688+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:30:22.688+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:30:22.688+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:30:22.688+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:30:22.688+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 4954, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmptx6fx1a6", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:30:22.688+0000 I STORAGE  [initandlisten] 
2021-01-13T15:30:22.688+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:30:22.688+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:30:22.689+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:30:23.192+0000 I STORAGE  [initandlisten] WiredTiger message [1610551823:192639][21749:0x7f58bd233a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:30:23.207+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:30:23.237+0000 I CONTROL  [initandlisten] 
2021-01-13T15:30:23.237+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:30:23.237+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:30:23.237+0000 I CONTROL  [initandlisten] 
2021-01-13T15:30:23.237+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: af1cb781-9b7f-403a-81bb-e9e94393e223
2021-01-13T15:30:23.258+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:30:23.258+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:30:23.258+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:30:23.258+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:30:23.258+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: b0768606-16e3-4fb2-b6d2-1a9b86fc2d7b
2021-01-13T15:30:23.279+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:30:23.280+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmptx6fx1a6/diagnostic.data'
2021-01-13T15:30:23.281+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:30:23.282+0000 I NETWORK  [initandlisten] waiting for connections on port 4954
2021-01-13T15:30:23.282+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:30:23.282+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: de8a1ad3-3abc-4860-9a7a-da8b5f10439f
2021-01-13T15:30:23.312+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:30:23.312+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:30:23.312+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:30:23.312+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-8316241191723987461
2021-01-13T15:30:23.312+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:23.783+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:37794 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:23.886+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:37796 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:23.888+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:37798 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:23.892+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:37800 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:23.894+0000 I NETWORK  [conn5] received client metadata from 127.0.0.1:37802 conn5: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:23.898+0000 I SHARDING [conn5] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:30:23.899+0000 I STORAGE  [conn5] createCollection: meta_db.cache with generated UUID: c7ff323c-8c1b-48a7-adda-b26e7745a13c
2021-01-13T15:30:23.932+0000 I INDEX    [conn5] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:30:23.932+0000 I INDEX    [conn5] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:30:23.932+0000 W STORAGE  [conn5] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:30:23.932+0000 W STORAGE  [conn5] falling back to non-bulk cursor for index table:index-9-8316241191723987461
2021-01-13T15:30:23.932+0000 I INDEX    [conn5] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:23.935+0000 I SHARDING [conn5] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:30:23.935+0000 I STORAGE  [conn5] createCollection: arctic_test.TEST.ARCTIC with generated UUID: be05a592-a1e8-4579-931f-f7a1e9339a65
2021-01-13T15:30:23.957+0000 I STORAGE  [conn5] createCollection: arctic_test.TEST.snapshots with generated UUID: 9a9f458c-ad67-469c-81ad-fb670b758ec1
2021-01-13T15:30:23.977+0000 I SHARDING [conn5] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:30:23.988+0000 I INDEX    [conn5] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:30:23.988+0000 I INDEX    [conn5] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:23.990+0000 I STORAGE  [conn5] createCollection: arctic_test.TEST.versions with generated UUID: 55307f75-de22-469a-b6c9-17ca5a2a84ae
2021-01-13T15:30:24.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:30:24.025+0000 I INDEX    [conn5] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:30:24.025+0000 I INDEX    [conn5] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:24.026+0000 I SHARDING [conn5] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:30:24.039+0000 I INDEX    [conn5] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:30:24.039+0000 I INDEX    [conn5] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:24.040+0000 I STORAGE  [conn5] createCollection: arctic_test.TEST.version_nums with generated UUID: afa902bd-5503-42e1-8d1d-1fd29d18e367
2021-01-13T15:30:24.064+0000 I SHARDING [conn5] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:30:24.076+0000 I INDEX    [conn5] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:30:24.076+0000 I INDEX    [conn5] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:24.078+0000 I STORAGE  [conn5] createCollection: arctic_test.TEST with generated UUID: 243b01a6-0ade-48dc-b894-0c6006a018c7
2021-01-13T15:30:24.112+0000 I INDEX    [conn5] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:24.112+0000 I INDEX    [conn5] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:24.113+0000 I SHARDING [conn5] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:30:24.126+0000 I INDEX    [conn5] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:24.126+0000 I INDEX    [conn5] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:24.138+0000 I INDEX    [conn5] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:24.139+0000 I INDEX    [conn5] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:24.152+0000 I INDEX    [conn5] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:24.152+0000 I INDEX    [conn5] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:30:22,658 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:22,658 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:22,658 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmptx6fx1a6
2021-01-13 15:30:22,658 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:30:22,659 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:22,659 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:22,659 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:30:22,669 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=4954 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmptx6fx1a6
2021-01-13 15:30:22,670 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:30:22,671 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:30:22,671 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:4954
2021-01-13 15:30:23,278 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:30:23,278 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:4954
2021-01-13 15:30:23,883 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (3 of 28)
2021-01-13 15:30:23,883 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:4954
2021-01-13 15:30:23,892 DEBUG pytest_server_fixtures.base2 waited 0:00:01.221618 for server to start successfully
2021-01-13 15:30:23,892 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:30:23,893 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:30:24,160 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:30:24,162 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmptx6fx1a6
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=4954 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmptx6fx1a6
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:4954
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:4954
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (3 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:4954
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:01.221618 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:30:24.175+0000 I SHARDING [conn5] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:30:24.175+0000 I SHARDING [conn5] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:30:24,187 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:30:24,191 INFO arctic.serialization.numpy_records Index has no name, defaulting to 'index'
2021-01-13 15:30:24,431 DEBUG arctic.store.version_store Finished writing versions for MYARR
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[32mINFO    [0m arctic.serialization.numpy_records:numpy_records.py:83 Index has no name, defaulting to 'index'
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for MYARR
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:30:24,657 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 21749 (total_procs_to_kill=1)
2021-01-13 15:30:24,657 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:30:24,658 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:30:24,665 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:30:24,665 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:24,665 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:24,666 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmptx6fx1a6
2021-01-13 15:30:24,666 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:24,666 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 21749 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmptx6fx1a6
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m____________________ test_daterange_large_DataFrame_middle _____________________[0m

library = <VersionStore at 0x7f84e76d15c0>
    <ArcticLibrary at 0x7f84f4045908, arctic_test.TEST>
        <Arctic at 0x7f84f5f80be0, connected to MongoClient(host=['127.67.249.105:20876'], document_class=dict, tz_aware=False, connect=True)>

    def test_daterange_large_DataFrame_middle(library):
        df = DataFrame(index=date_range(dt(2001, 1, 1), freq='S', periods=30 * 1024),
                       data=np.tile(np.arange(30 * 1024), 100).reshape((-1, 100)))
        df.columns = [str(c) for c in df.columns]
        library.write('MYARR', df)
        # middle
        start = 100
        for end in np.arange(200, 30000, 1000):
            result = library.read('MYARR', date_range=DateRange(df.index[start], df.index[end])).data
>           assert_frame_equal(df[df.index[start]:df.index[end]], result, check_names=False)
[1m[31mE           AssertionError: (<Second>, None)[0m

[1m[31mtests/integration/store/test_pandas_store.py[0m:841: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:30:24.696+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:30:24.699+0000 I CONTROL  [initandlisten] MongoDB starting : pid=21787 port=20876 dbpath=/tmp/tmpl0q_297k 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:30:24.699+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:30:24.699+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:30:24.699+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:30:24.699+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:30:24.699+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:30:24.699+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:30:24.699+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:30:24.699+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:30:24.699+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:30:24.699+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 20876, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpl0q_297k", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:30:24.699+0000 I STORAGE  [initandlisten] 
2021-01-13T15:30:24.699+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:30:24.699+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:30:24.699+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:30:25.201+0000 I STORAGE  [initandlisten] WiredTiger message [1610551825:201510][21787:0x7f4401151a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:30:25.215+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:30:25.241+0000 I CONTROL  [initandlisten] 
2021-01-13T15:30:25.241+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:30:25.241+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:30:25.241+0000 I CONTROL  [initandlisten] 
2021-01-13T15:30:25.241+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 939fd308-a63c-46a6-81fd-2eb6b2c9e52e
2021-01-13T15:30:25.261+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:30:25.261+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:30:25.261+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:30:25.261+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:30:25.261+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 9c142f66-4aae-4700-8859-1d32ab22f4c0
2021-01-13T15:30:25.282+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:30:25.283+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpl0q_297k/diagnostic.data'
2021-01-13T15:30:25.284+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:30:25.284+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 5e47e90a-4897-468d-9f28-f55aaefb5ff4
2021-01-13T15:30:25.284+0000 I NETWORK  [initandlisten] waiting for connections on port 20876
2021-01-13T15:30:25.292+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:55516 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:25.293+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:55518 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:25.296+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:55520 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:25.298+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:55522 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:25.315+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:30:25.315+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:30:25.316+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:25.316+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:30:25.321+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:30:25.321+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 1cde1b76-b324-41af-998c-28de3bc9acc1
2021-01-13T15:30:25.354+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:30:25.354+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:30:25.354+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:30:25.354+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-6388368553083715509
2021-01-13T15:30:25.354+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:25.357+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:30:25.357+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: edf8d15b-cb02-4889-8118-82a0bfdc3074
2021-01-13T15:30:25.380+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: bf0bb9f6-9460-4daa-ace3-5d044eeaf194
2021-01-13T15:30:25.405+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:30:25.418+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:30:25.418+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:25.419+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 7fd1d7ad-5067-438b-b7b5-1d22e02b1007
2021-01-13T15:30:25.456+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:30:25.456+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:25.458+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:30:25.471+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:30:25.471+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:25.472+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 4cab217a-7cf4-4a48-a1ba-7e2e0760d5d4
2021-01-13T15:30:25.498+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:30:25.512+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:30:25.512+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:25.513+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 1f6e28a2-c03a-4d62-81ae-e3f37285019d
2021-01-13T15:30:25.549+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:25.549+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:25.550+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:30:25.564+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:25.564+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:25.578+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:25.578+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:25.591+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:25.591+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:30:24,669 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:24,669 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:24,670 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpl0q_297k
2021-01-13 15:30:24,670 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:30:24,670 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:24,670 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:24,670 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:30:24,680 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=20876 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpl0q_297k
2021-01-13 15:30:24,681 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:30:24,682 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:30:24,682 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:20876
2021-01-13 15:30:25,288 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:30:25,288 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:20876
2021-01-13 15:30:25,296 DEBUG pytest_server_fixtures.base2 waited 0:00:00.614861 for server to start successfully
2021-01-13 15:30:25,297 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:30:25,297 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:30:25,599 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:30:25,602 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpl0q_297k
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=20876 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpl0q_297k
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:20876
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:20876
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.614861 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:30:25.622+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:30:25.623+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:30:25,635 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:30:25,638 INFO arctic.serialization.numpy_records Index has no name, defaulting to 'index'
2021-01-13 15:30:25,898 DEBUG arctic.store.version_store Finished writing versions for MYARR
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[32mINFO    [0m arctic.serialization.numpy_records:numpy_records.py:83 Index has no name, defaulting to 'index'
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for MYARR
--------------------------- Captured stdout teardown ---------------------------
2021-01-13T15:30:26.005+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:30:26,006 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 21787 (total_procs_to_kill=1)
2021-01-13 15:30:26,006 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:30:26,008 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:30:26,015 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:30:26,015 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:26,015 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:26,016 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpl0q_297k
2021-01-13 15:30:26,016 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:26,016 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 21787 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpl0q_297k
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m____________________ test_daterange[df0-assert_frame_equal] ____________________[0m

library = <VersionStore at 0x7f84e75af5c0>
    <ArcticLibrary at 0x7f84e75af358, arctic_test.TEST>
        <Arctic at 0x7f84e75af6d8, connected to MongoClient(host=['127.67.249.105:18987'], document_class=dict, tz_aware=False, connect=True)>
df =                 A
idx              
2001-01-01      0
2001-01-02      1
2001-01-03      2
2001-01-04      3
2001-01-05......
2083-02-15  29995
2083-02-16  29996
2083-02-17  29997
2083-02-18  29998
2083-02-19  29999

[30000 rows x 1 columns]
assert_equal = <function assert_frame_equal at 0x7f84fc5fd730>

    @pytest.mark.parametrize("df,assert_equal", [
        (DataFrame(index=date_range(dt(2001, 1, 1), freq='D', periods=30000),
                   data=list(range(30000)), columns=['A']), assert_frame_equal),
        (Series(index=date_range(dt(2001, 1, 1), freq='D', periods=30000),
                data=range(30000)), assert_series_equal),
    ])
    def test_daterange(library, df, assert_equal):
        df.index.name = 'idx'
        df.name = 'FOO'
        library.write('MYARR', df)
        # whole array
        saved_arr = library.read('MYARR').data
>       assert_equal(df, saved_arr)
[1m[31mE       AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/store/test_pandas_store.py[0m:862: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:30:26.047+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:30:26.049+0000 I CONTROL  [initandlisten] MongoDB starting : pid=21822 port=18987 dbpath=/tmp/tmpgd3872r1 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:30:26.049+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:30:26.049+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:30:26.049+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:30:26.049+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:30:26.049+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:30:26.049+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:30:26.049+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:30:26.049+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:30:26.049+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:30:26.049+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 18987, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpgd3872r1", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:30:26.049+0000 I STORAGE  [initandlisten] 
2021-01-13T15:30:26.049+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:30:26.049+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:30:26.049+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:30:26.551+0000 I STORAGE  [initandlisten] WiredTiger message [1610551826:551237][21822:0x7f4b27636a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:30:26.564+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:30:26.591+0000 I CONTROL  [initandlisten] 
2021-01-13T15:30:26.591+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:30:26.591+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:30:26.591+0000 I CONTROL  [initandlisten] 
2021-01-13T15:30:26.591+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 34f7004f-18e2-4c94-b7a6-ee36be66dc47
2021-01-13T15:30:26.614+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:30:26.614+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:30:26.614+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:30:26.614+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:30:26.615+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 3629b8b7-b67f-4b23-8cb1-e3d5626a199c
2021-01-13T15:30:26.634+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:30:26.634+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpgd3872r1/diagnostic.data'
2021-01-13T15:30:26.635+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:30:26.636+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 379a32a5-7f62-4fc5-a193-fd6f4918e923
2021-01-13T15:30:26.636+0000 I NETWORK  [initandlisten] waiting for connections on port 18987
2021-01-13T15:30:26.642+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:58278 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:26.644+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:58280 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:26.647+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:58282 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:26.650+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:58284 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:26.664+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:30:26.664+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:30:26.666+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:26.666+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:30:26.670+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:30:26.670+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 7ee77932-5168-4537-aa0f-303a7eb15a7e
2021-01-13T15:30:26.699+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:30:26.699+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:30:26.699+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:30:26.699+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-1988919095918827896
2021-01-13T15:30:26.699+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:26.701+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:30:26.701+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 2322179b-80c0-4fbc-9482-fb93c015f369
2021-01-13T15:30:26.722+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: d4f4e24f-8252-4f16-b718-b0abd1e0068b
2021-01-13T15:30:26.742+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:30:26.752+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:30:26.752+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:26.753+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 6007fc33-1a1e-46ab-a678-ce0e796f5152
2021-01-13T15:30:26.784+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:30:26.784+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:26.785+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:30:26.795+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:30:26.795+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:26.796+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: efb60924-2345-494e-993d-23a6e5d6cead
2021-01-13T15:30:26.815+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:30:26.823+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:30:26.823+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:26.824+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 82330662-028b-45ef-93e2-246962b5671d
2021-01-13T15:30:26.854+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:26.854+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:26.855+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:30:26.864+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:26.864+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:26.875+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:26.875+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:26.889+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:26.889+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:30:26,019 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:26,020 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:26,020 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpgd3872r1
2021-01-13 15:30:26,020 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:30:26,020 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:26,020 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:26,020 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:30:26,031 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=18987 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpgd3872r1
2021-01-13 15:30:26,032 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:30:26,032 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:30:26,033 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:18987
2021-01-13 15:30:26,639 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:30:26,640 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:18987
2021-01-13 15:30:26,647 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615072 for server to start successfully
2021-01-13 15:30:26,648 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:30:26,648 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:30:26,898 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:30:26,900 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpgd3872r1
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=18987 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpgd3872r1
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:18987
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:18987
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615072 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:30:26.907+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:30:26.907+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:30:26,917 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:30:26,929 DEBUG arctic.store.version_store Finished writing versions for MYARR
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for MYARR
--------------------------- Captured stdout teardown ---------------------------
2021-01-13T15:30:27.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:30:27,020 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 21822 (total_procs_to_kill=1)
2021-01-13 15:30:27,020 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:30:27,021 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:30:27,025 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:30:27,025 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:27,025 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:27,025 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpgd3872r1
2021-01-13 15:30:27,025 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:27,025 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 21822 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpgd3872r1
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m___________________ test_daterange[df1-assert_series_equal] ____________________[0m

library = <VersionStore at 0x7f84e75afe10>
    <ArcticLibrary at 0x7f84e75a9470, arctic_test.TEST>
        <Arctic at 0x7f84e75afe48, connected to MongoClient(host=['127.67.249.105:25636'], document_class=dict, tz_aware=False, connect=True)>
df = idx
2001-01-01        0
2001-01-02        1
2001-01-03        2
2001-01-04        3
2001-01-05        4
              ...16    29996
2083-02-17    29997
2083-02-18    29998
2083-02-19    29999
Freq: D, Name: FOO, Length: 30000, dtype: int64
assert_equal = <function assert_series_equal at 0x7f84fc5fd6a8>

    @pytest.mark.parametrize("df,assert_equal", [
        (DataFrame(index=date_range(dt(2001, 1, 1), freq='D', periods=30000),
                   data=list(range(30000)), columns=['A']), assert_frame_equal),
        (Series(index=date_range(dt(2001, 1, 1), freq='D', periods=30000),
                data=range(30000)), assert_series_equal),
    ])
    def test_daterange(library, df, assert_equal):
        df.index.name = 'idx'
        df.name = 'FOO'
        library.write('MYARR', df)
        # whole array
        saved_arr = library.read('MYARR').data
>       assert_equal(df, saved_arr)
[1m[31mE       AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/store/test_pandas_store.py[0m:862: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:30:27.056+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:30:27.058+0000 I CONTROL  [initandlisten] MongoDB starting : pid=21857 port=25636 dbpath=/tmp/tmpp69xwyy6 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:30:27.058+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:30:27.058+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:30:27.058+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:30:27.058+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:30:27.058+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:30:27.058+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:30:27.058+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:30:27.058+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:30:27.058+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:30:27.058+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 25636, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpp69xwyy6", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:30:27.059+0000 I STORAGE  [initandlisten] 
2021-01-13T15:30:27.059+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:30:27.059+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:30:27.059+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:30:27.556+0000 I STORAGE  [initandlisten] WiredTiger message [1610551827:556138][21857:0x7f8921aaea80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:30:27.570+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:30:27.595+0000 I CONTROL  [initandlisten] 
2021-01-13T15:30:27.595+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:30:27.595+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:30:27.595+0000 I CONTROL  [initandlisten] 
2021-01-13T15:30:27.595+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 005005fa-6161-45f4-a186-6fd8bb84a3a1
2021-01-13T15:30:27.614+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:30:27.614+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:30:27.614+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:30:27.614+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:30:27.615+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: dd7ce19a-dda1-4fca-8773-7a0bc9199df6
2021-01-13T15:30:27.633+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:30:27.633+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpp69xwyy6/diagnostic.data'
2021-01-13T15:30:27.634+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:30:27.634+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 7a2cda8f-6903-4b4d-bca6-1650c63be903
2021-01-13T15:30:27.635+0000 I NETWORK  [initandlisten] waiting for connections on port 25636
2021-01-13T15:30:27.652+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:52652 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:27.653+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:52654 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:27.657+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:52656 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:27.659+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:52658 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:27.662+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:30:27.662+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:30:27.662+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:30:27.662+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-100575442982616807
2021-01-13T15:30:27.662+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:27.662+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:30:27.665+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:30:27.665+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: d3f3f5bc-dfcc-4fd3-bad4-5af9a0568d7b
2021-01-13T15:30:27.696+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:30:27.696+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:30:27.696+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:30:27.696+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-100575442982616807
2021-01-13T15:30:27.696+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:27.698+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:30:27.698+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: f76c231a-10b2-4339-9ca9-aad54d7046c0
2021-01-13T15:30:27.718+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 3528f21d-9d57-48d8-a612-0cd7aeda6280
2021-01-13T15:30:27.736+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:30:27.746+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:30:27.746+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:27.747+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 753bfa63-fefc-4832-945a-a5e7bd9bc0f0
2021-01-13T15:30:27.778+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:30:27.778+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:27.779+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:30:27.789+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:30:27.789+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:27.790+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: dc9c3ac6-47ac-44eb-8bcb-70331f7158d7
2021-01-13T15:30:27.811+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:30:27.821+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:30:27.821+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:27.822+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 940f5be2-2a94-4460-a31c-a6498c07fb09
2021-01-13T15:30:27.848+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:27.849+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:27.850+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:30:27.862+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:27.862+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:27.875+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:27.875+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:27.887+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:27.887+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:30:27,029 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:27,029 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:27,029 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpp69xwyy6
2021-01-13 15:30:27,029 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:30:27,029 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:27,030 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:27,030 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:30:27,040 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=25636 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpp69xwyy6
2021-01-13 15:30:27,041 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:30:27,042 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:30:27,042 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:25636
2021-01-13 15:30:27,648 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:30:27,649 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:25636
2021-01-13 15:30:27,658 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616140 for server to start successfully
2021-01-13 15:30:27,658 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:30:27,659 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:30:27,894 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:30:27,897 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpp69xwyy6
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=25636 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpp69xwyy6
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:25636
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:25636
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616140 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:30:27.904+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:30:27.905+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:30:27,914 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:30:27,926 DEBUG arctic.store.version_store Finished writing versions for MYARR
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for MYARR
--------------------------- Captured stdout teardown ---------------------------
2021-01-13T15:30:28.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:30:28,010 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 21857 (total_procs_to_kill=1)
2021-01-13 15:30:28,011 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:30:28,011 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:30:28,015 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:30:28,015 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:28,015 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:28,015 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpp69xwyy6
2021-01-13 15:30:28,016 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:28,016 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 21857 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpp69xwyy6
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m____________________________ test_daterange_append _____________________________[0m

library = <VersionStore at 0x7f84e45034a8>
    <ArcticLibrary at 0x7f84e4503fd0, arctic_test.TEST>
        <Arctic at 0x7f84e75af5f8, connected to MongoClient(host=['127.67.249.105:26833'], document_class=dict, tz_aware=False, connect=True)>

    def test_daterange_append(library):
        df = DataFrame(index=date_range(dt(2001, 1, 1), freq='S', periods=30 * 1024),
                       data=np.tile(np.arange(30 * 1024), 100).reshape((-1, 100)))
        df.columns = [str(c) for c in df.columns]
        df.index.name = 'idx'
        library.write('MYARR', df)
        # assert saved
        saved_arr = library.read('MYARR').data
>       assert_frame_equal(df, saved_arr, check_names=False)
[1m[31mE       AssertionError: (<Second>, None)[0m

[1m[31mtests/integration/store/test_pandas_store.py[0m:888: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:30:28.045+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:30:28.047+0000 I CONTROL  [initandlisten] MongoDB starting : pid=21892 port=26833 dbpath=/tmp/tmpjp9cp4xz 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:30:28.047+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:30:28.047+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:30:28.047+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:30:28.047+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:30:28.047+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:30:28.047+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:30:28.047+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:30:28.047+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:30:28.047+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:30:28.047+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 26833, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpjp9cp4xz", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:30:28.048+0000 I STORAGE  [initandlisten] 
2021-01-13T15:30:28.048+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:30:28.048+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:30:28.048+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:30:28.543+0000 I STORAGE  [initandlisten] WiredTiger message [1610551828:543631][21892:0x7f579dd37a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:30:28.555+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:30:28.580+0000 I CONTROL  [initandlisten] 
2021-01-13T15:30:28.580+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:30:28.580+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:30:28.580+0000 I CONTROL  [initandlisten] 
2021-01-13T15:30:28.580+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: e9fbf707-7a86-428b-a081-9ac56f03e05c
2021-01-13T15:30:28.598+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:30:28.599+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:30:28.599+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:30:28.599+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:30:28.599+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: f30407e4-4534-416e-8a06-2f11a7daf02e
2021-01-13T15:30:28.617+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:30:28.617+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpjp9cp4xz/diagnostic.data'
2021-01-13T15:30:28.618+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:30:28.619+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: ab4cd5f5-3444-49f6-951f-168fc93d4f03
2021-01-13T15:30:28.619+0000 I NETWORK  [initandlisten] waiting for connections on port 26833
2021-01-13T15:30:28.641+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:45840 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:28.642+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:45842 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:28.647+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:30:28.647+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:30:28.647+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:30:28.647+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-8773598144543714302
2021-01-13T15:30:28.647+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:28.647+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:30:28.648+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:45844 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:28.648+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:45846 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:30:28.652+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:30:28.652+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 6f290af6-de68-4969-8fb9-69036fed42f9
2021-01-13T15:30:28.682+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:30:28.682+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:30:28.682+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:30:28.682+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-8773598144543714302
2021-01-13T15:30:28.682+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:28.684+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:30:28.685+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 35c066fa-56d4-4c42-a4bd-a2c254fa7f75
2021-01-13T15:30:28.705+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: edc380a3-e397-4cd7-ad58-d09a1ccb5031
2021-01-13T15:30:28.723+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:30:28.733+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:30:28.733+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:28.734+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 60be929a-9945-4036-a41f-680ac94c4bcc
2021-01-13T15:30:28.759+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:30:28.759+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:28.760+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:30:28.769+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:30:28.770+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:28.771+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 27245f85-1abc-4ef8-8888-e6c9a4eaf760
2021-01-13T15:30:28.789+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:30:28.800+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:30:28.800+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:28.801+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: a85364f7-70ad-4e64-9099-5e479a0c6f4a
2021-01-13T15:30:28.830+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:28.830+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:28.831+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:30:28.841+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:28.841+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:28.851+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:28.851+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:30:28.862+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:30:28.862+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:30:28,019 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:28,019 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:28,019 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpjp9cp4xz
2021-01-13 15:30:28,019 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:30:28,019 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:28,019 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:28,020 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:30:28,030 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=26833 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpjp9cp4xz
2021-01-13 15:30:28,030 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:30:28,031 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:30:28,031 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:26833
2021-01-13 15:30:28,637 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:30:28,638 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:26833
2021-01-13 15:30:28,646 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615181 for server to start successfully
2021-01-13 15:30:28,647 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:30:28,647 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:30:28,869 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:30:28,871 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpjp9cp4xz
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=26833 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpjp9cp4xz
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:26833
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:26833
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615181 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:30:28.887+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:30:28.888+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:30:29.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:30:28,898 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:30:29,029 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:29,030 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:29,030 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:29,030 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:29,030 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:30:29,266 DEBUG arctic.store.version_store Finished writing versions for MYARR
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:82 Server is already killed, skipping
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:82 Server is already killed, skipping
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:82 Server is already killed, skipping
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:82 Server is already killed, skipping
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:82 Server is already killed, skipping
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for MYARR
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:30:29,465 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 21892 (total_procs_to_kill=1)
2021-01-13 15:30:29,466 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:30:29,466 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:30:29,473 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:30:29,474 DEBUG pytest_shutil.workspace 
2021-01-13 15:30:29,474 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:29,474 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpjp9cp4xz
2021-01-13 15:30:29,474 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:30:29,474 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 21892 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpjp9cp4xz
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_________________ test_write_metadata[FwPointersCfg.DISABLED] __________________[0m

library = <VersionStore at 0x7f84e4153828>
    <ArcticLibrary at 0x7f84e41539b0, arctic_test.TEST>
        <Arctic at 0x7f84e4144e80, connected to MongoClient(host=['127.67.249.105:21886'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b = _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 3 (only metadata)
    
                v_doc_2 = library._versions.find_one({'symbol': symbol, 'version': 2})
                v_doc_3 = library._versions.find_one({'symbol': symbol, 'version': 3})
                assert get_fwptr_config(v_doc_2) is fw_pointers_cfg
                assert v_doc_2.get(FW_POINTERS_REFS_KEY) == v_doc_3.get(FW_POINTERS_REFS_KEY)
    
                v = library.read(symbol)
>               assert_frame_equal(v.data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1161: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:01.522+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:01.524+0000 I CONTROL  [initandlisten] MongoDB starting : pid=26732 port=21886 dbpath=/tmp/tmph8k7nffy 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:01.524+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:01.524+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:01.524+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:01.524+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:01.525+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:01.525+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:01.525+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:01.525+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:01.525+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:01.525+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 21886, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmph8k7nffy", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:01.525+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:01.525+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:01.525+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:01.525+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:02.024+0000 I STORAGE  [initandlisten] WiredTiger message [1610551982:24954][26732:0x7fca5c74ea80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:02.038+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:02.064+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:02.064+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:02.064+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:02.064+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:02.064+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 5d9333ed-3beb-43a6-ad2f-190216b9db0f
2021-01-13T15:33:02.084+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:02.084+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:02.084+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:02.084+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:02.084+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 099595a9-b748-4d07-bc67-adde500badbc
2021-01-13T15:33:02.103+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:02.103+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmph8k7nffy/diagnostic.data'
2021-01-13T15:33:02.104+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:02.105+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 2959a628-9f65-4785-aec1-7a58ab41faf2
2021-01-13T15:33:02.105+0000 I NETWORK  [initandlisten] waiting for connections on port 21886
2021-01-13T15:33:02.118+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:53724 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:02.119+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:53726 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:02.122+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:53728 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:02.125+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:53730 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:02.140+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:02.140+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:02.140+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:02.140+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--2161694682149020609
2021-01-13T15:33:02.140+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:02.140+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:02.144+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:02.144+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 413b9394-80e6-446a-b592-4e03dde7eab6
2021-01-13T15:33:02.173+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:02.173+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:02.173+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:02.173+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--2161694682149020609
2021-01-13T15:33:02.173+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:02.176+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:02.176+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 26f40dc8-bd84-467f-9dc2-f86949be75d0
2021-01-13T15:33:02.195+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: d20abdde-4f5c-4baf-9187-a83a71e7aeb5
2021-01-13T15:33:02.213+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:02.224+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:02.224+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:02.225+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 98b6aa05-6c95-40f8-9bf8-7aeb4ed48723
2021-01-13T15:33:02.258+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:02.258+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:02.259+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:02.270+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:02.270+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:02.271+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 09227b0c-0ee2-46d7-9919-005ebfc57035
2021-01-13T15:33:02.292+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:02.302+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:02.302+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:02.303+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: b130cfb9-d505-48bf-8415-ca9c73720e7b
2021-01-13T15:33:02.331+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:02.331+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:02.333+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:02.343+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:02.343+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:02.355+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:02.355+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:02.366+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:02.366+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:01,495 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:01,495 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:01,495 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmph8k7nffy
2021-01-13 15:33:01,495 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:01,496 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:01,496 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:01,496 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:01,507 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=21886 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmph8k7nffy
2021-01-13 15:33:01,507 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:01,508 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:01,508 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:21886
2021-01-13 15:33:02,114 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:02,115 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:21886
2021-01-13 15:33:02,123 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615035 for server to start successfully
2021-01-13 15:33:02,123 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:02,124 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:02,373 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:02,375 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmph8k7nffy
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=21886 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmph8k7nffy
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:21886
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:21886
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615035 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:02.385+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:02.386+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:02,404 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:02,412 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:02,417 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:02,522 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 26732 (total_procs_to_kill=1)
2021-01-13 15:33:02,523 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:02,526 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:02,527 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:02,527 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:02,527 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:02,527 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmph8k7nffy
2021-01-13 15:33:02,527 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:02,527 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 26732 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmph8k7nffy
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m__________________ test_write_metadata[FwPointersCfg.HYBRID] ___________________[0m

library = <VersionStore at 0x7f84e410fb70>
    <ArcticLibrary at 0x7f84e410ff28, arctic_test.TEST>
        <Arctic at 0x7f84e4153ac8, connected to MongoClient(host=['127.67.249.105:16325'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b = _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 3 (only metadata)
    
                v_doc_2 = library._versions.find_one({'symbol': symbol, 'version': 2})
                v_doc_3 = library._versions.find_one({'symbol': symbol, 'version': 3})
                assert get_fwptr_config(v_doc_2) is fw_pointers_cfg
                assert v_doc_2.get(FW_POINTERS_REFS_KEY) == v_doc_3.get(FW_POINTERS_REFS_KEY)
    
                v = library.read(symbol)
>               assert_frame_equal(v.data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1161: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:02.558+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:02.561+0000 I CONTROL  [initandlisten] MongoDB starting : pid=26767 port=16325 dbpath=/tmp/tmpkujb6gdg 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:02.561+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:02.561+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:02.561+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:02.561+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:02.561+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:02.561+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:02.561+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:02.561+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:02.561+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:02.561+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 16325, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpkujb6gdg", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:02.561+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:02.561+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:02.561+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:02.561+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:03.057+0000 I STORAGE  [initandlisten] WiredTiger message [1610551983:57862][26767:0x7f8c94f0ea80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:03.069+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:03.095+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:03.095+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:03.095+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:03.095+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:03.095+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: e752a27b-f038-4153-be0c-3f6f69584b05
2021-01-13T15:33:03.114+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:03.114+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:03.114+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:03.114+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:03.114+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 3937c8dc-dbe7-49c8-818b-36314c0d4c0e
2021-01-13T15:33:03.135+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:03.135+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpkujb6gdg/diagnostic.data'
2021-01-13T15:33:03.136+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:03.137+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 1a5c2ea6-15c8-4d80-9ab6-db697ad403ba
2021-01-13T15:33:03.137+0000 I NETWORK  [initandlisten] waiting for connections on port 16325
2021-01-13T15:33:03.154+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:43526 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:03.155+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:43528 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:03.160+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:43530 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:03.162+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:43532 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:03.165+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:03.165+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:03.165+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:03.165+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--1152109450547091508
2021-01-13T15:33:03.165+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:03.165+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:03.168+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:03.168+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: ef847c11-3bf5-47bb-852c-3fddbdd8008b
2021-01-13T15:33:03.196+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:03.196+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:03.196+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:03.196+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--1152109450547091508
2021-01-13T15:33:03.196+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:03.198+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:03.198+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 4122a30c-ba4b-4d38-817c-e1a57b8a2489
2021-01-13T15:33:03.218+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 667b6ab9-6df2-4b36-8f7f-bbaf3a01e0a1
2021-01-13T15:33:03.237+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:03.247+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:03.247+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:03.248+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: c66ecdf1-865e-413c-8281-2286857c0f3f
2021-01-13T15:33:03.277+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:03.278+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:03.279+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:03.288+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:03.288+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:03.289+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 70ec2d21-7170-47ee-99d4-f012522fb0ce
2021-01-13T15:33:03.312+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:03.322+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:03.322+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:03.323+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 36ba859d-9d6e-4583-b3bb-33cfe27af51f
2021-01-13T15:33:03.356+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:03.356+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:03.357+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:03.368+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:03.368+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:03.379+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:03.379+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:03.390+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:03.390+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:02,531 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:02,531 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:02,531 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpkujb6gdg
2021-01-13 15:33:02,531 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:02,531 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:02,531 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:02,532 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:02,543 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=16325 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpkujb6gdg
2021-01-13 15:33:02,543 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:02,544 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:02,544 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:16325
2021-01-13 15:33:03,151 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:03,151 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:16325
2021-01-13 15:33:03,160 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615782 for server to start successfully
2021-01-13 15:33:03,160 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:03,161 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:03,398 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:03,400 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpkujb6gdg
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=16325 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpkujb6gdg
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:16325
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:16325
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615782 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:03.410+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:03.410+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:03,427 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:03,436 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:03,441 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:03,694 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 26767 (total_procs_to_kill=1)
2021-01-13 15:33:03,694 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:03,696 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:03,700 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:03,700 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:03,700 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:03,700 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpkujb6gdg
2021-01-13 15:33:03,700 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:03,700 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 26767 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpkujb6gdg
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m__________________ test_write_metadata[FwPointersCfg.ENABLED] __________________[0m

library = <VersionStore at 0x7f84e4108cc0>
    <ArcticLibrary at 0x7f84e4108518, arctic_test.TEST>
        <Arctic at 0x7f84e415ef98, connected to MongoClient(host=['127.67.249.105:28052'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b = _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 3 (only metadata)
    
                v_doc_2 = library._versions.find_one({'symbol': symbol, 'version': 2})
                v_doc_3 = library._versions.find_one({'symbol': symbol, 'version': 3})
                assert get_fwptr_config(v_doc_2) is fw_pointers_cfg
                assert v_doc_2.get(FW_POINTERS_REFS_KEY) == v_doc_3.get(FW_POINTERS_REFS_KEY)
    
                v = library.read(symbol)
>               assert_frame_equal(v.data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1161: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:03.730+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:03.732+0000 I CONTROL  [initandlisten] MongoDB starting : pid=26802 port=28052 dbpath=/tmp/tmprbmk4ifl 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:03.732+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:03.732+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:03.732+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:03.732+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:03.732+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:03.732+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:03.732+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:03.732+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:03.732+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:03.732+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 28052, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmprbmk4ifl", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:03.732+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:03.732+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:03.732+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:03.733+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:04.230+0000 I STORAGE  [initandlisten] WiredTiger message [1610551984:230133][26802:0x7f7a26311a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:04.242+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:04.268+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:04.268+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:04.268+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:04.268+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:04.268+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: d67eef96-5cf4-4b1d-842d-7b647f823ea7
2021-01-13T15:33:04.287+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:04.287+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:04.287+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:04.287+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:04.287+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: d13c1d7b-570d-45bc-9fa7-c0036b806b61
2021-01-13T15:33:04.307+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:04.307+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmprbmk4ifl/diagnostic.data'
2021-01-13T15:33:04.309+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:04.309+0000 I NETWORK  [initandlisten] waiting for connections on port 28052
2021-01-13T15:33:04.309+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: e7044876-cc42-4757-a5ca-1f269bc07597
2021-01-13T15:33:04.309+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:33:04.326+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:51112 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:04.327+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:51114 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:04.330+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:51116 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:04.333+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:51118 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:04.341+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:04.341+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:04.341+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:04.341+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--2695513663459921510
2021-01-13T15:33:04.341+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:04.345+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:04.345+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 1d40b574-86de-465a-82b4-8a5e4ad8e81d
2021-01-13T15:33:04.375+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:04.375+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:04.375+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:04.375+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--2695513663459921510
2021-01-13T15:33:04.375+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:04.377+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:04.377+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: f708f479-4ce1-4ede-96c5-379bcae54726
2021-01-13T15:33:04.398+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 1042a8b1-1b38-4c34-9e03-881704e4a2a6
2021-01-13T15:33:04.418+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:04.428+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:04.428+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:04.430+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 60683049-b779-4cbc-af35-a3a766eed748
2021-01-13T15:33:04.457+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:04.457+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:04.458+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:04.470+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:04.470+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:04.471+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 362218fa-3775-4d24-8eb2-d916ff77068c
2021-01-13T15:33:04.493+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:04.507+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:04.507+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:04.508+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: f79cb59c-428c-4e90-a8ee-16b46ac4379d
2021-01-13T15:33:04.540+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:04.540+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:04.541+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:04.552+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:04.552+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:04.562+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:04.563+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:04.574+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:04.574+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:03,703 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:03,703 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:03,704 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmprbmk4ifl
2021-01-13 15:33:03,704 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:03,704 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:03,704 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:03,704 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:03,715 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=28052 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmprbmk4ifl
2021-01-13 15:33:03,715 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:03,716 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:03,716 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:28052
2021-01-13 15:33:04,322 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:04,322 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:28052
2021-01-13 15:33:04,331 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615144 for server to start successfully
2021-01-13 15:33:04,332 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:04,332 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:04,582 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:04,584 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmprbmk4ifl
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=28052 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmprbmk4ifl
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:28052
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:28052
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615144 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:04.594+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:04.595+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:04,613 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:04,621 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:04,627 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:04,731 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 26802 (total_procs_to_kill=1)
2021-01-13 15:33:04,731 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:04,732 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:04,736 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:04,736 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:04,736 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:04,736 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmprbmk4ifl
2021-01-13 15:33:04,736 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:04,736 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 26802 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmprbmk4ifl
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m________ test_write_metadata_followed_by_append[FwPointersCfg.DISABLED] ________[0m

library = <VersionStore at 0x7f84e41085c0>
    <ArcticLibrary at 0x7f84e42bc0f0, arctic_test.TEST>
        <Arctic at 0x7f84e73be588, connected to MongoClient(host=['127.67.249.105:14004'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_followed_by_append(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b = _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2 (only metadata)
                library.append(symbol, data=mydf_b, metadata={'field_c': 1})  # creates version 3
    
                # Trigger GC now
                time.sleep(2)
                library._prune_previous_versions(symbol, 0)
    
                v = library.read(symbol)
                assert_frame_equal(v.data, mydf_a.append(mydf_b))
                assert v.metadata == {'field_c': 1}
                assert library._read_metadata(symbol).get('version') == 3
>               assert_frame_equal(library.read(symbol, as_of=1).data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1185: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:04.767+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:04.769+0000 I CONTROL  [initandlisten] MongoDB starting : pid=26837 port=14004 dbpath=/tmp/tmp67q93k2m 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:04.769+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:04.769+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:04.769+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:04.769+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:04.769+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:04.769+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:04.769+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:04.769+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:04.769+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:04.769+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 14004, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp67q93k2m", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:04.769+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:04.769+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:04.769+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:04.769+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:05.269+0000 I STORAGE  [initandlisten] WiredTiger message [1610551985:269632][26837:0x7ff1c72b7a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:05.282+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:05.309+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:05.309+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:05.309+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:05.309+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:05.310+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: ddb72bb0-d9b1-4ac5-b39a-e8cc41de38a1
2021-01-13T15:33:05.329+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:05.329+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:05.329+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:05.329+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:05.330+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 5d0a2026-a989-4aa1-9a25-d3f53a4dae36
2021-01-13T15:33:05.348+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:05.348+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp67q93k2m/diagnostic.data'
2021-01-13T15:33:05.350+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:05.350+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 088643c0-fb2b-47db-8fdb-277689d44b49
2021-01-13T15:33:05.350+0000 I NETWORK  [initandlisten] waiting for connections on port 14004
2021-01-13T15:33:05.363+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:51308 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:05.364+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:51310 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:05.368+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:51312 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:05.371+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:51314 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:05.375+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:05.375+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:05.375+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:05.375+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--8023638719096640086
2021-01-13T15:33:05.376+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:05.376+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:05.379+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:05.379+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: a251d7bc-f742-4b22-abee-0d107e3dcf33
2021-01-13T15:33:05.414+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:05.414+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:05.414+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:05.414+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--8023638719096640086
2021-01-13T15:33:05.414+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:05.417+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:05.417+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: f2ba1042-1ddf-4c78-97ac-a67eb54c68be
2021-01-13T15:33:05.437+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 43b2b97d-6e37-4436-873a-55c61ee6c115
2021-01-13T15:33:05.454+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:05.464+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:05.464+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:05.465+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 7b125d69-974c-4bcf-b3f6-840556756343
2021-01-13T15:33:05.496+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:05.496+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:05.498+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:05.508+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:05.508+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:05.509+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: dc260bb3-783f-41de-b662-094573d40925
2021-01-13T15:33:05.530+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:05.540+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:05.540+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:05.541+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 4b2fb35f-1ca2-449e-a9a4-947c156ccc89
2021-01-13T15:33:05.570+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:05.570+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:05.571+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:05.582+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:05.582+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:05.592+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:05.592+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:05.603+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:05.604+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:04,740 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:04,740 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:04,740 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp67q93k2m
2021-01-13 15:33:04,740 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:04,740 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:04,740 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:04,740 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:04,751 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=14004 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp67q93k2m
2021-01-13 15:33:04,752 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:04,752 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:04,753 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:14004
2021-01-13 15:33:05,359 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:05,359 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:14004
2021-01-13 15:33:05,369 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616548 for server to start successfully
2021-01-13 15:33:05,369 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:05,371 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:05,611 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:05,613 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp67q93k2m
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=14004 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp67q93k2m
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:14004
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:14004
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616548 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:05.623+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:05.624+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:33:06.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:05,642 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:05,647 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:33:05,651 DEBUG arctic.store._ndarray_store Appended segment 19 for parent 5fff12b11d1e61918c8adaab
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store._ndarray_store:_ndarray_store.py:509 Appended segment 19 for parent 5fff12b11d1e61918c8adaab
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:07,779 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 26837 (total_procs_to_kill=1)
2021-01-13 15:33:07,779 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:07,780 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:07,784 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:07,784 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:07,784 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:07,784 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp67q93k2m
2021-01-13 15:33:07,784 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:07,785 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 26837 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp67q93k2m
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_________ test_write_metadata_followed_by_append[FwPointersCfg.HYBRID] _________[0m

library = <VersionStore at 0x7f84e410f668>
    <ArcticLibrary at 0x7f84e410f518, arctic_test.TEST>
        <Arctic at 0x7f84e44e1748, connected to MongoClient(host=['127.67.249.105:15111'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_followed_by_append(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b = _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2 (only metadata)
                library.append(symbol, data=mydf_b, metadata={'field_c': 1})  # creates version 3
    
                # Trigger GC now
                time.sleep(2)
                library._prune_previous_versions(symbol, 0)
    
                v = library.read(symbol)
                assert_frame_equal(v.data, mydf_a.append(mydf_b))
                assert v.metadata == {'field_c': 1}
                assert library._read_metadata(symbol).get('version') == 3
>               assert_frame_equal(library.read(symbol, as_of=1).data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1185: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:07.815+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:07.818+0000 I CONTROL  [initandlisten] MongoDB starting : pid=26872 port=15111 dbpath=/tmp/tmp6pxa9nbm 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:07.818+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:07.818+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:07.818+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:07.818+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:07.818+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:07.818+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:07.818+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:07.818+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:07.818+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:07.818+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 15111, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp6pxa9nbm", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:07.818+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:07.818+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:07.818+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:07.818+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:08.316+0000 I STORAGE  [initandlisten] WiredTiger message [1610551988:316849][26872:0x7f9a9f27da80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:08.329+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:08.355+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:08.355+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:08.355+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:08.355+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:08.355+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: d3cb7ca1-223f-4b66-b9ce-8c296ccd046f
2021-01-13T15:33:08.375+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:08.375+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:08.375+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:08.375+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:08.375+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 69f3d2e3-2b45-47af-b936-89b4e859df66
2021-01-13T15:33:08.393+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:08.393+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp6pxa9nbm/diagnostic.data'
2021-01-13T15:33:08.394+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:08.394+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 8710fd8b-70be-4eb2-97e0-580546b8093e
2021-01-13T15:33:08.395+0000 I NETWORK  [initandlisten] waiting for connections on port 15111
2021-01-13T15:33:08.413+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:52644 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:08.414+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:52646 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:08.418+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:52648 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:08.420+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:52650 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:08.422+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:08.422+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:08.422+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:08.422+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-4508425438331233914
2021-01-13T15:33:08.422+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:08.423+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:08.426+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:08.426+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 29c267ef-61a4-4a98-91fb-80fceaf7ed4e
2021-01-13T15:33:08.456+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:08.456+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:08.456+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:08.456+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-4508425438331233914
2021-01-13T15:33:08.456+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:08.459+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:08.459+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 502b011c-b6d8-45ec-b57d-22680a151c3b
2021-01-13T15:33:08.482+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 96761a18-9fc4-4254-97da-977f9d4f78ef
2021-01-13T15:33:08.501+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:08.512+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:08.512+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:08.513+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 48b1f7cd-4040-4f9e-972e-29850dace1a6
2021-01-13T15:33:08.547+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:08.548+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:08.549+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:08.559+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:08.559+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:08.561+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: a65d41a9-d1b4-4d26-9565-b7fe5b1a2d1e
2021-01-13T15:33:08.582+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:08.593+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:08.593+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:08.594+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 24996fd2-7a5f-453b-be18-9c158b536b94
2021-01-13T15:33:08.627+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:08.627+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:08.628+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:08.640+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:08.640+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:08.652+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:08.652+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:08.665+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:08.666+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:07,788 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:07,788 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:07,788 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp6pxa9nbm
2021-01-13 15:33:07,788 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:07,789 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:07,789 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:07,789 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:07,800 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=15111 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp6pxa9nbm
2021-01-13 15:33:07,800 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:07,801 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:07,801 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:15111
2021-01-13 15:33:08,408 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:08,408 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:15111
2021-01-13 15:33:08,418 DEBUG pytest_server_fixtures.base2 waited 0:00:00.617148 for server to start successfully
2021-01-13 15:33:08,418 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:08,419 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:08,673 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:08,675 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp6pxa9nbm
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=15111 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp6pxa9nbm
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:15111
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:15111
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.617148 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:08.685+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:08.685+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:33:09.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:08,703 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:08,708 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:33:08,713 DEBUG arctic.store._ndarray_store Appended segment 19 for parent 5fff12b41d1e61918c8adab1
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store._ndarray_store:_ndarray_store.py:509 Appended segment 19 for parent 5fff12b41d1e61918c8adab1
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:10,836 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 26872 (total_procs_to_kill=1)
2021-01-13 15:33:10,836 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:10,837 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:10,841 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:10,841 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:10,841 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:10,841 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp6pxa9nbm
2021-01-13 15:33:10,841 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:10,841 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 26872 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp6pxa9nbm
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m________ test_write_metadata_followed_by_append[FwPointersCfg.ENABLED] _________[0m

library = <VersionStore at 0x7f84e4114ba8>
    <ArcticLibrary at 0x7f84e4114518, arctic_test.TEST>
        <Arctic at 0x7f84e4114f60, connected to MongoClient(host=['127.67.249.105:11002'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_followed_by_append(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b = _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2 (only metadata)
                library.append(symbol, data=mydf_b, metadata={'field_c': 1})  # creates version 3
    
                # Trigger GC now
                time.sleep(2)
                library._prune_previous_versions(symbol, 0)
    
                v = library.read(symbol)
                assert_frame_equal(v.data, mydf_a.append(mydf_b))
                assert v.metadata == {'field_c': 1}
                assert library._read_metadata(symbol).get('version') == 3
>               assert_frame_equal(library.read(symbol, as_of=1).data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1185: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:10.873+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:10.875+0000 I CONTROL  [initandlisten] MongoDB starting : pid=26912 port=11002 dbpath=/tmp/tmpv3c0m864 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:10.875+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:10.875+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:10.875+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:10.875+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:10.875+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:10.875+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:10.875+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:10.875+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:10.875+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:10.875+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 11002, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpv3c0m864", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:10.875+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:10.875+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:10.875+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:10.875+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:11.375+0000 I STORAGE  [initandlisten] WiredTiger message [1610551991:375546][26912:0x7f2b35ce2a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:11.388+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:11.418+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:11.418+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:11.418+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:11.418+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:11.418+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: daf23f23-b0b8-4475-844c-7320abe8a702
2021-01-13T15:33:11.440+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:11.440+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:11.440+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:11.440+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:11.440+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: dd8e266a-baa9-4bca-94aa-781c835b0b36
2021-01-13T15:33:11.458+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:11.458+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpv3c0m864/diagnostic.data'
2021-01-13T15:33:11.460+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:11.460+0000 I NETWORK  [initandlisten] waiting for connections on port 11002
2021-01-13T15:33:11.460+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:33:11.460+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: a4d76ade-0aa5-4c90-8e2e-7fc0548c94ba
2021-01-13T15:33:11.469+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:52322 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:11.470+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:52324 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:11.474+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:52326 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:11.476+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:52328 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:11.488+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:11.488+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:11.489+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:11.492+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:11.492+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: af3761cc-20fd-4e41-ab66-882f4ffccc85
2021-01-13T15:33:11.524+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:11.524+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:11.524+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:11.524+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--1965196408346013333
2021-01-13T15:33:11.524+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:11.526+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:11.526+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 319440e7-3b32-4d4e-8805-ff0245fd30cd
2021-01-13T15:33:11.554+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 3d022b26-7f5b-446a-9d2b-a43cbf104b36
2021-01-13T15:33:11.575+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:11.587+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:11.587+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:11.588+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 4c933fcf-6ce7-4810-9836-bfcb71792b25
2021-01-13T15:33:11.623+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:11.623+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:11.624+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:11.636+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:11.637+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:11.638+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: e1017d20-0abd-4257-bb7c-5cd487547395
2021-01-13T15:33:11.659+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:11.669+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:11.669+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:11.670+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 461038dc-5b01-4c47-9930-06f487d48b92
2021-01-13T15:33:11.703+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:11.703+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:11.704+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:11.716+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:11.716+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:11.728+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:11.728+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:11.739+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:11.739+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:10,845 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:10,845 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:10,845 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpv3c0m864
2021-01-13 15:33:10,845 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:10,845 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:10,845 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:10,846 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:10,857 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=11002 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpv3c0m864
2021-01-13 15:33:10,857 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:10,858 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:10,858 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:11002
2021-01-13 15:33:11,465 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:11,465 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:11002
2021-01-13 15:33:11,474 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615850 for server to start successfully
2021-01-13 15:33:11,474 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:11,475 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:11,746 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:11,749 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpv3c0m864
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=11002 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpv3c0m864
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:11002
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:11002
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615850 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:11.759+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:11.759+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:33:12.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:11,777 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:11,783 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:33:11,787 DEBUG arctic.store._ndarray_store Appended segment 19 for parent 5fff12b71d1e61918c8adab7
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store._ndarray_store:_ndarray_store.py:509 Appended segment 19 for parent 5fff12b71d1e61918c8adab7
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:14,060 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 26912 (total_procs_to_kill=1)
2021-01-13 15:33:14,060 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:14,061 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:14,065 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:14,065 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:14,065 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:14,065 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpv3c0m864
2021-01-13 15:33:14,066 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:14,066 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 26912 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpv3c0m864
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_____ test_write_metadata_purge_previous_versions[FwPointersCfg.DISABLED] ______[0m

library = <VersionStore at 0x7f84e4113f28>
    <ArcticLibrary at 0x7f84c47cbf60, arctic_test.TEST>
        <Arctic at 0x7f84e4113b38, connected to MongoClient(host=['127.67.249.105:21989'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_purge_previous_versions(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b, mydf_c = _rnd_df(10, 5), _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                with FwPointersCtx(fw_pointers_cfg):
                    library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                    library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
                    assert library._read_metadata(symbol).get('version') == 2
                    library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 3 (only metadata)
    
                    # Trigger GC now
                    library._prune_previous_versions(symbol, 0)
                    time.sleep(2)
    
                    # Assert the data
                    v = library.read(symbol)
>                   assert_frame_equal(v.data, mydf_b)
[1m[31mE                   AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1233: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:19.698+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:19.700+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27157 port=21989 dbpath=/tmp/tmpeoc_o5m7 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:19.700+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:19.700+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:19.700+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:19.700+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:19.700+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:19.700+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:19.700+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:19.700+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:19.700+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:19.700+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 21989, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpeoc_o5m7", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:19.700+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:19.700+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:19.700+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:19.700+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:20.202+0000 I STORAGE  [initandlisten] WiredTiger message [1610552000:202009][27157:0x7f8528bb6a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:20.214+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:20.240+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:20.240+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:20.240+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:20.240+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:20.240+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: e891972d-59b3-4aa4-a730-fddb47f38703
2021-01-13T15:33:20.260+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:20.260+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:20.260+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:20.260+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:20.260+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 88d120f7-5fac-40b2-8815-119752ae5c29
2021-01-13T15:33:20.283+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:20.283+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpeoc_o5m7/diagnostic.data'
2021-01-13T15:33:20.285+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:20.285+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 6a5218f0-d8b6-49f5-ba42-1665b068dea9
2021-01-13T15:33:20.285+0000 I NETWORK  [initandlisten] waiting for connections on port 21989
2021-01-13T15:33:20.294+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:41066 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:20.295+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:41068 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:20.299+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:41070 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:20.302+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:41072 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:20.313+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:20.313+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:20.314+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:20.315+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:20.319+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:20.319+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: d5bdb46a-3156-49ab-b6bf-5e6aa19b7797
2021-01-13T15:33:20.348+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:20.348+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:20.348+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:20.348+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--2234175570079598196
2021-01-13T15:33:20.348+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:20.350+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:20.351+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 05acc5c3-42de-4839-bd55-6df546c162e0
2021-01-13T15:33:20.369+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 5cc6ae2e-1db9-450e-b7c9-dcfe77b4c221
2021-01-13T15:33:20.390+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:20.400+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:20.400+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:20.402+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 4846e189-aa56-41c4-82df-5cc789ef32f0
2021-01-13T15:33:20.433+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:20.433+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:20.435+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:20.446+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:20.446+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:20.447+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: c825618b-cf02-442b-9707-a1be2f9a9c75
2021-01-13T15:33:20.468+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:20.479+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:20.479+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:20.480+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: b50de8e2-139a-4e4e-abdc-511ecad7ed4c
2021-01-13T15:33:20.509+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:20.509+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:20.511+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:20.522+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:20.522+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:20.535+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:20.535+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:20.548+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:20.548+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:19,670 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:19,670 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:19,670 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpeoc_o5m7
2021-01-13 15:33:19,670 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:19,670 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:19,670 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:19,671 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:19,682 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=21989 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpeoc_o5m7
2021-01-13 15:33:19,683 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:19,683 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:19,684 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:21989
2021-01-13 15:33:20,290 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:20,291 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:21989
2021-01-13 15:33:20,299 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616063 for server to start successfully
2021-01-13 15:33:20,300 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:20,301 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:20,556 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:20,558 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpeoc_o5m7
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=21989 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpeoc_o5m7
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:21989
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:21989
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616063 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:20.569+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:20.570+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:33:21.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:20,588 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:20,596 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:20,602 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:22,716 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27157 (total_procs_to_kill=1)
2021-01-13 15:33:22,716 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:22,717 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:22,721 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:22,721 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:22,721 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:22,721 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpeoc_o5m7
2021-01-13 15:33:22,721 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:22,721 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27157 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpeoc_o5m7
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m______ test_write_metadata_purge_previous_versions[FwPointersCfg.HYBRID] _______[0m

library = <VersionStore at 0x7f84e4115400>
    <ArcticLibrary at 0x7f84e4115710, arctic_test.TEST>
        <Arctic at 0x7f84c47cb1d0, connected to MongoClient(host=['127.67.249.105:3751'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_purge_previous_versions(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b, mydf_c = _rnd_df(10, 5), _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                with FwPointersCtx(fw_pointers_cfg):
                    library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                    library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
                    assert library._read_metadata(symbol).get('version') == 2
                    library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 3 (only metadata)
    
                    # Trigger GC now
                    library._prune_previous_versions(symbol, 0)
                    time.sleep(2)
    
                    # Assert the data
                    v = library.read(symbol)
>                   assert_frame_equal(v.data, mydf_b)
[1m[31mE                   AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1233: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:22.752+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:22.755+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27192 port=3751 dbpath=/tmp/tmphfn978uy 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:22.755+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:22.755+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:22.755+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:22.755+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:22.755+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:22.755+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:22.755+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:22.755+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:22.755+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:22.755+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 3751, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmphfn978uy", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:22.755+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:22.755+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:22.755+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:22.755+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:23.253+0000 I STORAGE  [initandlisten] WiredTiger message [1610552003:253562][27192:0x7fb805595a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:23.267+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:23.293+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:23.293+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:23.293+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:23.293+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:23.294+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 2721e266-9f92-4623-ad6d-4d402d9383bb
2021-01-13T15:33:23.313+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:23.313+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:23.313+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:23.313+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:23.313+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 99b6ea63-d158-410a-bc76-39b1f07e6eaa
2021-01-13T15:33:23.332+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:23.332+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmphfn978uy/diagnostic.data'
2021-01-13T15:33:23.333+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:23.334+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 26572a47-5739-40c8-b59f-ca40fec932d9
2021-01-13T15:33:23.334+0000 I NETWORK  [initandlisten] waiting for connections on port 3751
2021-01-13T15:33:23.349+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:56216 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:23.350+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:56218 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:23.355+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:56220 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:23.356+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:56222 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:23.363+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:23.363+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:23.363+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:23.363+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--3710795210668403847
2021-01-13T15:33:23.363+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:23.363+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:23.366+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:23.366+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 497f0521-a7ad-4832-963f-083f95dc2f54
2021-01-13T15:33:23.394+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:23.394+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:23.394+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:23.394+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--3710795210668403847
2021-01-13T15:33:23.394+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:23.396+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:23.396+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 463717bc-83c1-4fd5-9fc1-59a331d0cbfe
2021-01-13T15:33:23.416+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 31d851c0-00f2-455a-b076-84c765dcb9b6
2021-01-13T15:33:23.432+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:23.443+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:23.443+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:23.444+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: eb93ae6a-37e5-4fe8-9b97-783462d7423c
2021-01-13T15:33:23.475+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:23.476+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:23.477+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:23.486+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:23.486+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:23.487+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 4655060a-91ce-4f04-9bb0-60af8bfc1c43
2021-01-13T15:33:23.508+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:23.519+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:23.519+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:23.520+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 4d60af4d-447e-4212-b9ae-e9e796139544
2021-01-13T15:33:23.551+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:23.551+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:23.552+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:23.563+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:23.563+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:23.573+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:23.573+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:23.585+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:23.585+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:22,725 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:22,725 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:22,725 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmphfn978uy
2021-01-13 15:33:22,725 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:22,725 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:22,726 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:22,726 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:22,737 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=3751 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmphfn978uy
2021-01-13 15:33:22,738 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:22,738 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:22,739 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:3751
2021-01-13 15:33:23,345 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:23,345 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:3751
2021-01-13 15:33:23,354 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615351 for server to start successfully
2021-01-13 15:33:23,354 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:23,354 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:23,592 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:23,594 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmphfn978uy
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=3751 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmphfn978uy
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:3751
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:3751
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615351 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:23.604+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:23.605+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:33:24.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:23,623 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:23,631 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:23,637 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:25,751 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27192 (total_procs_to_kill=1)
2021-01-13 15:33:25,751 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:25,752 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:25,756 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:25,756 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:25,756 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:25,756 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmphfn978uy
2021-01-13 15:33:25,756 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:25,756 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27192 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmphfn978uy
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m______ test_write_metadata_purge_previous_versions[FwPointersCfg.ENABLED] ______[0m

library = <VersionStore at 0x7f84e706fe80>
    <ArcticLibrary at 0x7f84e73e6780, arctic_test.TEST>
        <Arctic at 0x7f84e73b4f98, connected to MongoClient(host=['127.67.249.105:13191'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_purge_previous_versions(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b, mydf_c = _rnd_df(10, 5), _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                with FwPointersCtx(fw_pointers_cfg):
                    library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                    library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
                    assert library._read_metadata(symbol).get('version') == 2
                    library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 3 (only metadata)
    
                    # Trigger GC now
                    library._prune_previous_versions(symbol, 0)
                    time.sleep(2)
    
                    # Assert the data
                    v = library.read(symbol)
>                   assert_frame_equal(v.data, mydf_b)
[1m[31mE                   AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1233: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:25.787+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:25.789+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27227 port=13191 dbpath=/tmp/tmp0vhpts93 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:25.789+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:25.789+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:25.789+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:25.789+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:25.789+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:25.789+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:25.789+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:25.789+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:25.789+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:25.789+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 13191, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp0vhpts93", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:25.789+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:25.789+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:25.789+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:25.789+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:26.288+0000 I STORAGE  [initandlisten] WiredTiger message [1610552006:288888][27227:0x7f42f51b8a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:26.301+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:26.327+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:26.327+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:26.327+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:26.327+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:26.327+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 28f0adda-a5f8-4d75-8a33-4271239d6e8c
2021-01-13T15:33:26.347+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:26.347+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:26.347+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:26.347+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:26.347+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 72489ed9-5ea0-4b74-a6dd-61f10835686e
2021-01-13T15:33:26.368+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:26.368+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp0vhpts93/diagnostic.data'
2021-01-13T15:33:26.369+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:26.369+0000 I NETWORK  [initandlisten] waiting for connections on port 13191
2021-01-13T15:33:26.369+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:33:26.370+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 731e2e04-db0a-4358-9135-e4bb55b81b43
2021-01-13T15:33:26.382+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:59430 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:26.384+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:59432 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:26.388+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:59434 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:26.391+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:59436 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:26.404+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:26.404+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:26.405+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:26.405+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-3714462620984735905
2021-01-13T15:33:26.405+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:26.409+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:26.409+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 677abf6f-0dec-484c-904f-3742793d4b68
2021-01-13T15:33:26.439+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:26.439+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:26.439+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:26.439+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-3714462620984735905
2021-01-13T15:33:26.439+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:26.441+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:26.442+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 051a98be-f611-433b-afb2-4a5bcd09d0db
2021-01-13T15:33:26.464+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 44e4f00e-77ab-4ebc-a6c5-fa6a29e0e69e
2021-01-13T15:33:26.485+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:26.497+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:26.497+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:26.498+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: fbed6893-b468-4797-abac-3ef2108b4b41
2021-01-13T15:33:26.534+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:26.534+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:26.536+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:26.546+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:26.547+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:26.548+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 9de0b989-4efc-4881-94be-221a5198e1a8
2021-01-13T15:33:26.572+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:26.583+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:26.583+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:26.584+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 63dc39f4-13e6-401d-afc5-c954b83839fa
2021-01-13T15:33:26.616+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:26.616+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:26.617+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:26.628+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:26.628+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:26.638+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:26.638+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:26.650+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:26.650+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:25,760 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:25,760 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:25,760 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp0vhpts93
2021-01-13 15:33:25,760 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:25,760 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:25,760 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:25,761 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:25,771 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=13191 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp0vhpts93
2021-01-13 15:33:25,772 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:25,773 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:25,773 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:13191
2021-01-13 15:33:26,378 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:26,379 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:13191
2021-01-13 15:33:26,389 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616048 for server to start successfully
2021-01-13 15:33:26,389 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:26,390 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:26,657 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:26,659 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp0vhpts93
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=13191 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp0vhpts93
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:13191
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:13191
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616048 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:26.670+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:26.671+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:33:27.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:26,688 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:26,696 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:26,701 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:28,814 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27227 (total_procs_to_kill=1)
2021-01-13 15:33:28,814 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:28,814 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:28,822 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:28,822 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:28,822 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:28,822 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp0vhpts93
2021-01-13 15:33:28,822 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:28,822 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27227 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp0vhpts93
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m__________ test_write_metadata_delete_symbol[FwPointersCfg.DISABLED] ___________[0m

library = <VersionStore at 0x7f84e415e860>
    <ArcticLibrary at 0x7f84e415e5f8, arctic_test.TEST>
        <Arctic at 0x7f84e415ee80, connected to MongoClient(host=['127.67.249.105:12799'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_delete_symbol(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2 (only metadata)
    
                library.delete(symbol)
    
                with pytest.raises(NoDataFoundException):
                    library.read(symbol)
    
                library.write(symbol, data=mydf_b, metadata={'field_a': 1})  # creates version 1
>               assert_frame_equal(library.read(symbol).data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1261: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:28.853+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:28.855+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27262 port=12799 dbpath=/tmp/tmpr9o2y7ns 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:28.855+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:28.855+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:28.855+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:28.855+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:28.855+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:28.855+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:28.855+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:28.855+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:28.855+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:28.855+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 12799, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpr9o2y7ns", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:28.855+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:28.855+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:28.855+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:28.855+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:29.352+0000 I STORAGE  [initandlisten] WiredTiger message [1610552009:352086][27262:0x7fef7ac33a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:29.364+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:29.388+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:29.389+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:29.389+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:29.389+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:29.389+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 79259d27-0ce0-43b6-8a5e-5e7d34eaee87
2021-01-13T15:33:29.407+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:29.407+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:29.407+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:29.407+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:29.407+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 0a1b68d3-6839-4d4c-9a59-8cb2d93ee5a4
2021-01-13T15:33:29.425+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:29.425+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpr9o2y7ns/diagnostic.data'
2021-01-13T15:33:29.426+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:29.426+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: d113a7aa-941c-4eda-bebb-990a49191026
2021-01-13T15:33:29.427+0000 I NETWORK  [initandlisten] waiting for connections on port 12799
2021-01-13T15:33:29.449+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:57296 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:29.450+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:57298 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:29.453+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:57300 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:29.454+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:29.454+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:29.455+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:29.455+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:57302 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:29.456+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:29.459+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:29.459+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: a04fce7d-a6da-48a9-9317-1e2f97723295
2021-01-13T15:33:29.490+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:29.490+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:29.491+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:29.493+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:29.493+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 0398c1c1-e3c9-4d2e-8fa0-47b33fb46ee6
2021-01-13T15:33:29.513+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: bdd5bcd4-035b-43ff-863b-bbeda35b9b64
2021-01-13T15:33:29.535+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:29.544+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:29.544+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:29.545+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 186d93ac-5ee1-40ed-a7b3-f193520ba529
2021-01-13T15:33:29.574+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:29.574+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:29.575+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:29.586+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:29.586+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:29.587+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: a07006b3-f1c7-467e-9ca1-02bde98cda0f
2021-01-13T15:33:29.608+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:29.618+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:29.618+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:29.619+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 447eab67-9a9c-416a-a5d9-851f08cf68b2
2021-01-13T15:33:29.646+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:29.647+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:29.648+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:29.660+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:29.660+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:29.675+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:29.675+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:29.688+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:29.688+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:28,826 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:28,826 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:28,826 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpr9o2y7ns
2021-01-13 15:33:28,826 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:28,826 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:28,826 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:28,827 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:28,837 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=12799 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpr9o2y7ns
2021-01-13 15:33:28,838 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:28,839 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:28,839 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:12799
2021-01-13 15:33:29,445 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:29,445 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:12799
2021-01-13 15:33:29,453 DEBUG pytest_server_fixtures.base2 waited 0:00:00.614570 for server to start successfully
2021-01-13 15:33:29,454 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:29,455 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:29,695 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:29,697 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpr9o2y7ns
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=12799 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpr9o2y7ns
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:12799
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:12799
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.614570 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:29.708+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:29.708+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:29,726 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:29,731 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:33:29,731 INFO arctic.store.version_store Deleting data item: 'FTL' from 'arctic_test.TEST'
2021-01-13 15:33:29,734 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:29,752 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[32mINFO    [0m arctic.store.version_store:version_store.py:938 Deleting data item: 'FTL' from 'arctic_test.TEST'
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stdout teardown ---------------------------
2021-01-13T15:33:30.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:30,003 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27262 (total_procs_to_kill=1)
2021-01-13 15:33:30,003 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:30,004 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:30,008 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:30,008 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:30,008 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:30,008 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpr9o2y7ns
2021-01-13 15:33:30,008 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:30,008 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27262 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpr9o2y7ns
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m___________ test_write_metadata_delete_symbol[FwPointersCfg.HYBRID] ____________[0m

library = <VersionStore at 0x7f84e43345c0>
    <ArcticLibrary at 0x7f84e4334c50, arctic_test.TEST>
        <Arctic at 0x7f84e4334eb8, connected to MongoClient(host=['127.67.249.105:17648'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_delete_symbol(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2 (only metadata)
    
                library.delete(symbol)
    
                with pytest.raises(NoDataFoundException):
                    library.read(symbol)
    
                library.write(symbol, data=mydf_b, metadata={'field_a': 1})  # creates version 1
>               assert_frame_equal(library.read(symbol).data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1261: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:30.039+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:30.041+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27297 port=17648 dbpath=/tmp/tmp8uulspkk 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:30.041+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:30.041+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:30.041+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:30.041+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:30.041+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:30.041+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:30.041+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:30.041+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:30.041+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:30.041+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 17648, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp8uulspkk", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:30.041+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:30.041+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:30.041+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:30.041+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:30.542+0000 I STORAGE  [initandlisten] WiredTiger message [1610552010:542191][27297:0x7fa047c5ea80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:30.556+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:30.584+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:30.584+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:30.584+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:30.584+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:30.584+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: dd9a8cea-488e-466b-bab4-e92adf89e90d
2021-01-13T15:33:30.603+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:30.603+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:30.603+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:30.603+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:30.603+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 0de12b51-d87f-4b5b-b201-2873cac090b5
2021-01-13T15:33:30.623+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:30.623+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp8uulspkk/diagnostic.data'
2021-01-13T15:33:30.624+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:30.624+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 1a5ca99e-4527-4c5f-a3f0-247ae7fb2bc2
2021-01-13T15:33:30.625+0000 I NETWORK  [initandlisten] waiting for connections on port 17648
2021-01-13T15:33:30.635+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:51290 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:30.637+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:51292 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:30.640+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:51294 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:30.644+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:51296 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:30.655+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:30.655+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:30.655+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:30.655+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--319152849018635874
2021-01-13T15:33:30.655+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:30.655+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:30.658+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:30.659+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: b1ecc0ba-e78d-4bb3-bef1-ab8376e64c34
2021-01-13T15:33:30.689+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:30.689+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:30.690+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:30.690+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--319152849018635874
2021-01-13T15:33:30.690+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:30.692+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:30.692+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: f13a92d6-e054-4a2a-ba28-f317c0ef52ad
2021-01-13T15:33:30.713+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 0ba49912-7bcf-45df-a6de-9b1802d64c93
2021-01-13T15:33:30.735+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:30.746+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:30.746+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:30.747+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 33505220-00b6-40ec-a959-3212f937ecd2
2021-01-13T15:33:30.777+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:30.777+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:30.778+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:30.788+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:30.788+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:30.789+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: c43c729c-072f-4715-855c-beace4ccf4c8
2021-01-13T15:33:30.808+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:30.817+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:30.817+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:30.819+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: cb1ab722-e97c-458c-b4e5-f400527d9af7
2021-01-13T15:33:30.847+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:30.847+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:30.848+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:30.858+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:30.858+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:30.869+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:30.869+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:30.881+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:30.881+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:30,012 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:30,012 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:30,012 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp8uulspkk
2021-01-13 15:33:30,012 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:30,012 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:30,012 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:30,012 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:30,024 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=17648 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp8uulspkk
2021-01-13 15:33:30,024 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:30,025 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:30,025 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:17648
2021-01-13 15:33:30,631 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:30,632 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:17648
2021-01-13 15:33:30,641 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615895 for server to start successfully
2021-01-13 15:33:30,641 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:30,642 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:30,889 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:30,891 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp8uulspkk
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=17648 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp8uulspkk
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:17648
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:17648
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615895 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:30.900+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:30.901+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:30,919 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:30,924 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:33:30,924 INFO arctic.store.version_store Deleting data item: 'FTL' from 'arctic_test.TEST'
2021-01-13 15:33:30,927 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:30,945 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[32mINFO    [0m arctic.store.version_store:version_store.py:938 Deleting data item: 'FTL' from 'arctic_test.TEST'
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stdout teardown ---------------------------
2021-01-13T15:33:31.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:31,047 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27297 (total_procs_to_kill=1)
2021-01-13 15:33:31,047 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:31,047 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:31,051 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:31,052 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:31,052 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:31,052 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp8uulspkk
2021-01-13 15:33:31,052 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:31,052 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27297 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp8uulspkk
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m___________ test_write_metadata_delete_symbol[FwPointersCfg.ENABLED] ___________[0m

library = <VersionStore at 0x7f84e4160d30>
    <ArcticLibrary at 0x7f84e4160da0, arctic_test.TEST>
        <Arctic at 0x7f84e4334d30, connected to MongoClient(host=['127.67.249.105:21891'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_delete_symbol(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2 (only metadata)
    
                library.delete(symbol)
    
                with pytest.raises(NoDataFoundException):
                    library.read(symbol)
    
                library.write(symbol, data=mydf_b, metadata={'field_a': 1})  # creates version 1
>               assert_frame_equal(library.read(symbol).data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1261: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:31.082+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:31.085+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27332 port=21891 dbpath=/tmp/tmpq2nd_g7f 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:31.085+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:31.085+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:31.085+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:31.085+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:31.085+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:31.085+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:31.085+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:31.085+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:31.085+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:31.085+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 21891, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpq2nd_g7f", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:31.085+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:31.085+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:31.085+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:31.085+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:31.586+0000 I STORAGE  [initandlisten] WiredTiger message [1610552011:586138][27332:0x7f2c57a09a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:31.599+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:31.625+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:31.625+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:31.625+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:31.625+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:31.626+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: ceb0bc1e-0d50-48fd-ad8d-5df2b418e444
2021-01-13T15:33:31.645+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:31.645+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:31.645+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:31.645+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:31.645+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: d546c86b-86a4-462b-a48d-b23b56397d7b
2021-01-13T15:33:31.667+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:31.667+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpq2nd_g7f/diagnostic.data'
2021-01-13T15:33:31.668+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:31.668+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: e055fb50-0bfd-4aa0-9bd3-1a39423e0702
2021-01-13T15:33:31.669+0000 I NETWORK  [initandlisten] waiting for connections on port 21891
2021-01-13T15:33:31.677+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:48782 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:31.679+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:48784 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:31.683+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:48786 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:31.685+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:48788 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:31.699+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:31.699+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:31.699+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:31.699+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-3258105521126791987
2021-01-13T15:33:31.699+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:31.699+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:31.703+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:31.703+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: e207be79-d7b5-4142-9078-9a9be32a304e
2021-01-13T15:33:31.735+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:31.735+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:31.735+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:31.735+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-3258105521126791987
2021-01-13T15:33:31.735+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:31.737+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:31.737+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: ae85951b-c16d-4039-aa24-4efe3d314202
2021-01-13T15:33:31.758+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: d4eec484-1afd-4fb6-b4a0-555fb168c8ef
2021-01-13T15:33:31.774+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:31.784+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:31.785+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:31.786+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 641f76fb-8bf0-40df-8dc5-1d14c8df87cb
2021-01-13T15:33:31.815+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:31.815+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:31.816+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:31.825+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:31.825+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:31.826+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 037a9727-7de4-4ddc-b53c-7f3d772f36a3
2021-01-13T15:33:31.845+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:31.856+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:31.856+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:31.857+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: b2f993c6-49e7-4d9f-93a7-296120162bb9
2021-01-13T15:33:31.890+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:31.891+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:31.892+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:31.902+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:31.902+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:31.912+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:31.912+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:31.924+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:31.924+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:31,055 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:31,055 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:31,056 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpq2nd_g7f
2021-01-13 15:33:31,056 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:31,056 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:31,056 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:31,056 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:31,067 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=21891 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpq2nd_g7f
2021-01-13 15:33:31,068 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:31,068 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:31,069 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:21891
2021-01-13 15:33:31,674 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:31,674 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:21891
2021-01-13 15:33:31,683 DEBUG pytest_server_fixtures.base2 waited 0:00:00.614506 for server to start successfully
2021-01-13 15:33:31,683 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:31,684 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:31,931 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:31,933 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpq2nd_g7f
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=21891 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpq2nd_g7f
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:21891
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:21891
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.614506 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:31.943+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:31.944+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:31,962 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:31,967 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:33:31,968 INFO arctic.store.version_store Deleting data item: 'FTL' from 'arctic_test.TEST'
2021-01-13 15:33:31,971 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:31,988 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[32mINFO    [0m arctic.store.version_store:version_store.py:938 Deleting data item: 'FTL' from 'arctic_test.TEST'
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stdout teardown ---------------------------
2021-01-13T15:33:32.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:32,091 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27332 (total_procs_to_kill=1)
2021-01-13 15:33:32,091 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:32,092 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:32,096 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:32,096 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:32,096 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:32,096 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpq2nd_g7f
2021-01-13 15:33:32,096 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:32,096 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27332 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpq2nd_g7f
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m____________ test_write_metadata_snapshots[FwPointersCfg.DISABLED] _____________[0m

library = <VersionStore at 0x7f84e4115cc0>
    <ArcticLibrary at 0x7f84e41154a8, arctic_test.TEST>
        <Arctic at 0x7f84e4113d68, connected to MongoClient(host=['127.67.249.105:27221'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_snapshots(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b = _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.snapshot('SNAP_1')
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2 (only metadata)
                library.snapshot('SNAP_2')
                library.write(symbol, data=mydf_b, metadata={'field_c': 1})  # creates version 3
                library.snapshot('SNAP_3')
    
                library._prune_previous_versions(symbol, keep_mins=0)
    
                v = library.read(symbol)
>               assert_frame_equal(v.data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1280: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:32.127+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:32.129+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27367 port=27221 dbpath=/tmp/tmpfjz7svbl 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:32.129+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:32.129+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:32.129+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:32.129+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:32.129+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:32.129+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:32.129+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:32.129+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:32.129+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:32.129+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 27221, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpfjz7svbl", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:32.129+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:32.129+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:32.129+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:32.129+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:32.629+0000 I STORAGE  [initandlisten] WiredTiger message [1610552012:629435][27367:0x7fc9fa0a9a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:32.643+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:32.669+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:32.669+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:32.669+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:32.669+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:32.669+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 3a8cf18e-4a6a-496d-b44c-d0dbfd7a60cc
2021-01-13T15:33:32.690+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:32.690+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:32.690+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:32.690+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:32.690+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 30ba8297-d545-4ca4-a121-96c93fb515e1
2021-01-13T15:33:32.711+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:32.711+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpfjz7svbl/diagnostic.data'
2021-01-13T15:33:32.712+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:32.713+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 21cee706-8945-458e-b138-be316e262877
2021-01-13T15:33:32.713+0000 I NETWORK  [initandlisten] waiting for connections on port 27221
2021-01-13T15:33:32.723+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:33014 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:32.724+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:33016 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:32.728+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:33018 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:32.730+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:33020 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:32.742+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:32.742+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:32.744+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:32.744+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:32.747+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:32.747+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 054184ac-d5ba-4ff8-84b7-dd5a9ea2c0cc
2021-01-13T15:33:32.777+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:32.777+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:32.777+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:32.777+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--9077400423652746757
2021-01-13T15:33:32.777+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:32.780+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:32.780+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: e4265273-a6a1-4920-a2ef-918c623be99f
2021-01-13T15:33:32.801+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 78368f1a-4c35-4f17-93dd-a9d9b677e665
2021-01-13T15:33:32.822+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:32.835+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:32.835+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:32.836+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: bef25d2b-1e94-47d3-8f61-4040ed090d19
2021-01-13T15:33:32.865+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:32.865+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:32.867+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:32.876+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:32.876+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:32.877+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 30a90845-9944-4ed2-ba77-92e89c2a1818
2021-01-13T15:33:32.898+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:32.909+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:32.909+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:32.910+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: e3130980-8602-4637-a8bd-5b91a037a6eb
2021-01-13T15:33:32.942+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:32.942+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:32.943+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:32.955+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:32.955+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:32.966+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:32.966+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:32.978+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:32.978+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:32,099 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:32,100 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:32,100 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpfjz7svbl
2021-01-13 15:33:32,100 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:32,100 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:32,100 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:32,100 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:32,112 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=27221 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpfjz7svbl
2021-01-13 15:33:32,112 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:32,113 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:32,113 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:27221
2021-01-13 15:33:32,719 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:32,720 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:27221
2021-01-13 15:33:32,728 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615401 for server to start successfully
2021-01-13 15:33:32,729 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:32,729 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:32,986 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:32,988 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpfjz7svbl
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=27221 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpfjz7svbl
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:27221
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:27221
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615401 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:32.998+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:32.998+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:33:33.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:33,017 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:33,026 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:33:33,038 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:33,143 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27367 (total_procs_to_kill=1)
2021-01-13 15:33:33,143 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:33,144 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:33,148 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:33,148 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:33,148 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:33,148 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpfjz7svbl
2021-01-13 15:33:33,148 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:33,148 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27367 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpfjz7svbl
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_____________ test_write_metadata_snapshots[FwPointersCfg.HYBRID] ______________[0m

library = <VersionStore at 0x7f84e74bff98>
    <ArcticLibrary at 0x7f84e4099470, arctic_test.TEST>
        <Arctic at 0x7f84e41537b8, connected to MongoClient(host=['127.67.249.105:19924'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_snapshots(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b = _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.snapshot('SNAP_1')
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2 (only metadata)
                library.snapshot('SNAP_2')
                library.write(symbol, data=mydf_b, metadata={'field_c': 1})  # creates version 3
                library.snapshot('SNAP_3')
    
                library._prune_previous_versions(symbol, keep_mins=0)
    
                v = library.read(symbol)
>               assert_frame_equal(v.data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1280: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:33.179+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:33.182+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27402 port=19924 dbpath=/tmp/tmpb1ulqnyh 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:33.182+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:33.182+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:33.182+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:33.182+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:33.182+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:33.182+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:33.182+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:33.182+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:33.182+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:33.182+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 19924, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpb1ulqnyh", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:33.182+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:33.182+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:33.182+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:33.182+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:33.681+0000 I STORAGE  [initandlisten] WiredTiger message [1610552013:681826][27402:0x7fb4473cba80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:33.694+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:33.718+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:33.718+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:33.718+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:33.718+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:33.718+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 3b486b7e-795a-4f97-a6ef-0aad994fc88f
2021-01-13T15:33:33.736+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:33.736+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:33.736+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:33.737+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:33.737+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 133cd17d-51b0-461b-bcef-27e908f97d2b
2021-01-13T15:33:33.754+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:33.755+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpb1ulqnyh/diagnostic.data'
2021-01-13T15:33:33.756+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:33.756+0000 I NETWORK  [initandlisten] waiting for connections on port 19924
2021-01-13T15:33:33.756+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:33:33.756+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 2057b6f4-8306-4493-a3a4-9932c69c6616
2021-01-13T15:33:33.775+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:47330 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:33.777+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:47332 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:33.780+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:47334 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:33.783+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:47336 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:33.786+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:33.786+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:33.786+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:33.786+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--4304720830916727586
2021-01-13T15:33:33.786+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:33.790+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:33.790+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: c0c8e0a0-1f6e-4ce4-ad71-8ef5730023d4
2021-01-13T15:33:33.817+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:33.817+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:33.818+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:33.818+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--4304720830916727586
2021-01-13T15:33:33.818+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:33.820+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:33.820+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 46c9cd3a-515f-4e1c-aaa1-3629eb12c2ed
2021-01-13T15:33:33.838+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 3bb632aa-dd63-436a-bc5c-814e5bfeab99
2021-01-13T15:33:33.859+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:33.868+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:33.868+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:33.870+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: ec6c00b6-c5ee-4e11-87fb-6a920a8ce6d5
2021-01-13T15:33:33.899+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:33.899+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:33.900+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:33.910+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:33.910+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:33.911+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: b9d5552b-d0c5-4ef3-89a9-b9f2088592d4
2021-01-13T15:33:33.930+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:33.940+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:33.940+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:33.941+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 033e449f-d4a9-4af1-b7c5-425eb073fcbb
2021-01-13T15:33:33.970+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:33.970+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:33.971+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:33.983+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:33.983+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:33.994+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:33.994+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:34.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:33:34.005+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:34.005+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:33,152 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:33,152 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:33,152 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpb1ulqnyh
2021-01-13 15:33:33,152 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:33,152 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:33,152 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:33,153 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:33,164 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=19924 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpb1ulqnyh
2021-01-13 15:33:33,164 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:33,165 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:33,165 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:19924
2021-01-13 15:33:33,772 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:33,772 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:19924
2021-01-13 15:33:33,781 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615870 for server to start successfully
2021-01-13 15:33:33,781 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:33,782 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:34,012 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:34,014 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpb1ulqnyh
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=19924 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpb1ulqnyh
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:19924
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:19924
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615870 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:34.025+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:34.025+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:34,043 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:34,052 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:33:34,063 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:34,313 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27402 (total_procs_to_kill=1)
2021-01-13 15:33:34,314 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:34,314 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:34,318 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:34,318 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:34,318 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:34,318 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpb1ulqnyh
2021-01-13 15:33:34,319 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:34,319 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27402 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpb1ulqnyh
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_____________ test_write_metadata_snapshots[FwPointersCfg.ENABLED] _____________[0m

library = <VersionStore at 0x7f84c437d128>
    <ArcticLibrary at 0x7f84c437d898, arctic_test.TEST>
        <Arctic at 0x7f84e4097cc0, connected to MongoClient(host=['127.67.249.105:2747'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_write_metadata_snapshots(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a, mydf_b = _rnd_df(10, 5), _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.snapshot('SNAP_1')
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2 (only metadata)
                library.snapshot('SNAP_2')
                library.write(symbol, data=mydf_b, metadata={'field_c': 1})  # creates version 3
                library.snapshot('SNAP_3')
    
                library._prune_previous_versions(symbol, keep_mins=0)
    
                v = library.read(symbol)
>               assert_frame_equal(v.data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1280: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:34.350+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:34.352+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27437 port=2747 dbpath=/tmp/tmpehl4uc32 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:34.352+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:34.352+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:34.352+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:34.352+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:34.352+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:34.352+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:34.352+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:34.352+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:34.352+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:34.352+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 2747, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpehl4uc32", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:34.353+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:34.353+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:34.353+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:34.353+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:34.850+0000 I STORAGE  [initandlisten] WiredTiger message [1610552014:850858][27437:0x7f22d207fa80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:34.862+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:34.889+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:34.889+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:34.889+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:34.889+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:34.890+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: ec554ef8-d4e0-47f6-9fe7-d279dbfa332f
2021-01-13T15:33:34.910+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:34.910+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:34.910+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:34.910+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:34.910+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 130736b1-947e-4be2-afc1-a04fd6ef855a
2021-01-13T15:33:34.931+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:34.931+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpehl4uc32/diagnostic.data'
2021-01-13T15:33:34.932+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:34.932+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: e8e39f51-64d1-41c1-be33-cffef3a2ec41
2021-01-13T15:33:34.933+0000 I NETWORK  [initandlisten] waiting for connections on port 2747
2021-01-13T15:33:34.946+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:50876 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:34.947+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:50878 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:34.951+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:50880 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:34.954+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:50882 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:34.958+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:34.958+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:34.958+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:34.958+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--9132731588640806627
2021-01-13T15:33:34.958+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:34.958+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:34.962+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:34.962+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: f7544016-9f64-45ec-8596-769b48c80d03
2021-01-13T15:33:34.993+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:34.993+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:34.993+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:34.993+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--9132731588640806627
2021-01-13T15:33:34.993+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:34.995+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:34.995+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: ce8c9bbe-a7a2-481f-95bf-978b056148b7
2021-01-13T15:33:35.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:33:35.020+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: d62ba5cb-c3eb-4360-bcc8-810b7c285012
2021-01-13T15:33:35.037+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:35.047+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:35.047+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:35.048+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 6cbcece2-844c-45e2-bc45-7d31c83e141d
2021-01-13T15:33:35.078+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:35.078+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:35.079+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:35.088+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:35.088+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:35.089+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: af892131-f17b-43fe-961c-915ef4af8b95
2021-01-13T15:33:35.112+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:35.124+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:35.124+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:35.125+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 171df9ef-b36c-4476-86d1-2b5f97dc64c9
2021-01-13T15:33:35.159+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:35.159+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:35.160+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:35.174+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:35.174+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:35.185+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:35.185+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:35.198+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:35.198+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:34,322 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:34,322 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:34,322 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpehl4uc32
2021-01-13 15:33:34,322 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:34,323 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:34,323 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:34,323 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:34,334 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=2747 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpehl4uc32
2021-01-13 15:33:34,335 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:34,336 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:34,336 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:2747
2021-01-13 15:33:34,943 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:34,943 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:2747
2021-01-13 15:33:34,952 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615874 for server to start successfully
2021-01-13 15:33:34,952 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:34,953 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:35,205 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:35,207 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpehl4uc32
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=2747 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpehl4uc32
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:2747
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:2747
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615874 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:35.217+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:35.218+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:35,235 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:35,244 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:33:35,255 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:35,361 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27437 (total_procs_to_kill=1)
2021-01-13 15:33:35,362 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:35,362 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:35,366 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:35,366 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:35,367 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:35,367 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpehl4uc32
2021-01-13 15:33:35,367 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:35,367 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27437 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpehl4uc32
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_________________ test_restore_version[FwPointersCfg.DISABLED] _________________[0m

library = <VersionStore at 0x7f84e72d19e8>
    <ArcticLibrary at 0x7f84e72d15c0, arctic_test.TEST>
        <Arctic at 0x7f84e416bc18, connected to MongoClient(host=['127.67.249.105:10289'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1303: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:35.400+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:35.402+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27472 port=10289 dbpath=/tmp/tmpttw_htk1 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:35.402+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:35.402+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:35.402+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:35.402+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:35.402+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:35.402+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:35.402+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:35.402+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:35.402+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:35.402+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 10289, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpttw_htk1", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:35.402+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:35.402+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:35.402+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:35.402+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:35.902+0000 I STORAGE  [initandlisten] WiredTiger message [1610552015:902749][27472:0x7f475a6e0a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:35.915+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:35.942+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:35.942+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:35.942+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:35.942+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:35.943+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 16aeb285-fc07-4f83-b510-f0828fdbae7a
2021-01-13T15:33:35.961+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:35.961+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:35.961+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:35.961+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:35.962+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: b945dda5-1b6d-4557-8892-1b64cba80197
2021-01-13T15:33:35.980+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:35.980+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpttw_htk1/diagnostic.data'
2021-01-13T15:33:35.981+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:35.982+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 90b543ea-5774-489f-b5f9-470ef3b3446d
2021-01-13T15:33:35.982+0000 I NETWORK  [initandlisten] waiting for connections on port 10289
2021-01-13T15:33:35.996+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:52200 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:35.997+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:52202 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:36.002+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:33:36.005+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:52204 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:36.008+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:52206 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:36.014+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:36.014+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:36.014+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:36.014+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--1643309280759041752
2021-01-13T15:33:36.014+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:36.014+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:36.018+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:36.018+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 3b14daec-1d7b-4645-8a44-f169d4f4cdf4
2021-01-13T15:33:36.046+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:36.046+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:36.046+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:36.046+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--1643309280759041752
2021-01-13T15:33:36.046+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:36.049+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:36.049+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 8bb68f3a-66bd-491c-8c6e-4e827aa6e274
2021-01-13T15:33:36.068+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 0138517a-345c-4fcb-ae6e-7c31d38fd546
2021-01-13T15:33:36.085+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:36.095+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:36.095+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:36.096+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 75ee7b22-99c9-4712-b271-3ef5066772b0
2021-01-13T15:33:36.125+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:36.126+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:36.127+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:36.136+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:36.136+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:36.137+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 86564464-cd12-4811-aab8-5ee107268164
2021-01-13T15:33:36.159+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:36.174+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:36.174+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:36.175+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: d5648e36-d8a2-41d5-8fb6-4533bdffd4e2
2021-01-13T15:33:36.208+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:36.208+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:36.209+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:36.219+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:36.219+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:36.229+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:36.229+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:36.241+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:36.241+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:35,370 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:35,370 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:35,371 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpttw_htk1
2021-01-13 15:33:35,371 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:35,371 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:35,371 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:35,371 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:35,384 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=10289 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpttw_htk1
2021-01-13 15:33:35,384 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:35,385 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:35,385 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:10289
2021-01-13 15:33:35,992 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:35,992 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:10289
2021-01-13 15:33:36,006 DEBUG pytest_server_fixtures.base2 waited 0:00:00.620665 for server to start successfully
2021-01-13 15:33:36,006 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:36,007 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:36,248 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:36,250 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpttw_htk1
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=10289 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpttw_htk1
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:10289
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:10289
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.620665 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:36.261+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:36.261+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:36,279 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:36,287 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:36,390 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27472 (total_procs_to_kill=1)
2021-01-13 15:33:36,390 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:36,394 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:36,394 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:36,394 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:36,395 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:36,395 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpttw_htk1
2021-01-13 15:33:36,395 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:36,395 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27472 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpttw_htk1
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m__________________ test_restore_version[FwPointersCfg.HYBRID] __________________[0m

library = <VersionStore at 0x7f84e41536d8>
    <ArcticLibrary at 0x7f84e4153c88, arctic_test.TEST>
        <Arctic at 0x7f84e4153780, connected to MongoClient(host=['127.67.249.105:10657'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1303: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:36.425+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:36.428+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27507 port=10657 dbpath=/tmp/tmpzoqam_9x 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:36.428+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:36.428+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:36.428+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:36.428+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:36.428+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:36.428+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:36.428+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:36.428+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:36.428+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:36.428+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 10657, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpzoqam_9x", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:36.428+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:36.428+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:36.428+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:36.428+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:36.928+0000 I STORAGE  [initandlisten] WiredTiger message [1610552016:928186][27507:0x7f62ab969a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:36.940+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:36.964+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:36.964+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:36.964+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:36.964+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:36.964+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: f97bf2ff-ae0c-4db7-a485-f7b3712f17ac
2021-01-13T15:33:36.988+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:36.988+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:36.988+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:36.988+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:36.988+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 7511017c-8a7a-45f0-bf2e-589d77c4fb99
2021-01-13T15:33:37.006+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:37.006+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpzoqam_9x/diagnostic.data'
2021-01-13T15:33:37.008+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:37.008+0000 I NETWORK  [initandlisten] waiting for connections on port 10657
2021-01-13T15:33:37.008+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:33:37.008+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: a1f022ed-fdd9-449c-8939-cebc9be092c0
2021-01-13T15:33:37.022+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:49146 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:37.023+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:49148 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:37.029+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:49150 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:37.031+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:49152 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:37.036+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:37.036+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:37.036+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:37.036+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-3237366663425655780
2021-01-13T15:33:37.036+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:37.040+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:37.040+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 8da4ca1d-9f62-4ace-a9aa-ab19a324b765
2021-01-13T15:33:37.068+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:37.068+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:37.068+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:37.068+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-3237366663425655780
2021-01-13T15:33:37.068+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:37.071+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:37.071+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 193179b6-3cd0-4028-9972-031433a7cacc
2021-01-13T15:33:37.092+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 589d7ee0-dc54-4490-857d-27b412a35301
2021-01-13T15:33:37.109+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:37.119+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:37.119+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:37.120+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 16b3ebc9-de50-4f20-8bca-03c9cf7572ec
2021-01-13T15:33:37.154+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:37.154+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:37.155+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:37.164+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:37.164+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:37.165+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 11f4732e-83aa-45b2-b206-eae5324f48f5
2021-01-13T15:33:37.185+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:37.196+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:37.196+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:37.198+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 3437e675-6cbc-4d78-abe3-675f4683439c
2021-01-13T15:33:37.230+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:37.230+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:37.231+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:37.242+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:37.242+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:37.252+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:37.252+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:37.265+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:37.266+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:36,398 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:36,398 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:36,398 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpzoqam_9x
2021-01-13 15:33:36,399 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:36,399 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:36,399 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:36,399 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:36,410 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=10657 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpzoqam_9x
2021-01-13 15:33:36,411 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:36,411 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:36,412 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:10657
2021-01-13 15:33:37,018 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:37,018 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:10657
2021-01-13 15:33:37,027 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616084 for server to start successfully
2021-01-13 15:33:37,028 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:37,029 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:37,272 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:37,275 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpzoqam_9x
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=10657 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpzoqam_9x
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:10657
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:10657
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616084 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:37.284+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:37.284+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:37,303 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:37,311 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:37,415 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27507 (total_procs_to_kill=1)
2021-01-13 15:33:37,415 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:37,416 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:37,420 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:37,420 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:37,420 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:37,420 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpzoqam_9x
2021-01-13 15:33:37,420 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:37,420 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27507 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpzoqam_9x
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_________________ test_restore_version[FwPointersCfg.ENABLED] __________________[0m

library = <VersionStore at 0x7f84c47cbc18>
    <ArcticLibrary at 0x7f84c47cbe80, arctic_test.TEST>
        <Arctic at 0x7f84e40844e0, connected to MongoClient(host=['127.67.249.105:10326'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_b)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1303: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:37.451+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:37.453+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27542 port=10326 dbpath=/tmp/tmpiafocc1h 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:37.453+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:37.454+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:37.454+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:37.454+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:37.454+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:37.454+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:37.454+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:37.454+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:37.454+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:37.454+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 10326, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpiafocc1h", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:37.454+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:37.454+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:37.454+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:37.454+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:37.952+0000 I STORAGE  [initandlisten] WiredTiger message [1610552017:952861][27542:0x7f8b2f1f2a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:37.965+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:37.992+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:37.992+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:37.992+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:37.992+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:37.992+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: e2bc897c-e4d4-4783-bb28-ee0c57156989
2021-01-13T15:33:38.011+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:38.012+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:38.012+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:38.012+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:38.012+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 9f7bf082-a39d-4023-a526-d0c2c85d4095
2021-01-13T15:33:38.031+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:38.031+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpiafocc1h/diagnostic.data'
2021-01-13T15:33:38.033+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:38.033+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 433874d1-db8d-41e4-942c-1459bbad824a
2021-01-13T15:33:38.033+0000 I NETWORK  [initandlisten] waiting for connections on port 10326
2021-01-13T15:33:38.047+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:37616 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:38.048+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:37618 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:38.052+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:37620 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:38.054+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:37622 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:38.059+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:38.059+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:38.059+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:38.059+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--8009191985160190491
2021-01-13T15:33:38.059+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:38.059+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:38.062+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:38.062+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: ed3dd0c5-0e97-49ee-b92f-c845ae077625
2021-01-13T15:33:38.092+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:38.092+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:38.092+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:38.092+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--8009191985160190491
2021-01-13T15:33:38.092+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:38.094+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:38.094+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 85ea0a6c-2bd2-48c9-a860-f36b3153f9d4
2021-01-13T15:33:38.116+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: f59f835c-1678-479a-be49-3a51849f1f85
2021-01-13T15:33:38.136+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:38.147+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:38.147+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:38.148+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: da554444-ab95-4d63-8678-50c38c8a06c6
2021-01-13T15:33:38.181+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:38.181+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:38.182+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:38.192+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:38.192+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:38.193+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: b7967dcc-7ea5-4b98-9e3d-566b12435ebb
2021-01-13T15:33:38.213+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:38.223+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:38.223+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:38.225+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: df1f91fc-7c95-4dd0-9bc4-3260020b5700
2021-01-13T15:33:38.254+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:38.254+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:38.255+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:38.266+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:38.266+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:38.278+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:38.278+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:38.290+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:38.290+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:37,424 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:37,424 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:37,424 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpiafocc1h
2021-01-13 15:33:37,424 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:37,424 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:37,424 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:37,425 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:37,436 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=10326 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpiafocc1h
2021-01-13 15:33:37,436 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:37,437 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:37,437 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:10326
2021-01-13 15:33:38,043 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:38,044 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:10326
2021-01-13 15:33:38,052 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615323 for server to start successfully
2021-01-13 15:33:38,052 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:38,053 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:38,297 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:38,299 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpiafocc1h
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=10326 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpiafocc1h
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:10326
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:10326
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615323 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:38.309+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:38.309+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:38,327 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:38,334 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:38,588 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27542 (total_procs_to_kill=1)
2021-01-13 15:33:38,588 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:38,590 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:38,592 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:38,593 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:38,593 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:38,593 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpiafocc1h
2021-01-13 15:33:38,593 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:38,593 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27542 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpiafocc1h
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m____ test_restore_version_purging_previous_versions[FwPointersCfg.DISABLED] ____[0m

library = <VersionStore at 0x7f84c43ccef0>
    <ArcticLibrary at 0x7f84c43cc1d0, arctic_test.TEST>
        <Arctic at 0x7f84c4377400, connected to MongoClient(host=['127.67.249.105:22779'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_purging_previous_versions(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
    
                restore_item = library.restore_version(symbol, as_of=1)  # creates version 3
                assert restore_item.version == 3
                assert restore_item.metadata == {'field_a': 1}
    
                # Trigger GC now
                library._prune_previous_versions(symbol, 0)
                time.sleep(2)
    
                # library._delete_version(symbol, 1)  # delete the original version to test further the robustness/dependency
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1365: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:47.560+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:47.562+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27682 port=22779 dbpath=/tmp/tmpmdkepmnj 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:47.562+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:47.562+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:47.562+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:47.562+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:47.562+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:47.562+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:47.562+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:47.562+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:47.562+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:47.562+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 22779, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpmdkepmnj", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:47.563+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:47.563+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:47.563+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:47.563+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:48.058+0000 I STORAGE  [initandlisten] WiredTiger message [1610552028:58879][27682:0x7f8b9000da80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:48.071+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:48.096+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:48.096+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:48.096+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:48.096+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:48.096+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 30d17e51-7e71-4558-95aa-2f014250e8ea
2021-01-13T15:33:48.115+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:48.115+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:48.115+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:48.115+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:48.116+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 134d99c9-50ca-4587-b6f6-aff6b58ecddf
2021-01-13T15:33:48.135+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:48.135+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpmdkepmnj/diagnostic.data'
2021-01-13T15:33:48.136+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:48.136+0000 I NETWORK  [initandlisten] waiting for connections on port 22779
2021-01-13T15:33:48.136+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:33:48.137+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: d135be1e-6e0f-43b2-bff0-acf833ac1321
2021-01-13T15:33:48.156+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:51864 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:48.158+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:51866 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:48.162+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:51868 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:48.165+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:51870 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:48.166+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:48.166+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:48.167+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:48.167+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--4650682670400442102
2021-01-13T15:33:48.167+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:48.170+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:48.170+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 81d9a984-14e4-453a-9bdc-848a06a9731b
2021-01-13T15:33:48.199+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:48.199+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:48.200+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:48.200+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--4650682670400442102
2021-01-13T15:33:48.200+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:48.202+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:48.202+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 5b4b735a-7e58-43d0-ba9a-470188933b8c
2021-01-13T15:33:48.222+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 6f35da67-ce42-4afc-9afa-ec0caafa9ec9
2021-01-13T15:33:48.239+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:48.248+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:48.249+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:48.250+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 8bf1e3ee-ca84-42c5-99e3-7739debbf169
2021-01-13T15:33:48.279+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:48.279+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:48.280+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:48.290+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:48.290+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:48.291+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: b5fa47a9-2aca-4b25-8d1c-352459c1f23b
2021-01-13T15:33:48.311+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:48.322+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:48.322+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:48.323+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 9c5404df-6df3-4b1c-a287-339f988fa8c5
2021-01-13T15:33:48.352+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:48.352+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:48.354+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:48.364+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:48.364+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:48.376+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:48.376+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:48.389+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:48.389+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:47,533 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:47,533 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:47,533 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpmdkepmnj
2021-01-13 15:33:47,533 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:47,533 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:47,534 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:47,534 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:47,545 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=22779 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpmdkepmnj
2021-01-13 15:33:47,545 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:47,546 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:47,546 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:22779
2021-01-13 15:33:48,152 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:48,152 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:22779
2021-01-13 15:33:48,163 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616449 for server to start successfully
2021-01-13 15:33:48,163 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:48,163 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:48,396 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:48,399 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpmdkepmnj
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=22779 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpmdkepmnj
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:22779
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:22779
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616449 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:48.409+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:48.410+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:33:49.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:48,427 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:48,435 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:48,450 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:50,562 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27682 (total_procs_to_kill=1)
2021-01-13 15:33:50,562 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:50,563 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:50,567 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:50,567 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:50,567 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:50,567 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpmdkepmnj
2021-01-13 15:33:50,567 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:50,567 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27682 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpmdkepmnj
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_____ test_restore_version_purging_previous_versions[FwPointersCfg.HYBRID] _____[0m

library = <VersionStore at 0x7f84c475cbe0>
    <ArcticLibrary at 0x7f84c475c550, arctic_test.TEST>
        <Arctic at 0x7f84c475c908, connected to MongoClient(host=['127.67.249.105:1747'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_purging_previous_versions(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
    
                restore_item = library.restore_version(symbol, as_of=1)  # creates version 3
                assert restore_item.version == 3
                assert restore_item.metadata == {'field_a': 1}
    
                # Trigger GC now
                library._prune_previous_versions(symbol, 0)
                time.sleep(2)
    
                # library._delete_version(symbol, 1)  # delete the original version to test further the robustness/dependency
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1365: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:50.599+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:50.601+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27717 port=1747 dbpath=/tmp/tmpkamm7k58 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:50.601+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:50.601+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:50.601+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:50.601+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:50.601+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:50.601+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:50.601+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:50.601+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:50.601+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:50.601+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 1747, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpkamm7k58", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:50.601+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:50.601+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:50.601+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:50.601+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:51.103+0000 I STORAGE  [initandlisten] WiredTiger message [1610552031:103709][27717:0x7f7e4d1b5a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:51.117+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:51.143+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:51.143+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:51.143+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:51.143+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:51.144+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: b8c2f33d-e51d-47d6-b13b-3cc5ad7c7e88
2021-01-13T15:33:51.163+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:51.163+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:51.163+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:51.163+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:51.164+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: bd948a8d-cbd4-437f-b803-8f07b82627fd
2021-01-13T15:33:51.185+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:51.185+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpkamm7k58/diagnostic.data'
2021-01-13T15:33:51.186+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:51.186+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 5b1bd55f-c62e-49c5-9314-660f498db379
2021-01-13T15:33:51.186+0000 I NETWORK  [initandlisten] waiting for connections on port 1747
2021-01-13T15:33:51.194+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:51656 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:51.195+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:51658 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:51.199+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:51660 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:51.201+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:51662 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:51.213+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:51.213+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:51.215+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:51.215+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:51.219+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:51.219+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: ea603b79-dc59-4574-a20b-c6cb13f44c6b
2021-01-13T15:33:51.250+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:51.250+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:51.250+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:51.250+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-2828331426115694416
2021-01-13T15:33:51.250+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:51.253+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:51.253+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 81fa6ecd-9886-4a82-bf95-be6ec2e50ad0
2021-01-13T15:33:51.275+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: f6481259-9049-4767-b455-5005edfb4567
2021-01-13T15:33:51.296+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:51.307+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:51.307+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:51.309+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 81fdb26f-89d1-40ff-97da-6e93a50799d6
2021-01-13T15:33:51.344+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:51.344+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:51.345+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:51.356+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:51.356+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:51.357+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 6415d5d9-406e-4767-80a2-889bb0d744ad
2021-01-13T15:33:51.380+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:51.392+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:51.392+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:51.393+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 4a940123-d8d9-40ed-aef0-ae6994146f0e
2021-01-13T15:33:51.426+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:51.426+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:51.427+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:51.439+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:51.439+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:51.452+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:51.452+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:51.465+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:51.465+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:50,571 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:50,571 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:50,571 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpkamm7k58
2021-01-13 15:33:50,571 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:50,572 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:50,572 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:50,572 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:50,583 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=1747 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpkamm7k58
2021-01-13 15:33:50,584 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:50,584 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:50,585 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:1747
2021-01-13 15:33:51,190 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:51,191 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:1747
2021-01-13 15:33:51,199 DEBUG pytest_server_fixtures.base2 waited 0:00:00.614873 for server to start successfully
2021-01-13 15:33:51,200 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:51,200 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:51,472 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:51,475 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpkamm7k58
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=1747 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpkamm7k58
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:1747
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:1747
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.614873 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:51.485+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:51.486+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:33:52.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:51,504 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:51,513 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:51,529 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:53,638 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27717 (total_procs_to_kill=1)
2021-01-13 15:33:53,639 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:53,639 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:53,643 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:53,643 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:53,643 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:53,643 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpkamm7k58
2021-01-13 15:33:53,644 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:53,644 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27717 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpkamm7k58
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m____ test_restore_version_purging_previous_versions[FwPointersCfg.ENABLED] _____[0m

library = <VersionStore at 0x7f84e73b4d68>
    <ArcticLibrary at 0x7f84c475ce48, arctic_test.TEST>
        <Arctic at 0x7f84e4115048, connected to MongoClient(host=['127.67.249.105:18152'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_purging_previous_versions(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write(symbol, data=mydf_b, metadata={'field_a': 2})  # creates version 2
    
                restore_item = library.restore_version(symbol, as_of=1)  # creates version 3
                assert restore_item.version == 3
                assert restore_item.metadata == {'field_a': 1}
    
                # Trigger GC now
                library._prune_previous_versions(symbol, 0)
                time.sleep(2)
    
                # library._delete_version(symbol, 1)  # delete the original version to test further the robustness/dependency
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1365: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:53.674+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:53.676+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27752 port=18152 dbpath=/tmp/tmpi3jxsvum 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:53.676+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:53.676+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:53.676+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:53.676+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:53.676+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:53.676+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:53.676+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:53.676+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:53.676+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:53.677+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 18152, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpi3jxsvum", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:53.677+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:53.677+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:53.677+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:53.677+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:54.176+0000 I STORAGE  [initandlisten] WiredTiger message [1610552034:176706][27752:0x7f0646981a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:54.190+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:54.214+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:54.214+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:54.214+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:54.214+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:54.214+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 1243de1a-4818-4cfe-ac76-1b255a23ba00
2021-01-13T15:33:54.233+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:54.233+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:54.233+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:54.233+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:54.233+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 4630ee12-d67a-475a-85f6-5951a4c753ad
2021-01-13T15:33:54.252+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:54.252+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpi3jxsvum/diagnostic.data'
2021-01-13T15:33:54.253+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:54.254+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 5ad6fbc3-b8ec-4d9f-bb36-bb8924c99cfe
2021-01-13T15:33:54.254+0000 I NETWORK  [initandlisten] waiting for connections on port 18152
2021-01-13T15:33:54.270+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:37334 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:54.271+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:37336 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:54.276+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:37338 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:54.279+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:37340 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:54.284+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:54.284+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:54.284+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:54.284+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--7356622615919812878
2021-01-13T15:33:54.284+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:54.284+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:54.288+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:54.288+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: d3e2d5a3-3242-4112-b916-93a168f814c6
2021-01-13T15:33:54.318+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:54.318+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:54.318+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:54.318+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--7356622615919812878
2021-01-13T15:33:54.318+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:54.321+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:54.321+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 899ad522-c92d-4e4a-87ad-9087c7c9aa77
2021-01-13T15:33:54.342+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: b20817cd-c4eb-4984-80b5-08dcb4ab9bf2
2021-01-13T15:33:54.359+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:54.369+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:54.369+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:54.371+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: eedf9bad-f6b2-4ad1-9a5b-a8f012a3e84c
2021-01-13T15:33:54.401+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:54.401+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:54.403+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:54.413+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:54.413+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:54.414+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: f7cd5218-63d6-4d02-a03c-360f1cdf3929
2021-01-13T15:33:54.435+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:54.445+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:54.446+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:54.447+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: a8761ba3-dc99-4754-adcb-b60ff8910f1c
2021-01-13T15:33:54.476+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:54.476+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:54.477+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:54.487+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:54.487+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:54.499+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:54.499+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:54.511+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:54.511+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:53,647 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:53,647 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:53,647 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpi3jxsvum
2021-01-13 15:33:53,648 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:53,648 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:53,648 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:53,648 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:53,659 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=18152 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpi3jxsvum
2021-01-13 15:33:53,659 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:53,660 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:53,660 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:18152
2021-01-13 15:33:54,266 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:54,267 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:18152
2021-01-13 15:33:54,277 DEBUG pytest_server_fixtures.base2 waited 0:00:00.617156 for server to start successfully
2021-01-13 15:33:54,277 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:54,278 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:54,518 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:54,520 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpi3jxsvum
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=18152 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpi3jxsvum
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:18152
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:18152
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.617156 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:54.530+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:54.531+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:33:55.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:54,547 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:54,555 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:33:54,567 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:56,678 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27752 (total_procs_to_kill=1)
2021-01-13 15:33:56,678 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:56,679 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:56,683 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:56,683 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:56,683 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:56,683 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpi3jxsvum
2021-01-13 15:33:56,683 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:56,683 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27752 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpi3jxsvum
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m______ test_restore_version_non_existent_version[FwPointersCfg.DISABLED] _______[0m

library = <VersionStore at 0x7f84e40995c0>
    <ArcticLibrary at 0x7f84e4099dd8, arctic_test.TEST>
        <Arctic at 0x7f84e4084080, connected to MongoClient(host=['127.67.249.105:4056'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_non_existent_version(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
    
                with pytest.raises(NoDataFoundException):
                    library.restore_version(symbol, as_of=3)
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1382: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:56.714+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:56.716+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27787 port=4056 dbpath=/tmp/tmpu5vq1xq1 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:56.716+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:56.716+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:56.716+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:56.716+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:56.716+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:56.716+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:56.716+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:56.716+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:56.716+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:56.716+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 4056, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpu5vq1xq1", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:56.716+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:56.716+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:56.716+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:56.716+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:57.212+0000 I STORAGE  [initandlisten] WiredTiger message [1610552037:212244][27787:0x7fc4343cca80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:57.223+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:57.245+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:57.245+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:57.245+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:57.245+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:57.246+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: c05ba5bc-3f49-4306-bfd7-0118ae874de0
2021-01-13T15:33:57.262+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:57.262+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:57.262+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:57.263+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:57.263+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: ee3ff04f-8549-43e5-9baf-a936f0deef12
2021-01-13T15:33:57.282+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:57.282+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpu5vq1xq1/diagnostic.data'
2021-01-13T15:33:57.283+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:57.283+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: d7c4d542-6b2e-472f-bc2c-40a6cabcbfb7
2021-01-13T15:33:57.284+0000 I NETWORK  [initandlisten] waiting for connections on port 4056
2021-01-13T15:33:57.310+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:36874 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:57.311+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:57.311+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:57.312+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:36876 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:57.312+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:57.312+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:57.315+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:36878 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:57.317+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:36880 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:57.320+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:57.320+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: d6ac8b5c-7491-4d03-895f-26b09883e14c
2021-01-13T15:33:57.346+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:57.346+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:57.346+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:57.346+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-571733488663602068
2021-01-13T15:33:57.346+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:57.349+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:57.349+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 97f0208f-f51e-490e-87c2-fe47629aa573
2021-01-13T15:33:57.368+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: d260f86e-3d11-4619-89d6-6824e11ab994
2021-01-13T15:33:57.389+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:57.399+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:57.399+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:57.400+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 7002af94-afde-4901-951c-ac1c8b30abe0
2021-01-13T15:33:57.436+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:57.436+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:57.437+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:57.448+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:57.448+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:57.449+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 98b51317-e01e-4338-959a-3160f425ae17
2021-01-13T15:33:57.469+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:57.480+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:57.480+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:57.481+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: cd4581b1-1f44-4641-92bc-da64489860cb
2021-01-13T15:33:57.511+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:57.511+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:57.512+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:57.523+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:57.523+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:57.535+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:57.535+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:57.547+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:57.547+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:56,687 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:56,687 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:56,687 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpu5vq1xq1
2021-01-13 15:33:56,687 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:56,687 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:56,687 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:56,688 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:56,699 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=4056 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpu5vq1xq1
2021-01-13 15:33:56,699 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:56,700 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:56,700 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:4056
2021-01-13 15:33:57,306 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:57,307 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:4056
2021-01-13 15:33:57,315 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615560 for server to start successfully
2021-01-13 15:33:57,316 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:57,316 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:57,554 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:57,556 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpu5vq1xq1
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=4056 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpu5vq1xq1
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:4056
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:4056
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615560 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:57.565+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:57.566+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:57,583 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:57,689 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27787 (total_procs_to_kill=1)
2021-01-13 15:33:57,689 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:57,689 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:57,693 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:57,693 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:57,693 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:57,694 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpu5vq1xq1
2021-01-13 15:33:57,694 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:57,694 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27787 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpu5vq1xq1
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_______ test_restore_version_non_existent_version[FwPointersCfg.HYBRID] ________[0m

library = <VersionStore at 0x7f84e407e8d0>
    <ArcticLibrary at 0x7f84e407e160, arctic_test.TEST>
        <Arctic at 0x7f84e407ec18, connected to MongoClient(host=['127.67.249.105:30905'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_non_existent_version(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
    
                with pytest.raises(NoDataFoundException):
                    library.restore_version(symbol, as_of=3)
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1382: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:57.725+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:57.727+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27822 port=30905 dbpath=/tmp/tmpw338a42l 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:57.727+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:57.727+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:57.727+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:57.727+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:57.727+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:57.727+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:57.727+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:57.727+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:57.727+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:57.727+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 30905, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpw338a42l", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:57.728+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:57.728+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:57.728+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:57.728+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:58.226+0000 I STORAGE  [initandlisten] WiredTiger message [1610552038:226832][27822:0x7fc9f7c58a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:58.240+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:58.262+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:58.262+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:58.262+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:58.262+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:58.262+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 99df3828-96ea-4ed4-a757-79f621879272
2021-01-13T15:33:58.282+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:58.282+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:58.282+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:58.282+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:58.282+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 29e3662d-7b1d-4ab0-9eec-d3183e37812d
2021-01-13T15:33:58.301+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:58.301+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpw338a42l/diagnostic.data'
2021-01-13T15:33:58.302+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:58.303+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 150e0857-f269-4db2-8e07-5f0d456d9fc0
2021-01-13T15:33:58.303+0000 I NETWORK  [initandlisten] waiting for connections on port 30905
2021-01-13T15:33:58.322+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:52976 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:58.323+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:52978 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:58.326+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:52980 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:58.329+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:52982 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:58.333+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:58.333+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:58.333+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:58.333+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-5884182067600172470
2021-01-13T15:33:58.333+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:58.334+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:33:58.336+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:58.336+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 526895f9-d89c-49bc-86f7-0222f6e9ec64
2021-01-13T15:33:58.365+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:58.365+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:58.366+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:58.366+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-5884182067600172470
2021-01-13T15:33:58.366+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:58.368+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:58.368+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 9a864414-672e-49b8-9101-ac73e19abd84
2021-01-13T15:33:58.390+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 3d1bc0a0-b099-4f96-a42c-c602a20b9071
2021-01-13T15:33:58.408+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:58.419+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:58.419+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:58.420+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 9845fa26-e48f-43db-9d34-458b6549d6d4
2021-01-13T15:33:58.448+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:58.448+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:58.450+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:58.460+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:58.460+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:58.461+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 9c6ba82e-275e-404e-99f1-49f06d67ee5e
2021-01-13T15:33:58.479+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:58.488+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:58.488+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:58.489+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: f850ab5b-322d-43eb-a221-d8ff01df60de
2021-01-13T15:33:58.518+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:58.518+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:58.519+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:58.528+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:58.528+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:58.540+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:58.540+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:58.553+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:58.553+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:57,697 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:57,697 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:57,698 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpw338a42l
2021-01-13 15:33:57,698 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:57,698 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:57,698 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:57,698 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:57,710 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=30905 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpw338a42l
2021-01-13 15:33:57,710 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:57,711 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:57,711 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:30905
2021-01-13 15:33:58,317 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:58,318 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:30905
2021-01-13 15:33:58,327 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616291 for server to start successfully
2021-01-13 15:33:58,327 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:58,328 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:58,560 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:58,562 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpw338a42l
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=30905 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpw338a42l
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:30905
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:30905
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616291 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:58.570+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:58.571+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:58,589 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:58,832 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27822 (total_procs_to_kill=1)
2021-01-13 15:33:58,832 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:58,833 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:58,836 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:58,837 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:58,837 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:58,837 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpw338a42l
2021-01-13 15:33:58,837 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:58,837 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27822 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpw338a42l
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_______ test_restore_version_non_existent_version[FwPointersCfg.ENABLED] _______[0m

library = <VersionStore at 0x7f84c439b2b0>
    <ArcticLibrary at 0x7f84c439ba58, arctic_test.TEST>
        <Arctic at 0x7f84e410fe10, connected to MongoClient(host=['127.67.249.105:16334'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_non_existent_version(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
    
                with pytest.raises(NoDataFoundException):
                    library.restore_version(symbol, as_of=3)
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1382: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:58.867+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:58.869+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27857 port=16334 dbpath=/tmp/tmpav5kic8p 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:58.870+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:58.870+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:58.870+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:58.870+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:58.870+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:58.870+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:58.870+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:58.870+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:58.870+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:58.870+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 16334, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpav5kic8p", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:58.870+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:58.870+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:58.870+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:58.870+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:33:59.369+0000 I STORAGE  [initandlisten] WiredTiger message [1610552039:369311][27857:0x7febd9f09a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:33:59.382+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:33:59.405+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:59.405+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:33:59.405+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:33:59.405+0000 I CONTROL  [initandlisten] 
2021-01-13T15:33:59.405+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 6ba5f9fe-63fa-4684-ad25-22ab2a6e202c
2021-01-13T15:33:59.424+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:33:59.424+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:33:59.424+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:33:59.424+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:33:59.425+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: b3782966-f67f-4af1-a8ab-87395aa81cc2
2021-01-13T15:33:59.442+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:33:59.442+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpav5kic8p/diagnostic.data'
2021-01-13T15:33:59.444+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:33:59.444+0000 I NETWORK  [initandlisten] waiting for connections on port 16334
2021-01-13T15:33:59.444+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:33:59.444+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 188a13f3-7f89-45d7-8014-794678c45e46
2021-01-13T15:33:59.463+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:48186 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:59.465+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:48188 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:59.468+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:48190 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:59.471+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:48192 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:33:59.474+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:33:59.474+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:59.474+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:59.474+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-7256282731467240281
2021-01-13T15:33:59.474+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:59.477+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:33:59.477+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 3168f64c-ec42-4c33-91bf-ebd2bb4e4f77
2021-01-13T15:33:59.508+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:33:59.508+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:33:59.508+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:33:59.508+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-7256282731467240281
2021-01-13T15:33:59.508+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:59.510+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:33:59.510+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 6ac08241-cfe7-4839-995e-031eed08654a
2021-01-13T15:33:59.528+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 1a854515-23b5-4c23-a3ed-36ccafd52c24
2021-01-13T15:33:59.546+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:33:59.557+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:33:59.557+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:59.558+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: bb79a612-0e3b-4f52-aad5-65dd7ad69a99
2021-01-13T15:33:59.588+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:59.588+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:59.589+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:33:59.599+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:33:59.599+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:59.601+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: d8ad6f24-f452-497e-8cf1-baf7b809a9b5
2021-01-13T15:33:59.621+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:33:59.632+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:33:59.632+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:59.633+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 9550b670-9347-4b5d-8cd2-3906c5a6c42a
2021-01-13T15:33:59.660+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:59.661+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:59.662+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:33:59.671+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:59.671+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:59.683+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:59.684+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:33:59.695+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:33:59.695+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:58,840 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:58,840 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:58,840 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpav5kic8p
2021-01-13 15:33:58,840 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:58,841 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:58,841 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:58,841 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:58,852 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=16334 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpav5kic8p
2021-01-13 15:33:58,852 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:58,853 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:58,853 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:16334
2021-01-13 15:33:59,459 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:33:59,460 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:16334
2021-01-13 15:33:59,469 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615697 for server to start successfully
2021-01-13 15:33:59,469 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:33:59,469 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:33:59,703 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:33:59,705 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpav5kic8p
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=16334 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpav5kic8p
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:16334
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:16334
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615697 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:33:59.713+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:33:59.714+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:33:59,731 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:33:59,832 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27857 (total_procs_to_kill=1)
2021-01-13 15:33:59,832 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:33:59,833 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:33:59,837 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:33:59,837 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:59,837 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:59,838 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpav5kic8p
2021-01-13 15:33:59,838 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:59,838 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27857 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpav5kic8p
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m___ test_restore_version_which_updated_only_metadata[FwPointersCfg.DISABLED] ___[0m

library = <VersionStore at 0x7f84e4115fd0>
    <ArcticLibrary at 0x7f84e4115710, arctic_test.TEST>
        <Arctic at 0x7f84e410fe48, connected to MongoClient(host=['127.67.249.105:2578'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_which_updated_only_metadata(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
                library.write(symbol, data=mydf_b)  # creates version 3
    
                restore_item = library.restore_version(symbol, as_of=2)  # creates version 4
                assert restore_item.version == 4
                assert restore_item.metadata == {'field_b': 1}
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1403: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:33:59.868+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:33:59.870+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27892 port=2578 dbpath=/tmp/tmply1t0p_i 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:33:59.870+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:33:59.870+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:33:59.870+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:33:59.870+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:33:59.870+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:33:59.870+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:33:59.870+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:33:59.870+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:33:59.870+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:33:59.870+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 2578, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmply1t0p_i", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:33:59.870+0000 I STORAGE  [initandlisten] 
2021-01-13T15:33:59.870+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:33:59.870+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:33:59.870+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:00.364+0000 I STORAGE  [initandlisten] WiredTiger message [1610552040:364254][27892:0x7feccb051a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:00.376+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:00.400+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:00.400+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:00.400+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:00.400+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:00.401+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 6c815a6f-7acc-40a2-8e8e-21cd6c6dc13a
2021-01-13T15:34:00.420+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:00.421+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:00.421+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:00.421+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:00.421+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: c86bb73e-62dc-4c7d-a77f-7627b4dd5ada
2021-01-13T15:34:00.439+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:00.440+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmply1t0p_i/diagnostic.data'
2021-01-13T15:34:00.441+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:00.441+0000 I NETWORK  [initandlisten] waiting for connections on port 2578
2021-01-13T15:34:00.441+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:34:00.441+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: cbb5ae25-283e-4cb7-852e-35244b931328
2021-01-13T15:34:00.463+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:39256 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:00.464+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:39258 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:00.468+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:39260 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:00.468+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:00.468+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:00.469+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:00.471+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:39262 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:00.475+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:00.475+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: b7d17ff0-0aea-4b3e-8137-ad47e8148666
2021-01-13T15:34:00.509+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:00.509+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:00.509+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:00.509+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-6625332400730661750
2021-01-13T15:34:00.509+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:00.512+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:00.512+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 8ba4701c-a4ca-419a-95be-8e414d3725bd
2021-01-13T15:34:00.532+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 4184c95a-0d84-4c1e-aea7-f84252519218
2021-01-13T15:34:00.549+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:00.559+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:00.559+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:00.560+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: b4e14dbf-a957-414b-90a0-16b6dd6da24c
2021-01-13T15:34:00.589+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:00.589+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:00.591+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:00.600+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:00.600+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:00.601+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 5ab510d7-5274-4581-a331-27a190bcde34
2021-01-13T15:34:00.622+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:00.632+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:00.632+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:00.633+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 6bdca4fd-30e6-4a6f-b5d6-e300cba9bfb4
2021-01-13T15:34:00.663+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:00.663+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:00.664+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:00.674+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:00.674+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:00.685+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:00.685+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:00.697+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:00.697+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:33:59,841 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:59,841 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:59,841 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmply1t0p_i
2021-01-13 15:33:59,841 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:33:59,841 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:33:59,841 DEBUG pytest_shutil.workspace 
2021-01-13 15:33:59,842 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:33:59,852 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=2578 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmply1t0p_i
2021-01-13 15:33:59,853 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:33:59,853 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:33:59,854 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:2578
2021-01-13 15:34:00,459 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:00,460 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:2578
2021-01-13 15:34:00,469 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615872 for server to start successfully
2021-01-13 15:34:00,470 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:00,470 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:00,705 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:00,707 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmply1t0p_i
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=2578 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmply1t0p_i
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:2578
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:2578
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615872 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:00.716+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:00.717+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:00,734 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:00,739 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:34:00,746 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:00,760 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:00,860 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27892 (total_procs_to_kill=1)
2021-01-13 15:34:00,860 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:00,861 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:00,865 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:00,865 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:00,865 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:00,865 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmply1t0p_i
2021-01-13 15:34:00,865 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:00,865 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27892 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmply1t0p_i
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m____ test_restore_version_which_updated_only_metadata[FwPointersCfg.HYBRID] ____[0m

library = <VersionStore at 0x7f84e4094cc0>
    <ArcticLibrary at 0x7f84e4094fd0, arctic_test.TEST>
        <Arctic at 0x7f84e70ac390, connected to MongoClient(host=['127.67.249.105:9795'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_which_updated_only_metadata(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
                library.write(symbol, data=mydf_b)  # creates version 3
    
                restore_item = library.restore_version(symbol, as_of=2)  # creates version 4
                assert restore_item.version == 4
                assert restore_item.metadata == {'field_b': 1}
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1403: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:00.895+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:00.898+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27927 port=9795 dbpath=/tmp/tmpx7dzypof 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:00.898+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:00.898+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:00.898+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:00.898+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:00.898+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:00.898+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:00.898+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:00.898+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:00.898+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:00.898+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 9795, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpx7dzypof", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:00.898+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:00.898+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:00.898+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:00.898+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:01.392+0000 I STORAGE  [initandlisten] WiredTiger message [1610552041:392971][27927:0x7fdc45140a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:01.406+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:01.427+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:01.427+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:01.427+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:01.427+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:01.428+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 11919861-3e2b-4550-af46-324fe257cca4
2021-01-13T15:34:01.448+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:01.448+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:01.448+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:01.448+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:01.448+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 4ee02390-c4b4-4f7c-89c6-4258180936c3
2021-01-13T15:34:01.466+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:01.466+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpx7dzypof/diagnostic.data'
2021-01-13T15:34:01.467+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:01.467+0000 I NETWORK  [initandlisten] waiting for connections on port 9795
2021-01-13T15:34:01.468+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:34:01.468+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 1d4ff913-c9dc-4230-b4fa-9f74cbfd6ad2
2021-01-13T15:34:01.491+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:58420 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:01.492+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:58422 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:01.496+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:01.496+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:01.496+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:01.498+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:58424 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:01.499+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:58426 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:01.502+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:01.502+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 7f9cf756-65fb-4718-8a47-01bc527a0047
2021-01-13T15:34:01.537+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:01.537+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:01.537+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:01.537+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--533434572551972108
2021-01-13T15:34:01.537+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:01.540+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:01.540+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 21d694c0-2de7-4b98-b839-36a785f7d279
2021-01-13T15:34:01.558+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 75046935-9e3e-4fa1-8cd6-3cfb750baa80
2021-01-13T15:34:01.580+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:01.590+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:01.590+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:01.591+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 13981d94-813c-41ac-968d-716697e0fec2
2021-01-13T15:34:01.621+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:01.622+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:01.623+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:01.631+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:01.631+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:01.632+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 0e1c43ef-d95c-411c-adad-598baba4a674
2021-01-13T15:34:01.651+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:01.660+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:01.660+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:01.661+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 955588b1-4454-4dc2-8b42-e8aacb10f676
2021-01-13T15:34:01.687+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:01.687+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:01.688+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:01.697+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:01.698+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:01.709+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:01.709+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:01.719+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:01.719+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:00,868 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:00,869 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:00,869 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpx7dzypof
2021-01-13 15:34:00,869 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:00,869 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:00,869 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:00,869 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:00,880 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=9795 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpx7dzypof
2021-01-13 15:34:00,881 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:00,881 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:00,882 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:9795
2021-01-13 15:34:01,487 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:01,488 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:9795
2021-01-13 15:34:01,496 DEBUG pytest_server_fixtures.base2 waited 0:00:00.614089 for server to start successfully
2021-01-13 15:34:01,496 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:01,496 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:01,727 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:01,729 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpx7dzypof
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=9795 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpx7dzypof
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:9795
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:9795
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.614089 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:01.738+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:01.739+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:01,757 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:01,762 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:34:01,770 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:01,785 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:01,883 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27927 (total_procs_to_kill=1)
2021-01-13 15:34:01,884 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:01,884 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:01,888 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:01,888 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:01,888 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:01,889 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpx7dzypof
2021-01-13 15:34:01,889 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:01,889 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27927 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpx7dzypof
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m___ test_restore_version_which_updated_only_metadata[FwPointersCfg.ENABLED] ____[0m

library = <VersionStore at 0x7f84c469c4e0>
    <ArcticLibrary at 0x7f84c469ccf8, arctic_test.TEST>
        <Arctic at 0x7f84c469c5c0, connected to MongoClient(host=['127.67.249.105:26212'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_which_updated_only_metadata(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
                library.write(symbol, data=mydf_b)  # creates version 3
    
                restore_item = library.restore_version(symbol, as_of=2)  # creates version 4
                assert restore_item.version == 4
                assert restore_item.metadata == {'field_b': 1}
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1403: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:01.919+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:01.921+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27962 port=26212 dbpath=/tmp/tmpdlbektnk 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:01.921+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:01.921+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:01.921+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:01.921+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:01.921+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:01.921+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:01.921+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:01.921+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:01.921+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:01.921+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 26212, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpdlbektnk", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:01.921+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:01.921+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:01.921+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:01.921+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:02.417+0000 I STORAGE  [initandlisten] WiredTiger message [1610552042:417370][27962:0x7efe57e20a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:02.429+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:02.454+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:02.454+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:02.454+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:02.454+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:02.454+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 406deeda-edb7-4a6e-a90e-4a0067fc7b0f
2021-01-13T15:34:02.473+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:02.473+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:02.473+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:02.473+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:02.473+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 7418ed73-410f-4142-9735-a29324392a7d
2021-01-13T15:34:02.492+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:02.492+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpdlbektnk/diagnostic.data'
2021-01-13T15:34:02.493+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:02.493+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 7259d4e3-363a-4bb4-b171-d90d7669165a
2021-01-13T15:34:02.494+0000 I NETWORK  [initandlisten] waiting for connections on port 26212
2021-01-13T15:34:02.514+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:49934 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:02.516+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:49936 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:02.519+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:49938 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:02.520+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:02.520+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:02.520+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:02.522+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:02.522+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:49940 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:02.526+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:02.526+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: eb5d7ff1-4d08-4c6d-93fb-8fac54ea1bc9
2021-01-13T15:34:02.562+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:02.562+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:02.562+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:02.562+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-1418455909810181834
2021-01-13T15:34:02.562+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:02.565+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:02.565+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 112611a9-4d4f-4a08-844c-7709260f1e1a
2021-01-13T15:34:02.586+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: b8088ebe-252b-4d2b-8ea6-59ac11222388
2021-01-13T15:34:02.604+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:02.613+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:02.614+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:02.615+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: d21665ad-9b6a-4297-beae-85109a6cac0d
2021-01-13T15:34:02.644+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:02.644+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:02.645+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:02.654+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:02.654+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:02.655+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 5fc468b6-a328-40d0-aceb-6ecc403afa8a
2021-01-13T15:34:02.676+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:02.687+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:02.687+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:02.688+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 1d838cb9-15f3-4518-8be6-7a093b12cc49
2021-01-13T15:34:02.719+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:02.719+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:02.720+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:02.730+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:02.730+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:02.740+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:02.741+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:02.752+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:02.752+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:01,892 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:01,892 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:01,893 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpdlbektnk
2021-01-13 15:34:01,893 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:01,893 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:01,893 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:01,893 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:01,904 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=26212 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpdlbektnk
2021-01-13 15:34:01,904 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:01,905 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:01,905 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:26212
2021-01-13 15:34:02,511 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:02,512 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:26212
2021-01-13 15:34:02,520 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615445 for server to start successfully
2021-01-13 15:34:02,521 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:02,521 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:02,759 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:02,761 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpdlbektnk
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=26212 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpdlbektnk
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:26212
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:26212
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615445 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:02.904+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:02.904+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:02,900 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:02,900 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:02,900 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:02,900 DEBUG pytest_server_fixtures.base2 Server is already killed, skipping
2021-01-13 15:34:02,921 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:02,926 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:34:02,933 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:02,945 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:82 Server is already killed, skipping
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:82 Server is already killed, skipping
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:82 Server is already killed, skipping
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:82 Server is already killed, skipping
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stdout teardown ---------------------------
2021-01-13T15:34:03.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:03,047 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27962 (total_procs_to_kill=1)
2021-01-13 15:34:03,047 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:03,048 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:03,052 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:03,052 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:03,052 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:03,052 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpdlbektnk
2021-01-13 15:34:03,052 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:03,052 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27962 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpdlbektnk
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m__________ test_restore_version_then_snapshot[FwPointersCfg.DISABLED] __________[0m

library = <VersionStore at 0x7f84c42fec88>
    <ArcticLibrary at 0x7f84c42fef60, arctic_test.TEST>
        <Arctic at 0x7f84e73b4f60, connected to MongoClient(host=['127.67.249.105:31372'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_then_snapshot(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
    
                restore_item = library.restore_version(symbol, as_of=1)  # creates version 3
                assert restore_item.metadata == {'field_a': 1}
                assert restore_item.version == 3
    
                library.snapshot('SNAP_1')
                library.write(symbol, data=mydf_b)  # creates version 3
    
                item = library.read(symbol, as_of='SNAP_1')
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1426: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:03.082+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:03.084+0000 I CONTROL  [initandlisten] MongoDB starting : pid=27997 port=31372 dbpath=/tmp/tmpu60wqgmd 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:03.084+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:03.084+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:03.084+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:03.084+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:03.084+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:03.084+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:03.084+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:03.084+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:03.084+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:03.085+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 31372, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpu60wqgmd", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:03.085+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:03.085+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:03.085+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:03.085+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:03.579+0000 I STORAGE  [initandlisten] WiredTiger message [1610552043:579900][27997:0x7f0901df2a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:03.592+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:03.619+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:03.619+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:03.619+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:03.619+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:03.620+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 541a5b61-4c7a-4227-86a6-0fc8202841eb
2021-01-13T15:34:03.637+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:03.637+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:03.637+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:03.637+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:03.637+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: e6b2b2d7-0a03-4069-8c11-2beac65ebc2d
2021-01-13T15:34:03.655+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:03.655+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpu60wqgmd/diagnostic.data'
2021-01-13T15:34:03.656+0000 I NETWORK  [initandlisten] waiting for connections on port 31372
2021-01-13T15:34:03.656+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:03.656+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 77844f11-5390-4427-a83e-32022b7e1ef4
2021-01-13T15:34:03.677+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:35712 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:03.679+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:35714 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:03.683+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:35716 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:03.684+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:03.684+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:03.685+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:03.686+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:35718 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:03.687+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:03.689+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:03.689+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 22cd81b6-411d-443c-9dfa-904b1817ebd9
2021-01-13T15:34:03.724+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:03.724+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:03.724+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:03.724+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--5225829704826033011
2021-01-13T15:34:03.724+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:03.726+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:03.726+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: a11216c7-2e6c-43fe-87b2-e12fac0a91f4
2021-01-13T15:34:03.744+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 402bffa4-a7d7-451b-bdc3-83ec99c85044
2021-01-13T15:34:03.760+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:03.769+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:03.769+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:03.770+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 8b131975-38ce-42b1-9691-aefe0d30617e
2021-01-13T15:34:03.799+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:03.800+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:03.801+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:03.812+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:03.812+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:03.813+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 8258ef00-d705-4abe-adbe-8ecf25daa97e
2021-01-13T15:34:03.832+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:03.843+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:03.843+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:03.844+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 78327943-40fc-490f-be74-9f6b11e1eb2c
2021-01-13T15:34:03.875+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:03.875+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:03.876+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:03.886+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:03.886+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:03.896+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:03.896+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:03.908+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:03.908+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:03,056 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:03,056 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:03,056 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpu60wqgmd
2021-01-13 15:34:03,056 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:03,056 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:03,056 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:03,057 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:03,067 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=31372 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpu60wqgmd
2021-01-13 15:34:03,067 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:03,068 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:03,068 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:31372
2021-01-13 15:34:03,674 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:03,674 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:31372
2021-01-13 15:34:03,683 DEBUG pytest_server_fixtures.base2 waited 0:00:00.614927 for server to start successfully
2021-01-13 15:34:03,683 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:03,684 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:03,915 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:03,917 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpu60wqgmd
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=31372 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpu60wqgmd
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:31372
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:31372
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.614927 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:03.927+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:03.927+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:03,944 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:03,949 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:34:03,963 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:03,973 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stdout teardown ---------------------------
2021-01-13T15:34:04.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:04,076 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 27997 (total_procs_to_kill=1)
2021-01-13 15:34:04,076 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:04,076 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:04,080 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:04,081 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:04,081 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:04,081 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpu60wqgmd
2021-01-13 15:34:04,081 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:04,081 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 27997 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpu60wqgmd
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m___________ test_restore_version_then_snapshot[FwPointersCfg.HYBRID] ___________[0m

library = <VersionStore at 0x7f84e41266a0>
    <ArcticLibrary at 0x7f84e41609e8, arctic_test.TEST>
        <Arctic at 0x7f84e40f3c88, connected to MongoClient(host=['127.67.249.105:23455'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_then_snapshot(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
    
                restore_item = library.restore_version(symbol, as_of=1)  # creates version 3
                assert restore_item.metadata == {'field_a': 1}
                assert restore_item.version == 3
    
                library.snapshot('SNAP_1')
                library.write(symbol, data=mydf_b)  # creates version 3
    
                item = library.read(symbol, as_of='SNAP_1')
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1426: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:04.111+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:04.113+0000 I CONTROL  [initandlisten] MongoDB starting : pid=28032 port=23455 dbpath=/tmp/tmpi1dnf3q2 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:04.113+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:04.113+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:04.113+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:04.113+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:04.113+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:04.113+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:04.113+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:04.113+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:04.113+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:04.113+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 23455, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpi1dnf3q2", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:04.113+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:04.113+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:04.113+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:04.113+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:04.611+0000 I STORAGE  [initandlisten] WiredTiger message [1610552044:611605][28032:0x7f84d1c49a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:04.623+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:04.646+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:04.646+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:04.646+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:04.646+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:04.646+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 4daf4b8a-4bba-44ad-b003-fdcb1d82c470
2021-01-13T15:34:04.664+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:04.664+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:04.664+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:04.664+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:04.664+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 8a658fa9-869b-4d67-827f-53f40fc9748d
2021-01-13T15:34:04.683+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:04.683+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpi1dnf3q2/diagnostic.data'
2021-01-13T15:34:04.684+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:04.685+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 4781d6f3-b8c4-4072-b953-b4e02122852e
2021-01-13T15:34:04.685+0000 I NETWORK  [initandlisten] waiting for connections on port 23455
2021-01-13T15:34:04.707+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:48660 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:04.709+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:48662 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:04.712+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:04.712+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:04.712+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:04.712+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-1768406407409019428
2021-01-13T15:34:04.712+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:04.713+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:04.713+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:48664 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:04.715+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:48666 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:04.719+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:04.719+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: e150feb9-4f51-4010-a35a-f2e736767ab6
2021-01-13T15:34:04.747+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:04.747+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:04.747+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:04.747+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-1768406407409019428
2021-01-13T15:34:04.747+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:04.749+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:04.749+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 6ce5ef1e-e383-4951-8da9-7974d07f92d7
2021-01-13T15:34:04.768+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 53914ef6-69b7-475d-81a6-4fcdae16f901
2021-01-13T15:34:04.789+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:04.801+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:04.801+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:04.802+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 151ab862-73d2-4d16-b67f-134d205fdc56
2021-01-13T15:34:04.830+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:04.830+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:04.831+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:04.842+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:04.843+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:04.844+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: e27878a9-a9ff-43b8-b33f-25e0ffbfbe77
2021-01-13T15:34:04.863+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:04.874+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:04.874+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:04.875+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 31fe24ea-f6cb-481b-8e34-cc6c175ed522
2021-01-13T15:34:04.907+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:04.907+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:04.908+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:04.917+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:04.917+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:04.926+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:04.926+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:04.936+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:04.936+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:04,085 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:04,085 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:04,085 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpi1dnf3q2
2021-01-13 15:34:04,085 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:04,085 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:04,085 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:04,086 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:04,096 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=23455 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpi1dnf3q2
2021-01-13 15:34:04,096 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:04,097 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:04,097 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:23455
2021-01-13 15:34:04,703 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:04,704 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:23455
2021-01-13 15:34:04,713 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616471 for server to start successfully
2021-01-13 15:34:04,714 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:04,714 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:04,943 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:04,945 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpi1dnf3q2
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=23455 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpi1dnf3q2
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:23455
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:23455
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616471 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:04.955+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:04.955+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:34:05.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:04,973 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:04,977 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:34:04,992 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:05,006 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:05,103 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 28032 (total_procs_to_kill=1)
2021-01-13 15:34:05,103 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:05,104 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:05,108 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:05,108 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:05,108 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:05,108 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpi1dnf3q2
2021-01-13 15:34:05,108 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:05,108 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 28032 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpi1dnf3q2
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m__________ test_restore_version_then_snapshot[FwPointersCfg.ENABLED] ___________[0m

library = <VersionStore at 0x7f84e4115d68>
    <ArcticLibrary at 0x7f84e4115940, arctic_test.TEST>
        <Arctic at 0x7f84e4115ba8, connected to MongoClient(host=['127.67.249.105:10604'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_then_snapshot(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            mydf_b = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
    
                restore_item = library.restore_version(symbol, as_of=1)  # creates version 3
                assert restore_item.metadata == {'field_a': 1}
                assert restore_item.version == 3
    
                library.snapshot('SNAP_1')
                library.write(symbol, data=mydf_b)  # creates version 3
    
                item = library.read(symbol, as_of='SNAP_1')
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1426: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:05.138+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:05.141+0000 I CONTROL  [initandlisten] MongoDB starting : pid=28067 port=10604 dbpath=/tmp/tmpkax15iu_ 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:05.141+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:05.141+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:05.141+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:05.141+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:05.141+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:05.141+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:05.141+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:05.141+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:05.141+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:05.141+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 10604, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpkax15iu_", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:05.141+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:05.141+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:05.141+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:05.141+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:05.641+0000 I STORAGE  [initandlisten] WiredTiger message [1610552045:641180][28067:0x7f76fb314a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:05.654+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:05.680+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:05.680+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:05.680+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:05.680+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:05.680+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 6d03f176-7350-40ca-afea-9fe95ac840c1
2021-01-13T15:34:05.699+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:05.699+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:05.699+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:05.699+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:05.699+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: ae23378c-688d-4095-b815-d7f0d46bad6e
2021-01-13T15:34:05.719+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:05.719+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpkax15iu_/diagnostic.data'
2021-01-13T15:34:05.720+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:05.720+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 47356498-03c6-470c-9a01-d9a9dc196fe8
2021-01-13T15:34:05.720+0000 I NETWORK  [initandlisten] waiting for connections on port 10604
2021-01-13T15:34:05.734+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:34468 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:05.735+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:34470 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:05.738+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:34472 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:05.741+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:34474 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:05.753+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:05.753+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:05.754+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:05.754+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-9009011024207188674
2021-01-13T15:34:05.754+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:05.754+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:05.757+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:05.757+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: adf2856c-2926-4d88-9ddf-177b368796ec
2021-01-13T15:34:05.787+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:05.787+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:05.787+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:05.788+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-9009011024207188674
2021-01-13T15:34:05.788+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:05.790+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:05.790+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 009108da-a00c-4093-9195-414fcb111bd1
2021-01-13T15:34:05.809+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: d538c244-ebd9-4132-9585-d47894f95657
2021-01-13T15:34:05.828+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:05.838+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:05.838+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:05.839+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: e5ed6cb7-f3e1-4a6d-9305-768c941d4476
2021-01-13T15:34:05.869+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:05.869+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:05.870+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:05.880+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:05.880+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:05.881+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: e83f4c36-0fed-4204-8936-6390e0a82c4c
2021-01-13T15:34:05.901+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:05.910+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:05.910+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:05.911+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: c98fda08-e26e-4ad9-ba02-58c584202bcb
2021-01-13T15:34:05.939+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:05.939+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:05.940+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:05.949+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:05.949+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:05.961+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:05.961+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:05.972+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:05.972+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:05,112 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:05,112 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:05,112 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpkax15iu_
2021-01-13 15:34:05,112 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:05,112 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:05,112 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:05,113 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:05,123 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=10604 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpkax15iu_
2021-01-13 15:34:05,124 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:05,124 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:05,125 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:10604
2021-01-13 15:34:05,730 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:05,730 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:10604
2021-01-13 15:34:05,739 DEBUG pytest_server_fixtures.base2 waited 0:00:00.614385 for server to start successfully
2021-01-13 15:34:05,740 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:05,740 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:05,979 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:05,981 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpkax15iu_
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=10604 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpkax15iu_
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:10604
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:10604
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.614385 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:05.991+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:05.991+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:34:06.003+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:06,009 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:06,014 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
2021-01-13 15:34:06,027 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:06,037 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:06,289 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 28067 (total_procs_to_kill=1)
2021-01-13 15:34:06,289 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:06,290 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:06,294 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:06,294 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:06,294 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:06,294 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpkax15iu_
2021-01-13 15:34:06,294 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:06,294 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 28067 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpkax15iu_
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m______ test_restore_version_latest_snapshot_noop[FwPointersCfg.DISABLED] _______[0m

library = <VersionStore at 0x7f84e40bfdd8>
    <ArcticLibrary at 0x7f84e40bf358, arctic_test.TEST>
        <Arctic at 0x7f84c478e438, connected to MongoClient(host=['127.67.249.105:11735'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_latest_snapshot_noop(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
                library.snapshot('SNAP_1')
    
                restore_item = library.restore_version(symbol, as_of='SNAP_1')  # does not create a new version
                assert restore_item.metadata == {'field_b': 1}
                assert restore_item.version == 2
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1446: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:06.325+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:06.327+0000 I CONTROL  [initandlisten] MongoDB starting : pid=28102 port=11735 dbpath=/tmp/tmp45k92k9j 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:06.327+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:06.327+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:06.327+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:06.327+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:06.327+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:06.327+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:06.327+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:06.327+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:06.327+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:06.327+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 11735, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp45k92k9j", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:06.327+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:06.327+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:06.327+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:06.327+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:06.828+0000 I STORAGE  [initandlisten] WiredTiger message [1610552046:828464][28102:0x7f719f538a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:06.841+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:06.865+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:06.865+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:06.865+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:06.865+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:06.865+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: abf5b2ed-de9a-4551-b26d-877cfb0340f8
2021-01-13T15:34:06.882+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:06.882+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:06.883+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:06.883+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:06.883+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: c2590840-d305-499e-a88a-a66774671a50
2021-01-13T15:34:06.906+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:06.906+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp45k92k9j/diagnostic.data'
2021-01-13T15:34:06.907+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:06.907+0000 I NETWORK  [initandlisten] waiting for connections on port 11735
2021-01-13T15:34:06.907+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:34:06.907+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 9a000d4c-6814-4f93-a40e-aa12abd29e4c
2021-01-13T15:34:06.920+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:48032 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:06.922+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:48034 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:06.925+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:48036 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:06.928+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:48038 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:06.943+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:06.943+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:06.943+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:06.943+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-8363157611029392712
2021-01-13T15:34:06.943+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:06.946+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:06.946+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: a8223d7c-e9ef-4237-b853-5088d7c5fd42
2021-01-13T15:34:06.976+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:06.976+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:06.976+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:06.976+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-8363157611029392712
2021-01-13T15:34:06.976+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:06.978+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:06.979+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 74fa62a1-bb1f-4a2a-8039-a6cfa9a9efdd
2021-01-13T15:34:06.999+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 08f6e436-a941-42a6-879e-3889a557b1be
2021-01-13T15:34:07.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:34:07.017+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:07.027+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:07.027+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:07.028+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: dd5cfc16-f515-4543-95e5-94333408a75a
2021-01-13T15:34:07.058+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:07.058+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:07.059+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:07.068+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:07.068+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:07.070+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 8e5a0efd-ac47-439d-8b67-b3b268efa2cc
2021-01-13T15:34:07.088+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:07.098+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:07.098+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:07.100+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: ba9483a8-c5ce-4969-b434-19090158c2b4
2021-01-13T15:34:07.128+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:07.128+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:07.129+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:07.139+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:07.139+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:07.149+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:07.149+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:07.160+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:07.160+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:06,297 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:06,298 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:06,298 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp45k92k9j
2021-01-13 15:34:06,298 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:06,298 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:06,298 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:06,298 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:06,309 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=11735 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp45k92k9j
2021-01-13 15:34:06,310 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:06,310 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:06,311 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:11735
2021-01-13 15:34:06,917 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:06,917 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:11735
2021-01-13 15:34:06,925 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615035 for server to start successfully
2021-01-13 15:34:06,926 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:06,926 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:07,168 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:07,170 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp45k92k9j
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=11735 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp45k92k9j
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:11735
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:11735
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615035 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:07.179+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:07.179+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:07,196 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:07,201 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:07,310 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 28102 (total_procs_to_kill=1)
2021-01-13 15:34:07,311 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:07,311 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:07,315 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:07,315 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:07,315 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:07,316 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp45k92k9j
2021-01-13 15:34:07,316 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:07,316 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 28102 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp45k92k9j
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_______ test_restore_version_latest_snapshot_noop[FwPointersCfg.HYBRID] ________[0m

library = <VersionStore at 0x7f84e416b550>
    <ArcticLibrary at 0x7f84e416bd68, arctic_test.TEST>
        <Arctic at 0x7f84e416ba90, connected to MongoClient(host=['127.67.249.105:5994'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_latest_snapshot_noop(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
                library.snapshot('SNAP_1')
    
                restore_item = library.restore_version(symbol, as_of='SNAP_1')  # does not create a new version
                assert restore_item.metadata == {'field_b': 1}
                assert restore_item.version == 2
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1446: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:07.346+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:07.349+0000 I CONTROL  [initandlisten] MongoDB starting : pid=28137 port=5994 dbpath=/tmp/tmpj5ee9dth 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:07.349+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:07.349+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:07.349+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:07.349+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:07.349+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:07.349+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:07.349+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:07.349+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:07.349+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:07.349+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 5994, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpj5ee9dth", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:07.349+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:07.349+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:07.349+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:07.349+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:07.843+0000 I STORAGE  [initandlisten] WiredTiger message [1610552047:843341][28137:0x7ff0e5b10a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:07.855+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:07.875+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:07.875+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:07.875+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:07.875+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:07.876+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 4e3176f2-799a-4fd3-97ce-a498bd56a998
2021-01-13T15:34:07.893+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:07.893+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:07.893+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:07.893+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:07.893+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: b8c83068-b747-4e3c-959c-7d7aca925577
2021-01-13T15:34:07.912+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:07.912+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpj5ee9dth/diagnostic.data'
2021-01-13T15:34:07.913+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:07.913+0000 I NETWORK  [initandlisten] waiting for connections on port 5994
2021-01-13T15:34:07.913+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:34:07.913+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: d8f84f79-dfcc-4aad-94e7-9e175cb486a5
2021-01-13T15:34:07.942+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:43702 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:07.942+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:07.942+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:07.943+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:07.943+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:43704 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:07.947+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:43706 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:07.949+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:43708 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:07.953+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:07.953+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 436ef7d0-e631-4db2-b4e1-db5ae2229573
2021-01-13T15:34:07.984+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:07.984+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:07.984+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:07.984+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--3772570231741763146
2021-01-13T15:34:07.984+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:07.986+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:07.986+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: bc8b98aa-218b-4c01-8018-b8834525f33b
2021-01-13T15:34:08.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:34:08.008+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 67a0ee6d-5121-4e3c-8a99-9044943890bf
2021-01-13T15:34:08.026+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:08.036+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:08.036+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:08.037+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 34eba254-bdbd-4008-b4b1-0df7e2180e3d
2021-01-13T15:34:08.068+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:08.068+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:08.069+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:08.084+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:08.084+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:08.085+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 3f39fe16-578d-4e54-b58b-04de65c73d80
2021-01-13T15:34:08.105+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:08.115+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:08.115+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:08.116+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 457cb3c1-3c34-4755-b2dd-0cda4c9f5f49
2021-01-13T15:34:08.143+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:08.143+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:08.144+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:08.154+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:08.154+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:08.165+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:08.165+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:08.177+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:08.177+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:07,319 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:07,319 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:07,320 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpj5ee9dth
2021-01-13 15:34:07,320 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:07,320 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:07,320 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:07,320 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:07,331 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=5994 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpj5ee9dth
2021-01-13 15:34:07,332 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:07,332 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:07,333 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:5994
2021-01-13 15:34:07,938 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:07,939 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:5994
2021-01-13 15:34:07,947 DEBUG pytest_server_fixtures.base2 waited 0:00:00.614660 for server to start successfully
2021-01-13 15:34:07,947 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:07,948 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:08,184 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:08,186 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpj5ee9dth
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=5994 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpj5ee9dth
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:5994
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:5994
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.614660 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:08.194+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:08.195+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:08,212 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:08,217 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:08,327 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 28137 (total_procs_to_kill=1)
2021-01-13 15:34:08,327 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:08,328 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:08,332 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:08,332 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:08,332 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:08,332 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpj5ee9dth
2021-01-13 15:34:08,332 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:08,332 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 28137 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpj5ee9dth
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_______ test_restore_version_latest_snapshot_noop[FwPointersCfg.ENABLED] _______[0m

library = <VersionStore at 0x7f84c42dc780>
    <ArcticLibrary at 0x7f84c42dca58, arctic_test.TEST>
        <Arctic at 0x7f84c42dc278, connected to MongoClient(host=['127.67.249.105:19136'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_latest_snapshot_noop(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
                library.snapshot('SNAP_1')
    
                restore_item = library.restore_version(symbol, as_of='SNAP_1')  # does not create a new version
                assert restore_item.metadata == {'field_b': 1}
                assert restore_item.version == 2
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1446: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:08.364+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:08.366+0000 I CONTROL  [initandlisten] MongoDB starting : pid=28172 port=19136 dbpath=/tmp/tmp3nssv6yf 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:08.366+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:08.366+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:08.366+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:08.366+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:08.366+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:08.366+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:08.366+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:08.366+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:08.366+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:08.366+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 19136, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp3nssv6yf", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:08.366+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:08.366+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:08.366+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:08.366+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:08.862+0000 I STORAGE  [initandlisten] WiredTiger message [1610552048:862141][28172:0x7fc9a8741a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:08.874+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:08.899+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:08.899+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:08.899+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:08.899+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:08.899+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 95079922-d4a1-4f42-a92f-6e1743033ae4
2021-01-13T15:34:08.916+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:08.916+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:08.916+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:08.916+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:08.916+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: d5b725ae-371f-4753-8379-a2663f0c29f0
2021-01-13T15:34:08.934+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:08.934+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp3nssv6yf/diagnostic.data'
2021-01-13T15:34:08.935+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:08.935+0000 I NETWORK  [initandlisten] waiting for connections on port 19136
2021-01-13T15:34:08.935+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 371e9e3c-7ec4-4361-b931-a2decc136e85
2021-01-13T15:34:08.935+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:34:08.959+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:48952 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:08.960+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:48954 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:08.963+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:08.963+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:08.963+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:08.963+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-8632957390896164201
2021-01-13T15:34:08.963+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:08.965+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:48956 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:08.967+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:48958 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:08.971+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:08.971+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: d903e488-5e9a-4497-a528-fefe482fd020
2021-01-13T15:34:08.998+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:08.998+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:08.998+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:08.998+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-8632957390896164201
2021-01-13T15:34:08.998+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:09.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:34:09.002+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:09.002+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 77ce7f4f-1a42-46bf-9817-aaedaf4177f2
2021-01-13T15:34:09.023+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 7e5a5304-0dcf-4f00-bb14-c45a05bc713a
2021-01-13T15:34:09.040+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:09.051+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:09.051+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:09.052+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 28c5e805-fef3-4aed-bbf5-4f4c17e555e9
2021-01-13T15:34:09.082+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:09.082+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:09.083+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:09.093+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:09.093+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:09.094+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 18d2d9b2-1f3e-4ed9-92a8-a25d2af93cdb
2021-01-13T15:34:09.113+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:09.123+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:09.123+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:09.124+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 88dd1573-9550-4197-8358-f3ad06c2d286
2021-01-13T15:34:09.151+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:09.151+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:09.152+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:09.161+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:09.161+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:09.173+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:09.173+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:09.186+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:09.186+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:08,336 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:08,336 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:08,336 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp3nssv6yf
2021-01-13 15:34:08,336 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:08,336 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:08,336 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:08,337 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:08,348 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=19136 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp3nssv6yf
2021-01-13 15:34:08,349 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:08,350 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:08,350 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:19136
2021-01-13 15:34:08,955 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:08,956 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:19136
2021-01-13 15:34:08,965 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615503 for server to start successfully
2021-01-13 15:34:08,965 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:08,966 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:09,193 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:09,195 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp3nssv6yf
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=19136 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp3nssv6yf
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:19136
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:19136
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615503 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:09.204+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:09.204+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:09,223 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:09,227 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:09,333 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 28172 (total_procs_to_kill=1)
2021-01-13 15:34:09,333 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:09,337 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:09,337 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:09,337 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:09,337 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:09,338 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp3nssv6yf
2021-01-13 15:34:09,338 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:09,338 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 28172 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp3nssv6yf
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_______ test_restore_version_latest_version_noop[FwPointersCfg.DISABLED] _______[0m

library = <VersionStore at 0x7f84c47204a8>
    <ArcticLibrary at 0x7f84c4720048, arctic_test.TEST>
        <Arctic at 0x7f84c42dcdd8, connected to MongoClient(host=['127.67.249.105:18202'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_latest_version_noop(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
    
                restore_item = library.restore_version(symbol, as_of=2)  # does not create a new version
                assert restore_item.metadata == {'field_b': 1}
                assert restore_item.version == 2
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1465: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:09.367+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:09.370+0000 I CONTROL  [initandlisten] MongoDB starting : pid=28207 port=18202 dbpath=/tmp/tmpl7vyh1u4 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:09.370+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:09.370+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:09.370+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:09.370+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:09.370+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:09.370+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:09.370+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:09.370+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:09.370+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:09.370+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 18202, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpl7vyh1u4", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:09.370+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:09.370+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:09.370+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:09.370+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:09.868+0000 I STORAGE  [initandlisten] WiredTiger message [1610552049:868055][28207:0x7f0db87a9a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:09.879+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:09.903+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:09.903+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:09.903+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:09.903+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:09.904+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 0eb7759b-b6ff-4e79-8186-b458a40e05f1
2021-01-13T15:34:09.922+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:09.922+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:09.922+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:09.922+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:09.922+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 8b68172c-4192-43d9-ac9e-50a31c8a0bc2
2021-01-13T15:34:09.941+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:09.941+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpl7vyh1u4/diagnostic.data'
2021-01-13T15:34:09.942+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:09.942+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: a140d8d3-e5a7-4689-a73c-db4f4f999771
2021-01-13T15:34:09.943+0000 I NETWORK  [initandlisten] waiting for connections on port 18202
2021-01-13T15:34:09.964+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:44368 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:09.965+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:44370 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:09.969+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:09.969+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:09.969+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:44372 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:09.969+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:09.969+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-7850273637045718712
2021-01-13T15:34:09.969+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:09.970+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:09.972+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:44374 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:09.975+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:09.975+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 5763d86c-57a1-4cdb-8843-6fd9a3e0c647
2021-01-13T15:34:10.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:34:10.003+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:10.003+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:10.003+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:10.003+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-7850273637045718712
2021-01-13T15:34:10.003+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:10.005+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:10.005+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 5f660e84-b98e-4b41-a92d-8e263276d405
2021-01-13T15:34:10.023+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 873aa26a-c910-4a79-9712-0450572945d8
2021-01-13T15:34:10.043+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:10.054+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:10.054+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:10.055+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 6df98485-2526-49ae-bd0a-76aa1d18c49a
2021-01-13T15:34:10.083+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:10.083+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:10.084+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:10.092+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:10.092+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:10.093+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 1039b0ea-5c53-4cf5-a476-0955bd381e1c
2021-01-13T15:34:10.112+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:10.121+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:10.122+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:10.123+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 1dd9c574-bf32-4cd9-9613-8d362078dec6
2021-01-13T15:34:10.151+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:10.151+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:10.152+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:10.161+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:10.161+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:10.171+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:10.171+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:10.184+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:10.184+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:09,341 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:09,341 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:09,341 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpl7vyh1u4
2021-01-13 15:34:09,341 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:09,341 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:09,341 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:09,342 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:09,352 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=18202 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpl7vyh1u4
2021-01-13 15:34:09,353 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:09,353 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:09,354 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:18202
2021-01-13 15:34:09,960 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:09,961 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:18202
2021-01-13 15:34:09,970 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616460 for server to start successfully
2021-01-13 15:34:09,971 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:09,971 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:10,192 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:10,194 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpl7vyh1u4
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=18202 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpl7vyh1u4
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:18202
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:18202
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616460 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:10.202+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:10.203+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:10,222 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:10,227 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:10,330 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 28207 (total_procs_to_kill=1)
2021-01-13 15:34:10,330 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:10,331 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:10,335 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:10,335 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:10,335 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:10,335 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpl7vyh1u4
2021-01-13 15:34:10,335 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:10,335 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 28207 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpl7vyh1u4
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m________ test_restore_version_latest_version_noop[FwPointersCfg.HYBRID] ________[0m

library = <VersionStore at 0x7f84c43cc6a0>
    <ArcticLibrary at 0x7f84c43cc780, arctic_test.TEST>
        <Arctic at 0x7f84e706aac8, connected to MongoClient(host=['127.67.249.105:24852'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_latest_version_noop(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
    
                restore_item = library.restore_version(symbol, as_of=2)  # does not create a new version
                assert restore_item.metadata == {'field_b': 1}
                assert restore_item.version == 2
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1465: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:10.365+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:10.367+0000 I CONTROL  [initandlisten] MongoDB starting : pid=28242 port=24852 dbpath=/tmp/tmp159z984d 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:10.367+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:10.367+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:10.367+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:10.367+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:10.367+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:10.368+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:10.368+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:10.368+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:10.368+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:10.368+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 24852, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp159z984d", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:10.368+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:10.368+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:10.368+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:10.368+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:10.865+0000 I STORAGE  [initandlisten] WiredTiger message [1610552050:865715][28242:0x7f4636953a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:10.878+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:10.903+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:10.903+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:10.903+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:10.903+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:10.903+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: d00dd95c-3630-4067-82bb-c42a1aa91cc7
2021-01-13T15:34:10.921+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:10.921+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:10.922+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:10.922+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:10.922+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 25b095f6-b40e-461c-a394-a8f1ab9b271a
2021-01-13T15:34:10.940+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:10.940+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp159z984d/diagnostic.data'
2021-01-13T15:34:10.942+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:10.942+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: c4e4974c-816d-42ef-9d2d-21bbf6a5eb1d
2021-01-13T15:34:10.942+0000 I NETWORK  [initandlisten] waiting for connections on port 24852
2021-01-13T15:34:10.962+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:43274 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:10.963+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:43276 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:10.967+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:43278 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:10.969+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:43280 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:10.973+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:10.973+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:10.973+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:10.973+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-7430337681178953973
2021-01-13T15:34:10.973+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:10.973+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:10.976+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:10.976+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: ac566205-2ed9-4df7-b5ef-8c42be522cbd
2021-01-13T15:34:11.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:34:11.008+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:11.008+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:11.008+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:11.008+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-7430337681178953973
2021-01-13T15:34:11.008+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:11.010+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:11.010+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 61aec034-03f1-4deb-a238-beddf8477e9d
2021-01-13T15:34:11.029+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 2fe1d015-f7c5-4ff2-9e09-ff35d3de09eb
2021-01-13T15:34:11.047+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:11.056+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:11.056+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:11.057+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: e483652d-dda9-4bc4-b9b2-d121a6a09f5f
2021-01-13T15:34:11.086+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:11.086+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:11.087+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:11.097+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:11.097+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:11.098+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 4d74141a-c439-48a9-b073-088f6ba75ac7
2021-01-13T15:34:11.120+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:11.130+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:11.130+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:11.131+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: db2bf33d-13f5-46f4-bc9c-6306ad3f2c6b
2021-01-13T15:34:11.159+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:11.159+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:11.160+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:11.170+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:11.170+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:11.182+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:11.182+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:11.194+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:11.194+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:10,338 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:10,339 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:10,339 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp159z984d
2021-01-13 15:34:10,339 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:10,339 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:10,339 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:10,339 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:10,350 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=24852 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp159z984d
2021-01-13 15:34:10,351 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:10,351 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:10,351 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:24852
2021-01-13 15:34:10,958 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:10,958 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:24852
2021-01-13 15:34:10,968 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616450 for server to start successfully
2021-01-13 15:34:10,968 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:10,969 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:11,202 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:11,204 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp159z984d
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=24852 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp159z984d
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:24852
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:24852
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616450 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:11.212+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:11.213+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:11,232 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:11,236 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:11,480 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 28242 (total_procs_to_kill=1)
2021-01-13 15:34:11,480 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:11,481 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:11,485 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:11,485 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:11,485 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:11,485 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp159z984d
2021-01-13 15:34:11,485 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:11,485 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 28242 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp159z984d
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_______ test_restore_version_latest_version_noop[FwPointersCfg.ENABLED] ________[0m

library = <VersionStore at 0x7f84c437d128>
    <ArcticLibrary at 0x7f84c437d5f8, arctic_test.TEST>
        <Arctic at 0x7f84c437d908, connected to MongoClient(host=['127.67.249.105:15776'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_latest_version_noop(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf_a = _rnd_df(10, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf_a, metadata={'field_a': 1})  # creates version 1
                library.write_metadata(symbol, metadata={'field_b': 1})  # creates version 2
    
                restore_item = library.restore_version(symbol, as_of=2)  # does not create a new version
                assert restore_item.metadata == {'field_b': 1}
                assert restore_item.version == 2
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf_a)
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1465: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:11.515+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:11.518+0000 I CONTROL  [initandlisten] MongoDB starting : pid=28277 port=15776 dbpath=/tmp/tmp3tj60raw 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:11.518+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:11.518+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:11.518+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:11.518+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:11.518+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:11.518+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:11.518+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:11.518+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:11.518+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:11.518+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 15776, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp3tj60raw", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:11.518+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:11.518+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:11.518+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:11.518+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:12.012+0000 I STORAGE  [initandlisten] WiredTiger message [1610552052:12283][28277:0x7f3188bc2a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:12.024+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:12.048+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:12.049+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:12.049+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:12.049+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:12.049+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 25d8051e-e907-49c2-8a7f-7a13919ef500
2021-01-13T15:34:12.068+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:12.068+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:12.068+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:12.068+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:12.068+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 8c00486c-108d-46ce-8d66-f39380be0c87
2021-01-13T15:34:12.086+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:12.086+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp3tj60raw/diagnostic.data'
2021-01-13T15:34:12.087+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:12.087+0000 I NETWORK  [initandlisten] waiting for connections on port 15776
2021-01-13T15:34:12.087+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:34:12.087+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 65d6f887-90cc-46fc-909c-b975ac48bd20
2021-01-13T15:34:12.112+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:51060 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:12.113+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:51062 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:12.116+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:12.116+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:12.117+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:12.118+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:51064 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:12.119+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:51066 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:12.122+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:12.122+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: bdadd849-4aac-4d7a-8eb0-e3a42e057f7d
2021-01-13T15:34:12.155+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:12.155+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:12.155+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:12.155+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-2254439201155534131
2021-01-13T15:34:12.155+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:12.157+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:12.157+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 797c69b2-1a3d-4000-a14d-ac988d16c995
2021-01-13T15:34:12.177+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 1e5321cc-fc72-4dd5-b05b-81b3171c11da
2021-01-13T15:34:12.198+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:12.208+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:12.208+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:12.209+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 55e59288-ad97-46e2-9482-074f0fbb4fab
2021-01-13T15:34:12.240+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:12.240+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:12.241+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:12.252+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:12.252+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:12.253+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: bf1f6f5a-b6b2-4b2c-9e2f-a40327c0358b
2021-01-13T15:34:12.272+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:12.282+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:12.282+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:12.283+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 2214d66a-06db-4597-b4a5-f830f2d83343
2021-01-13T15:34:12.311+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:12.311+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:12.312+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:12.323+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:12.323+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:12.334+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:12.334+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:12.345+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:12.346+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:11,488 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:11,488 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:11,489 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp3tj60raw
2021-01-13 15:34:11,489 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:11,489 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:11,489 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:11,489 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:11,500 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=15776 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp3tj60raw
2021-01-13 15:34:11,501 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:11,501 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:11,502 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:15776
2021-01-13 15:34:12,108 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:12,108 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:15776
2021-01-13 15:34:12,116 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615109 for server to start successfully
2021-01-13 15:34:12,117 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:12,117 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:12,353 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:12,355 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp3tj60raw
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=15776 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp3tj60raw
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:15776
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:15776
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615109 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:12.363+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:12.364+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:12,381 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:12,385 DEBUG arctic.store.version_store Finished updating versions with new metadata for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:717 Finished updating versions with new metadata for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:12,491 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 28277 (total_procs_to_kill=1)
2021-01-13 15:34:12,492 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:12,493 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:12,497 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:12,497 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:12,497 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:12,497 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp3tj60raw
2021-01-13 15:34:12,497 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:12,498 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 28277 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp3tj60raw
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m___ test_restore_version_snap_delete_symbol_restore[FwPointersCfg.DISABLED] ____[0m

library = <VersionStore at 0x7f84e73be2e8>
    <ArcticLibrary at 0x7f84f60be588, arctic_test.TEST>
        <Arctic at 0x7f84e4108908, connected to MongoClient(host=['127.67.249.105:8306'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_snap_delete_symbol_restore(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf = _rnd_df(20, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf[:10], metadata={'field_a': 1})  # creates version 1
                library.append(symbol, data=mydf[10:15])  # version 2
                library.snapshot('snapA')
    
                library.append(symbol, data=mydf[15:20])  # version 3
                library.delete(symbol)  # version 4
    
                restored_item = library.restore_version(symbol, as_of='snapA')  # version 5
                assert restored_item.metadata == {'field_a': 1}
                assert restored_item.version == 5
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf[:15])
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1488: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:12.528+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:12.530+0000 I CONTROL  [initandlisten] MongoDB starting : pid=28312 port=8306 dbpath=/tmp/tmptlcttmwc 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:12.530+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:12.530+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:12.530+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:12.530+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:12.530+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:12.530+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:12.530+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:12.530+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:12.530+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:12.530+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 8306, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmptlcttmwc", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:12.531+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:12.531+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:12.531+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:12.531+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:13.030+0000 I STORAGE  [initandlisten] WiredTiger message [1610552053:30276][28312:0x7ff9bbfdba80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:13.042+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:13.069+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:13.069+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:13.069+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:13.069+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:13.069+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 730db190-980f-4ba9-9b59-45680f1e849c
2021-01-13T15:34:13.088+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:13.088+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:13.088+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:13.088+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:13.088+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: ab350b1c-72e7-49fe-86d6-8433a7ea9bca
2021-01-13T15:34:13.105+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:13.105+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmptlcttmwc/diagnostic.data'
2021-01-13T15:34:13.106+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:13.106+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: f6c63786-9f72-4529-b85c-84b83e2764e1
2021-01-13T15:34:13.107+0000 I NETWORK  [initandlisten] waiting for connections on port 8306
2021-01-13T15:34:13.124+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:35818 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:13.126+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:35820 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:13.129+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:35822 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:13.132+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:35824 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:13.133+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:13.133+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:13.133+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:13.134+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:13.137+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:13.137+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 34432461-55e4-409f-9c82-842c1c7d54b7
2021-01-13T15:34:13.168+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:13.168+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:13.168+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:13.168+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-7855807294315687506
2021-01-13T15:34:13.168+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:13.170+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:13.171+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: a3253e53-bb21-408a-bc20-16f1f7de0267
2021-01-13T15:34:13.191+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 63912b1d-d4da-48d5-ab60-7395a0b11e54
2021-01-13T15:34:13.209+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:13.219+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:13.219+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:13.220+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: dbf05b03-e592-4ff0-9dd2-2c85de84e6f4
2021-01-13T15:34:13.248+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:13.248+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:13.249+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:13.258+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:13.258+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:13.259+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: dfe65262-4a04-470d-a7fd-88a8776e9f6a
2021-01-13T15:34:13.277+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:13.287+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:13.287+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:13.288+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 6f6d11fa-b83e-4e85-9a45-84e998ef72dd
2021-01-13T15:34:13.317+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:13.317+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:13.318+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:13.327+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:13.327+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:13.337+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:13.337+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:13.348+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:13.348+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:12,501 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:12,501 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:12,501 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmptlcttmwc
2021-01-13 15:34:12,501 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:12,501 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:12,501 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:12,502 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:12,513 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=8306 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmptlcttmwc
2021-01-13 15:34:12,513 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:12,514 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:12,514 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:8306
2021-01-13 15:34:13,121 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:13,121 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:8306
2021-01-13 15:34:13,130 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615975 for server to start successfully
2021-01-13 15:34:13,131 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:13,131 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:13,355 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:13,357 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmptlcttmwc
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=8306 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmptlcttmwc
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:8306
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:8306
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615975 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:13.366+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:13.367+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:13,384 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:13,388 DEBUG arctic.store._ndarray_store Appended segment 14 for parent 5fff12f51d1e61918c8adbac
2021-01-13 15:34:13,397 DEBUG arctic.store._ndarray_store Appended segment 19 for parent 5fff12f51d1e61918c8adbae
2021-01-13 15:34:13,399 INFO arctic.store.version_store Deleting data item: 'FTL' from 'arctic_test.TEST'
2021-01-13 15:34:13,402 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:13,423 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store._ndarray_store:_ndarray_store.py:509 Appended segment 14 for parent 5fff12f51d1e61918c8adbac
[35mDEBUG   [0m arctic.store._ndarray_store:_ndarray_store.py:509 Appended segment 19 for parent 5fff12f51d1e61918c8adbae
[32mINFO    [0m arctic.store.version_store:version_store.py:938 Deleting data item: 'FTL' from 'arctic_test.TEST'
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:13,528 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 28312 (total_procs_to_kill=1)
2021-01-13 15:34:13,528 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:13,528 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:13,532 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:13,533 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:13,533 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:13,533 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmptlcttmwc
2021-01-13 15:34:13,533 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:13,533 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 28312 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmptlcttmwc
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m____ test_restore_version_snap_delete_symbol_restore[FwPointersCfg.HYBRID] _____[0m

library = <VersionStore at 0x7f84e4094cc0>
    <ArcticLibrary at 0x7f84e4094748, arctic_test.TEST>
        <Arctic at 0x7f84e4094a58, connected to MongoClient(host=['127.67.249.105:32075'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_snap_delete_symbol_restore(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf = _rnd_df(20, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf[:10], metadata={'field_a': 1})  # creates version 1
                library.append(symbol, data=mydf[10:15])  # version 2
                library.snapshot('snapA')
    
                library.append(symbol, data=mydf[15:20])  # version 3
                library.delete(symbol)  # version 4
    
                restored_item = library.restore_version(symbol, as_of='snapA')  # version 5
                assert restored_item.metadata == {'field_a': 1}
                assert restored_item.version == 5
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf[:15])
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1488: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:13.565+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:13.567+0000 I CONTROL  [initandlisten] MongoDB starting : pid=28348 port=32075 dbpath=/tmp/tmpx6f4kdv4 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:13.567+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:13.567+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:13.567+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:13.567+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:13.567+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:13.567+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:13.567+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:13.567+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:13.567+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:13.567+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 32075, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpx6f4kdv4", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:13.567+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:13.567+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:13.567+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:13.567+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:14.072+0000 I STORAGE  [initandlisten] WiredTiger message [1610552054:72035][28348:0x7f027c923a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:14.085+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:14.110+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:14.110+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:14.110+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:14.110+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:14.110+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 14521c8b-a533-4103-ab5b-9619979db05c
2021-01-13T15:34:14.129+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:14.129+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:14.129+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:14.129+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:14.130+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 32f5ae2f-b334-4c58-9b1b-fea4e0f5d693
2021-01-13T15:34:14.150+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:14.150+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpx6f4kdv4/diagnostic.data'
2021-01-13T15:34:14.152+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:14.152+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 77889527-1025-4595-a18a-30266b0fc31e
2021-01-13T15:34:14.152+0000 I NETWORK  [initandlisten] waiting for connections on port 32075
2021-01-13T15:34:14.160+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:51750 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:14.162+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:51752 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:14.165+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:51754 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:14.168+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:51756 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:14.180+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:14.180+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:14.181+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:14.181+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:14.185+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:14.185+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: ca02fd08-12eb-4ff2-93d8-47ac95c02273
2021-01-13T15:34:14.211+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:14.212+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:14.212+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:14.212+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--7916262223867612119
2021-01-13T15:34:14.212+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:14.214+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:14.214+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: ed64db5f-2f31-48d7-b25a-9b323ab3b7b0
2021-01-13T15:34:14.232+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 0c621315-73d1-4de6-b5d3-ce3ad39d8e55
2021-01-13T15:34:14.250+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:14.261+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:14.261+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:14.262+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 7227d480-1d7b-4e49-bcca-f16d75ad25ef
2021-01-13T15:34:14.291+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:14.291+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:14.292+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:14.303+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:14.303+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:14.304+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: cb3b43a3-1a9c-4ea3-a2e5-abb7a1f91684
2021-01-13T15:34:14.324+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:14.334+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:14.334+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:14.336+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: c3419e73-5fb3-4e29-92e6-1e9d7dc6d35f
2021-01-13T15:34:14.362+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:14.362+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:14.363+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:14.373+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:14.373+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:14.385+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:14.385+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:14.395+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:14.395+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:13,537 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:13,537 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:13,537 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpx6f4kdv4
2021-01-13 15:34:13,537 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:13,537 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:13,537 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:13,538 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:13,549 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=32075 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpx6f4kdv4
2021-01-13 15:34:13,549 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:13,550 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:13,550 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:32075
2021-01-13 15:34:14,157 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:14,157 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:32075
2021-01-13 15:34:14,166 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616285 for server to start successfully
2021-01-13 15:34:14,167 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:14,167 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:14,403 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:14,404 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpx6f4kdv4
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=32075 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpx6f4kdv4
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:32075
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:32075
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616285 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:14.414+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:14.414+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:14,432 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:14,436 DEBUG arctic.store._ndarray_store Appended segment 14 for parent 5fff12f61d1e61918c8adbb5
2021-01-13 15:34:14,445 DEBUG arctic.store._ndarray_store Appended segment 19 for parent 5fff12f61d1e61918c8adbb7
2021-01-13 15:34:14,447 INFO arctic.store.version_store Deleting data item: 'FTL' from 'arctic_test.TEST'
2021-01-13 15:34:14,450 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:14,472 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store._ndarray_store:_ndarray_store.py:509 Appended segment 14 for parent 5fff12f61d1e61918c8adbb5
[35mDEBUG   [0m arctic.store._ndarray_store:_ndarray_store.py:509 Appended segment 19 for parent 5fff12f61d1e61918c8adbb7
[32mINFO    [0m arctic.store.version_store:version_store.py:938 Deleting data item: 'FTL' from 'arctic_test.TEST'
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:14,572 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 28348 (total_procs_to_kill=1)
2021-01-13 15:34:14,572 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:14,572 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:14,576 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:14,577 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:14,577 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:14,577 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpx6f4kdv4
2021-01-13 15:34:14,577 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:14,577 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 28348 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpx6f4kdv4
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m____ test_restore_version_snap_delete_symbol_restore[FwPointersCfg.ENABLED] ____[0m

library = <VersionStore at 0x7f84c42c9400>
    <ArcticLibrary at 0x7f84c42c9550, arctic_test.TEST>
        <Arctic at 0x7f84e40942e8, connected to MongoClient(host=['127.67.249.105:30892'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_restore_version_snap_delete_symbol_restore(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            symbol = 'FTL'
            mydf = _rnd_df(20, 5)
            with patch('arctic.arctic.logger.info') as info:
                library.write(symbol, data=mydf[:10], metadata={'field_a': 1})  # creates version 1
                library.append(symbol, data=mydf[10:15])  # version 2
                library.snapshot('snapA')
    
                library.append(symbol, data=mydf[15:20])  # version 3
                library.delete(symbol)  # version 4
    
                restored_item = library.restore_version(symbol, as_of='snapA')  # version 5
                assert restored_item.metadata == {'field_a': 1}
                assert restored_item.version == 5
    
                item = library.read(symbol)
>               assert_frame_equal(item.data, mydf[:15])
[1m[31mE               AssertionError: (None, <Second>)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1488: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:14.607+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:14.609+0000 I CONTROL  [initandlisten] MongoDB starting : pid=28383 port=30892 dbpath=/tmp/tmpn22z1pzj 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:14.609+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:14.609+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:14.609+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:14.609+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:14.609+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:14.609+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:14.609+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:14.609+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:14.609+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:14.609+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 30892, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpn22z1pzj", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:14.610+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:14.610+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:14.610+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:14.610+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:15.104+0000 I STORAGE  [initandlisten] WiredTiger message [1610552055:104598][28383:0x7f1b43824a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:15.116+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:15.142+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:15.142+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:15.142+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:15.142+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:15.143+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: a149cab8-d3a8-4c0e-870e-b9adbaa660df
2021-01-13T15:34:15.162+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:15.162+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:15.162+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:15.162+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:15.162+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: dec7af7a-2e6f-4870-a48c-97ce5087d669
2021-01-13T15:34:15.182+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:15.182+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpn22z1pzj/diagnostic.data'
2021-01-13T15:34:15.183+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:15.184+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 04707d83-4be9-4a80-8b4f-e1dac7fafe80
2021-01-13T15:34:15.184+0000 I NETWORK  [initandlisten] waiting for connections on port 30892
2021-01-13T15:34:15.203+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:34014 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:15.204+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:34016 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:15.208+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:34018 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:15.210+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:34020 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:15.213+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:15.213+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:15.213+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:15.214+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:15.217+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:15.217+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: c65298a7-ed6f-4bfe-b4f1-badef6762e92
2021-01-13T15:34:15.249+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:15.249+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:15.249+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:15.249+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-1748063856742519651
2021-01-13T15:34:15.249+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:15.252+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:15.252+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 518dcbd0-5e89-4f8f-9c03-c68420ad538a
2021-01-13T15:34:15.272+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: b3cb8f1d-af77-48d3-8b3d-dcf1d4484121
2021-01-13T15:34:15.289+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:15.299+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:15.300+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:15.301+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 554b6833-273d-4ed5-9a06-2a6f60144023
2021-01-13T15:34:15.330+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:15.330+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:15.331+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:15.341+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:15.341+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:15.342+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: aab0e6ce-8ada-49ca-9322-47833f0817a6
2021-01-13T15:34:15.362+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:15.373+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:15.373+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:15.374+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 410c8875-abe5-44e9-86ef-29f2957e3d62
2021-01-13T15:34:15.404+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:15.404+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:15.405+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:15.415+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:15.415+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:15.426+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:15.427+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:15.438+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:15.439+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:14,580 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:14,580 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:14,581 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpn22z1pzj
2021-01-13 15:34:14,581 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:14,581 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:14,581 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:14,581 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:14,592 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=30892 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpn22z1pzj
2021-01-13 15:34:14,592 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:14,593 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:14,593 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:30892
2021-01-13 15:34:15,199 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:15,199 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:30892
2021-01-13 15:34:15,208 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615333 for server to start successfully
2021-01-13 15:34:15,209 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:15,209 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:15,447 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:15,449 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpn22z1pzj
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=30892 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpn22z1pzj
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:30892
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:30892
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615333 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:15.458+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:15.459+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:15,476 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:15,481 DEBUG arctic.store._ndarray_store Appended segment 14 for parent 5fff12f71d1e61918c8adbbe
2021-01-13 15:34:15,490 DEBUG arctic.store._ndarray_store Appended segment 19 for parent 5fff12f71d1e61918c8adbc0
2021-01-13 15:34:15,492 INFO arctic.store.version_store Deleting data item: 'FTL' from 'arctic_test.TEST'
2021-01-13 15:34:15,495 DEBUG arctic.store.version_store Finished writing versions for FTL
2021-01-13 15:34:15,516 DEBUG arctic.store.version_store Finished writing versions for FTL
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store._ndarray_store:_ndarray_store.py:509 Appended segment 14 for parent 5fff12f71d1e61918c8adbbe
[35mDEBUG   [0m arctic.store._ndarray_store:_ndarray_store.py:509 Appended segment 19 for parent 5fff12f71d1e61918c8adbc0
[32mINFO    [0m arctic.store.version_store:version_store.py:938 Deleting data item: 'FTL' from 'arctic_test.TEST'
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for FTL
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:15,763 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 28383 (total_procs_to_kill=1)
2021-01-13 15:34:15,764 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:15,766 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:15,767 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:15,767 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:15,767 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:15,767 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpn22z1pzj
2021-01-13 15:34:15,767 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:15,768 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 28383 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpn22z1pzj
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m___________ test_can_write_tz_aware_data_df[FwPointersCfg.DISABLED] ____________[0m

library = <VersionStore at 0x7f84e415e278>
    <ArcticLibrary at 0x7f84c439b7b8, arctic_test.TEST>
        <Arctic at 0x7f84c46fc828, connected to MongoClient(host=['127.67.249.105:26763'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_can_write_tz_aware_data_df(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            mydf = _mixed_test_data()['index_tz_aware'][0]
            library.write(symbol='symTz', data=mydf)
            read_data = library.read(symbol='symTz').data
            # Arctic converts by default the data to UTC, convert back
            read_data.colB = read_data.colB.dt.tz_localize('UTC').dt.tz_convert(read_data.index.tzinfo)
            assert library._versions.find_one({'symbol': 'symTz'})['type'] == PandasDataFrameStore.TYPE
>           assert_frame_equal(mydf, read_data)
[1m[31mE           AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1720: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:50.096+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:50.099+0000 I CONTROL  [initandlisten] MongoDB starting : pid=29718 port=26763 dbpath=/tmp/tmptkjb3aa5 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:50.099+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:50.099+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:50.099+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:50.099+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:50.099+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:50.099+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:50.099+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:50.099+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:50.099+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:50.099+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 26763, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmptkjb3aa5", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:50.099+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:50.099+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:50.099+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:50.099+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:50.598+0000 I STORAGE  [initandlisten] WiredTiger message [1610552090:598360][29718:0x7f68b1712a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:50.612+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:50.636+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:50.636+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:50.636+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:50.636+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:50.636+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: b674e75c-77f3-4418-95c2-3dfaa8a9d13d
2021-01-13T15:34:50.656+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:50.656+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:50.656+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:50.656+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:50.656+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 66d4287c-3caf-4946-b4b7-68e8e3d1c935
2021-01-13T15:34:50.676+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:50.676+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmptkjb3aa5/diagnostic.data'
2021-01-13T15:34:50.677+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:50.677+0000 I NETWORK  [initandlisten] waiting for connections on port 26763
2021-01-13T15:34:50.677+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:34:50.677+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: be5690ce-f7db-4a42-bc80-96ed9cb6d574
2021-01-13T15:34:50.693+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:40608 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:50.694+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:40610 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:50.698+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:40612 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:50.701+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:40614 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:50.707+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:50.707+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:50.708+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:50.708+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--5632777271022617700
2021-01-13T15:34:50.708+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:50.711+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:50.711+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: e2fe0597-a6e2-4c05-92f7-524a4e5e7281
2021-01-13T15:34:50.744+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:50.744+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:50.744+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:50.744+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--5632777271022617700
2021-01-13T15:34:50.744+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:50.747+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:50.747+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 727d7856-5330-4af8-9574-dfb53696f59c
2021-01-13T15:34:50.768+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 5952aa4b-ffc4-480e-a0e7-340eaf3d7041
2021-01-13T15:34:50.791+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:50.802+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:50.802+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:50.803+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: c402fe40-66aa-494b-8d19-28d7f16c8631
2021-01-13T15:34:50.837+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:50.837+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:50.838+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:50.848+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:50.848+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:50.849+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: fe974bfa-2910-42a3-9143-96604748ba07
2021-01-13T15:34:50.869+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:50.880+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:50.881+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:50.882+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 93638ba6-6b87-416b-8d7d-a39863389218
2021-01-13T15:34:50.912+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:50.912+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:50.913+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:50.925+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:50.925+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:50.937+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:50.937+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:50.952+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:50.952+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:50,069 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:50,069 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:50,069 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmptkjb3aa5
2021-01-13 15:34:50,069 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:50,069 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:50,069 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:50,070 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:50,081 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=26763 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmptkjb3aa5
2021-01-13 15:34:50,082 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:50,082 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:50,083 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:26763
2021-01-13 15:34:50,689 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:50,689 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:26763
2021-01-13 15:34:50,698 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615862 for server to start successfully
2021-01-13 15:34:50,699 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:50,699 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:50,959 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:50,961 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmptkjb3aa5
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=26763 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmptkjb3aa5
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:26763
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:26763
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615862 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:50.967+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:50.967+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:50,977 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:34:50,984 DEBUG arctic.store.version_store Finished writing versions for symTz
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for symTz
--------------------------- Captured stdout teardown ---------------------------
2021-01-13T15:34:51.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:51,086 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 29718 (total_procs_to_kill=1)
2021-01-13 15:34:51,087 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:51,087 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:51,091 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:51,091 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:51,091 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:51,091 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmptkjb3aa5
2021-01-13 15:34:51,092 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:51,092 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 29718 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmptkjb3aa5
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m____________ test_can_write_tz_aware_data_df[FwPointersCfg.HYBRID] _____________[0m

library = <VersionStore at 0x7f84c4303b00>
    <ArcticLibrary at 0x7f84c4313390, arctic_test.TEST>
        <Arctic at 0x7f84e4084c88, connected to MongoClient(host=['127.67.249.105:30974'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_can_write_tz_aware_data_df(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            mydf = _mixed_test_data()['index_tz_aware'][0]
            library.write(symbol='symTz', data=mydf)
            read_data = library.read(symbol='symTz').data
            # Arctic converts by default the data to UTC, convert back
            read_data.colB = read_data.colB.dt.tz_localize('UTC').dt.tz_convert(read_data.index.tzinfo)
            assert library._versions.find_one({'symbol': 'symTz'})['type'] == PandasDataFrameStore.TYPE
>           assert_frame_equal(mydf, read_data)
[1m[31mE           AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1720: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:51.121+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:51.124+0000 I CONTROL  [initandlisten] MongoDB starting : pid=29753 port=30974 dbpath=/tmp/tmp972slj84 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:51.124+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:51.124+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:51.124+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:51.124+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:51.124+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:51.124+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:51.124+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:51.124+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:51.124+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:51.124+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 30974, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp972slj84", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:51.124+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:51.124+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:51.124+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:51.124+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:51.622+0000 I STORAGE  [initandlisten] WiredTiger message [1610552091:622568][29753:0x7fdc7e621a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:51.635+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:51.659+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:51.659+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:51.659+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:51.659+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:51.659+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 9fe52a10-ad9e-4e6a-af1b-6d6a8b9a8a1a
2021-01-13T15:34:51.676+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:51.676+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:51.676+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:51.677+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:51.677+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 69873ac1-38db-4a6a-860d-c14181818e8f
2021-01-13T15:34:51.697+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:51.697+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp972slj84/diagnostic.data'
2021-01-13T15:34:51.699+0000 I NETWORK  [initandlisten] waiting for connections on port 30974
2021-01-13T15:34:51.699+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:51.699+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:34:51.699+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: c6387230-a260-493c-afea-2a0cc14ad645
2021-01-13T15:34:51.717+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:40808 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:51.719+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:40810 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:51.724+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:40812 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:51.726+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:40814 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:51.729+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:51.729+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:51.729+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:51.729+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--6624680692424324364
2021-01-13T15:34:51.729+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:51.733+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:51.733+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 49650650-e23c-4d1a-8958-ba40453fe403
2021-01-13T15:34:51.763+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:51.764+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:51.764+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:51.764+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--6624680692424324364
2021-01-13T15:34:51.764+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:51.766+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:51.766+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: e7d35929-dee1-45f7-9a6a-f1af06c70791
2021-01-13T15:34:51.787+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 7755f654-6b5c-4fb9-8ed0-b6e67abc4a34
2021-01-13T15:34:51.807+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:51.816+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:51.816+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:51.817+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: e9441c5a-e863-4865-be12-dd8d9c61a472
2021-01-13T15:34:51.850+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:51.850+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:51.851+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:51.862+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:51.862+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:51.863+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: 607439d5-be81-48a9-b4c6-e56f59333742
2021-01-13T15:34:51.884+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:51.894+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:51.894+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:51.895+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: ad73dd8b-5336-4a26-a20c-6ac9bdf2f3bd
2021-01-13T15:34:51.926+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:51.926+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:51.927+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:51.938+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:51.938+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:51.951+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:51.951+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:51.963+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:51.964+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:51,095 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:51,095 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:51,095 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp972slj84
2021-01-13 15:34:51,095 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:51,095 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:51,095 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:51,096 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:51,106 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=30974 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp972slj84
2021-01-13 15:34:51,107 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:51,108 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:51,108 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:30974
2021-01-13 15:34:51,714 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:51,714 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:30974
2021-01-13 15:34:51,724 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616707 for server to start successfully
2021-01-13 15:34:51,725 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:51,725 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:51,971 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:51,973 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp972slj84
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=30974 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp972slj84
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:30974
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:30974
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616707 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:51.979+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:51.980+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
2021-01-13T15:34:52.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:51,990 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:34:51,998 DEBUG arctic.store.version_store Finished writing versions for symTz
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for symTz
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:52,108 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 29753 (total_procs_to_kill=1)
2021-01-13 15:34:52,108 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:52,108 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:52,112 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:52,113 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:52,113 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:52,113 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp972slj84
2021-01-13 15:34:52,113 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:52,113 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 29753 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp972slj84
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m____________ test_can_write_tz_aware_data_df[FwPointersCfg.ENABLED] ____________[0m

library = <VersionStore at 0x7f84c4303fd0>
    <ArcticLibrary at 0x7f84c4303d68, arctic_test.TEST>
        <Arctic at 0x7f84c4303358, connected to MongoClient(host=['127.67.249.105:29630'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_can_write_tz_aware_data_df(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            mydf = _mixed_test_data()['index_tz_aware'][0]
            library.write(symbol='symTz', data=mydf)
            read_data = library.read(symbol='symTz').data
            # Arctic converts by default the data to UTC, convert back
            read_data.colB = read_data.colB.dt.tz_localize('UTC').dt.tz_convert(read_data.index.tzinfo)
            assert library._versions.find_one({'symbol': 'symTz'})['type'] == PandasDataFrameStore.TYPE
>           assert_frame_equal(mydf, read_data)
[1m[31mE           AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1720: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:52.144+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:52.146+0000 I CONTROL  [initandlisten] MongoDB starting : pid=29788 port=29630 dbpath=/tmp/tmplcai5x15 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:52.146+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:52.146+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:52.146+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:52.146+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:52.146+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:52.146+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:52.146+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:52.146+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:52.146+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:52.146+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 29630, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmplcai5x15", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:52.146+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:52.146+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:52.146+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:52.146+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:52.645+0000 I STORAGE  [initandlisten] WiredTiger message [1610552092:645501][29788:0x7f5544a73a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:52.658+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:52.686+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:52.686+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:52.686+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:52.686+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:52.686+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 0dd7db18-d92c-468c-a8f2-8f3ebdd284a9
2021-01-13T15:34:52.706+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:52.706+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:52.706+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:52.706+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:52.706+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: bfebce9c-98da-4002-a350-222bc733740c
2021-01-13T15:34:52.725+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:52.725+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmplcai5x15/diagnostic.data'
2021-01-13T15:34:52.726+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:52.726+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: b3ff2e3d-8fd8-4092-96e7-99c8444991ae
2021-01-13T15:34:52.727+0000 I NETWORK  [initandlisten] waiting for connections on port 29630
2021-01-13T15:34:52.739+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:37732 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:52.741+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:37734 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:52.745+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:37736 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:52.748+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:37738 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:52.760+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:52.760+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:52.760+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:52.760+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--3332482915664933676
2021-01-13T15:34:52.761+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:52.761+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:52.764+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:52.764+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 40e23d94-b3f6-46b8-9a70-b96556769e67
2021-01-13T15:34:52.797+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:52.797+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:52.797+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:52.797+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--3332482915664933676
2021-01-13T15:34:52.797+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:52.800+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:52.800+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 4153551a-6886-41c6-9ecf-c9281c8f9bb3
2021-01-13T15:34:52.820+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: eb8fa98b-222b-4a2c-81aa-29dfcd87512d
2021-01-13T15:34:52.838+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:52.849+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:52.849+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:52.850+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 02e820b2-2866-4d27-b794-bb750df88e99
2021-01-13T15:34:52.884+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:52.884+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:52.885+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:52.895+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:52.895+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:52.896+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: a7c1aab2-bbd3-41cf-ab51-f1132ca290fa
2021-01-13T15:34:52.917+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:52.927+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:52.928+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:52.928+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 2c794a50-7d3b-4199-b834-b1d7fd6b875f
2021-01-13T15:34:52.961+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:52.962+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:52.963+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:52.975+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:52.975+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:52.987+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:52.987+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:52.999+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:53.000+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:53.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:52,116 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:52,116 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:52,117 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmplcai5x15
2021-01-13 15:34:52,117 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:52,117 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:52,117 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:52,117 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:52,128 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=29630 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmplcai5x15
2021-01-13 15:34:52,129 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:52,129 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:52,130 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:29630
2021-01-13 15:34:52,735 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:52,736 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:29630
2021-01-13 15:34:52,746 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616230 for server to start successfully
2021-01-13 15:34:52,746 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:52,747 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:53,007 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:53,009 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmplcai5x15
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=29630 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmplcai5x15
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:29630
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:29630
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616230 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:53.016+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:53.017+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:53,026 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:34:53,033 DEBUG arctic.store.version_store Finished writing versions for symTz
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for symTz
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:53,138 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 29788 (total_procs_to_kill=1)
2021-01-13 15:34:53,138 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:53,138 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:53,142 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:53,143 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:53,143 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:53,143 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmplcai5x15
2021-01-13 15:34:53,143 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:53,143 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 29788 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmplcai5x15
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_________ test_can_write_tz_aware_data_series[FwPointersCfg.DISABLED] __________[0m

library = <VersionStore at 0x7f84c42dc9b0>
    <ArcticLibrary at 0x7f84c42dca58, arctic_test.TEST>
        <Arctic at 0x7f84c475c630, connected to MongoClient(host=['127.67.249.105:31616'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.DISABLED: 1>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_can_write_tz_aware_data_series(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            myseries = _mixed_test_data()['index_tz_aware'][0]['colB']
            library.write(symbol='symTzSer', data=myseries)
            read_data = library.read(symbol='symTzSer').data
            # Arctic converts by default the data to UTC, convert back
            read_data = read_data.dt.tz_localize('UTC').dt.tz_convert(read_data.index.tzinfo)
            assert library._versions.find_one({'symbol': 'symTzSer'})['type'] == PandasSeriesStore.TYPE
>           assert_series_equal(myseries, read_data)
[1m[31mE           AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1732: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:53.174+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:53.176+0000 I CONTROL  [initandlisten] MongoDB starting : pid=29823 port=31616 dbpath=/tmp/tmpucjiekk2 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:53.176+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:53.176+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:53.176+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:53.176+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:53.176+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:53.176+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:53.176+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:53.176+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:53.176+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:53.176+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 31616, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpucjiekk2", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:53.176+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:53.176+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:53.176+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:53.176+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:53.675+0000 I STORAGE  [initandlisten] WiredTiger message [1610552093:675664][29823:0x7faf7d400a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:53.688+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:53.711+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:53.712+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:53.712+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:53.712+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:53.712+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 9d4085d7-7a95-4129-99cb-361ce7ba6638
2021-01-13T15:34:53.730+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:53.731+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:53.731+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:53.731+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:53.731+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 32a50338-fe43-4d36-9fd3-05c66205307c
2021-01-13T15:34:53.749+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:53.750+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpucjiekk2/diagnostic.data'
2021-01-13T15:34:53.751+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:53.751+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 8cf42e22-7161-4b15-a6da-e87d87081ec0
2021-01-13T15:34:53.751+0000 I NETWORK  [initandlisten] waiting for connections on port 31616
2021-01-13T15:34:53.769+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:42930 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:53.771+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:42932 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:53.777+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:42934 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:53.777+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:42936 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:53.780+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:53.780+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:53.780+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:53.780+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--6228304674347484488
2021-01-13T15:34:53.780+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:53.781+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:53.784+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:53.784+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 6dede38a-8ff5-4f28-9d53-2ab1e91c63cc
2021-01-13T15:34:53.816+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:53.816+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:53.816+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:53.816+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--6228304674347484488
2021-01-13T15:34:53.816+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:53.819+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:53.819+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: 4c7fc531-c0ac-49c1-a1ee-1ec83d6a933b
2021-01-13T15:34:53.839+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 50b861df-7508-4ef4-838e-849df8b17dc5
2021-01-13T15:34:53.860+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:53.870+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:53.870+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:53.872+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 80087c60-24b8-4894-a715-70a23e43fef8
2021-01-13T15:34:53.903+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:53.903+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:53.904+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:53.915+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:53.915+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:53.916+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: e1197b19-62fa-4610-a013-7e844413e2a4
2021-01-13T15:34:53.937+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:53.948+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:53.948+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:53.949+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 00f43fa7-2e2e-48cd-a3e6-f4d14948259d
2021-01-13T15:34:53.981+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:53.981+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:53.982+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:53.993+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:53.993+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:54.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:34:54.005+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:54.005+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:54.017+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:54.017+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:53,146 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:53,146 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:53,146 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpucjiekk2
2021-01-13 15:34:53,147 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:53,147 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:53,147 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:53,147 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:53,158 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=31616 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpucjiekk2
2021-01-13 15:34:53,159 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:53,159 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:53,160 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:31616
2021-01-13 15:34:53,766 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:53,767 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:31616
2021-01-13 15:34:53,775 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615562 for server to start successfully
2021-01-13 15:34:53,775 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:53,776 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:54,024 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:54,026 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpucjiekk2
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=31616 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpucjiekk2
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:31616
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:31616
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615562 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:54.033+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:54.034+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:54,043 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:34:54,050 DEBUG arctic.store.version_store Finished writing versions for symTzSer
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for symTzSer
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:54,299 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 29823 (total_procs_to_kill=1)
2021-01-13 15:34:54,300 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:54,300 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:54,304 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:54,304 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:54,304 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:54,304 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpucjiekk2
2021-01-13 15:34:54,304 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:54,304 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 29823 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpucjiekk2
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m__________ test_can_write_tz_aware_data_series[FwPointersCfg.HYBRID] ___________[0m

library = <VersionStore at 0x7f84e4061550>
    <ArcticLibrary at 0x7f84e4061400, arctic_test.TEST>
        <Arctic at 0x7f84e40617f0, connected to MongoClient(host=['127.67.249.105:10991'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.HYBRID: 2>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_can_write_tz_aware_data_series(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            myseries = _mixed_test_data()['index_tz_aware'][0]['colB']
            library.write(symbol='symTzSer', data=myseries)
            read_data = library.read(symbol='symTzSer').data
            # Arctic converts by default the data to UTC, convert back
            read_data = read_data.dt.tz_localize('UTC').dt.tz_convert(read_data.index.tzinfo)
            assert library._versions.find_one({'symbol': 'symTzSer'})['type'] == PandasSeriesStore.TYPE
>           assert_series_equal(myseries, read_data)
[1m[31mE           AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1732: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:54.335+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:54.338+0000 I CONTROL  [initandlisten] MongoDB starting : pid=29858 port=10991 dbpath=/tmp/tmp86euet8p 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:54.338+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:54.338+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:54.338+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:54.338+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:54.338+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:54.338+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:54.338+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:54.338+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:54.338+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:54.338+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 10991, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp86euet8p", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:54.338+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:54.338+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:54.338+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:54.338+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:54.839+0000 I STORAGE  [initandlisten] WiredTiger message [1610552094:839378][29858:0x7ff9345cba80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:54.851+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:54.877+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:54.877+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:54.877+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:54.877+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:54.878+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 41f35639-a822-45c9-b23d-2e9300662080
2021-01-13T15:34:54.896+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:54.896+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:54.896+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:54.896+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:54.896+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 0935a840-a8fc-4951-a88a-202c77ffe2a2
2021-01-13T15:34:54.913+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:54.914+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp86euet8p/diagnostic.data'
2021-01-13T15:34:54.915+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:54.915+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: bf36a54a-b0b4-4f99-8845-a27a24fd7aa3
2021-01-13T15:34:54.915+0000 I NETWORK  [initandlisten] waiting for connections on port 10991
2021-01-13T15:34:54.931+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:50998 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:54.933+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:51000 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:54.937+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:51002 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:54.940+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:51004 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:54.942+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:54.942+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:54.942+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:54.942+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-7370157436027653725
2021-01-13T15:34:54.942+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:54.942+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:54.945+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:54.945+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: a0a89ce5-f602-4a20-8f3a-92e4b0541437
2021-01-13T15:34:54.974+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:54.974+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:54.974+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:54.974+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-7370157436027653725
2021-01-13T15:34:54.974+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:54.976+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:54.976+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: ea2a3fc3-b54b-4345-ba5e-ca1039100464
2021-01-13T15:34:54.997+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: 23b60a67-53f5-4618-ac91-db83e5b74119
2021-01-13T15:34:55.001+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:34:55.018+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:55.028+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:55.029+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:55.030+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: 82f75cf7-49e1-41c5-a01f-d76b11862783
2021-01-13T15:34:55.060+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:55.060+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:55.061+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:55.073+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:55.073+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:55.074+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: e216b934-17bc-4b71-bcb9-354511ae88ee
2021-01-13T15:34:55.095+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:55.106+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:55.106+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:55.107+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: ce52b4a4-e4bc-46e8-b29c-f68f7ff0d53e
2021-01-13T15:34:55.133+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:55.133+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:55.135+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:55.144+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:55.144+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:55.154+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:55.154+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:55.166+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:55.166+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:54,307 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:54,308 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:54,308 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp86euet8p
2021-01-13 15:34:54,308 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:54,308 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:54,308 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:54,308 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:54,320 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=10991 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp86euet8p
2021-01-13 15:34:54,321 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:54,321 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:54,322 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:10991
2021-01-13 15:34:54,927 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:54,928 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:10991
2021-01-13 15:34:54,938 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616382 for server to start successfully
2021-01-13 15:34:54,938 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:54,939 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:55,174 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:55,176 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp86euet8p
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=10991 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp86euet8p
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:10991
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:10991
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616382 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:55.183+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:55.184+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:55,194 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:34:55,202 DEBUG arctic.store.version_store Finished writing versions for symTzSer
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for symTzSer
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:55,307 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 29858 (total_procs_to_kill=1)
2021-01-13 15:34:55,307 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:55,308 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:55,312 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:55,312 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:55,312 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:55,312 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp86euet8p
2021-01-13 15:34:55,312 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:55,312 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 29858 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp86euet8p
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m__________ test_can_write_tz_aware_data_series[FwPointersCfg.ENABLED] __________[0m

library = <VersionStore at 0x7f84c64aa908>
    <ArcticLibrary at 0x7f84c64aa550, arctic_test.TEST>
        <Arctic at 0x7f84c43cc6d8, connected to MongoClient(host=['127.67.249.105:22750'], document_class=dict, tz_aware=False, connect=True)>
fw_pointers_cfg = <FwPointersCfg.ENABLED: 0>

    @pytest.mark.parametrize('fw_pointers_cfg', [FwPointersCfg.DISABLED, FwPointersCfg.HYBRID, FwPointersCfg.ENABLED])
    def test_can_write_tz_aware_data_series(library, fw_pointers_cfg):
        with FwPointersCtx(fw_pointers_cfg):
            myseries = _mixed_test_data()['index_tz_aware'][0]['colB']
            library.write(symbol='symTzSer', data=myseries)
            read_data = library.read(symbol='symTzSer').data
            # Arctic converts by default the data to UTC, convert back
            read_data = read_data.dt.tz_localize('UTC').dt.tz_convert(read_data.index.tzinfo)
            assert library._versions.find_one({'symbol': 'symTzSer'})['type'] == PandasSeriesStore.TYPE
>           assert_series_equal(myseries, read_data)
[1m[31mE           AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/store/test_version_store.py[0m:1732: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:34:55.344+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:34:55.346+0000 I CONTROL  [initandlisten] MongoDB starting : pid=29893 port=22750 dbpath=/tmp/tmpt423dunw 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:34:55.346+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:34:55.346+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:34:55.346+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:34:55.346+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:34:55.346+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:34:55.346+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:34:55.346+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:34:55.346+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:34:55.346+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:34:55.346+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 22750, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpt423dunw", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:34:55.346+0000 I STORAGE  [initandlisten] 
2021-01-13T15:34:55.346+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:34:55.346+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:34:55.347+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:34:55.845+0000 I STORAGE  [initandlisten] WiredTiger message [1610552095:845987][29893:0x7fe3ddff2a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:34:55.859+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:34:55.884+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:55.884+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:34:55.884+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:34:55.884+0000 I CONTROL  [initandlisten] 
2021-01-13T15:34:55.885+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 1a617a3b-f360-4649-ae74-f2a39381738b
2021-01-13T15:34:55.904+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:34:55.904+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:34:55.904+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:34:55.904+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:34:55.904+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: e34aaf09-b076-4016-b4bd-e52b1bb963b0
2021-01-13T15:34:55.923+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:34:55.923+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpt423dunw/diagnostic.data'
2021-01-13T15:34:55.924+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:34:55.925+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: f39d7a04-8177-47ca-af93-ec8db116bba0
2021-01-13T15:34:55.925+0000 I NETWORK  [initandlisten] waiting for connections on port 22750
2021-01-13T15:34:55.940+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:41148 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:55.941+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:41150 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:55.945+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:41152 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:55.948+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:41154 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:34:55.953+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:34:55.953+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:55.953+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:55.954+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:34:55.958+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:34:55.958+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 57d74b48-95e9-4e3b-a5cd-0aa272a2ce0a
2021-01-13T15:34:55.987+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:34:55.987+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:34:55.987+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:34:55.987+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-8902731483948548681
2021-01-13T15:34:55.987+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:55.989+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.ARCTIC as collection version: <unsharded>
2021-01-13T15:34:55.989+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.ARCTIC with generated UUID: f193622a-8331-4c54-9de4-d847082b0c8f
2021-01-13T15:34:56.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
2021-01-13T15:34:56.014+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.snapshots with generated UUID: e3101c16-c86c-4aec-a3e8-9739f22673e4
2021-01-13T15:34:56.031+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.snapshots as collection version: <unsharded>
2021-01-13T15:34:56.041+0000 I INDEX    [conn4] build index on: arctic_test.TEST.snapshots properties: { v: 2, unique: true, key: { name: 1 }, name: "name_1", ns: "arctic_test.TEST.snapshots", background: true }
2021-01-13T15:34:56.041+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:56.042+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.versions with generated UUID: b55e3014-3a00-4335-bded-0207814a5137
2021-01-13T15:34:56.070+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, key: { symbol: 1, _id: -1 }, name: "symbol_1__id_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:56.071+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:56.072+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.versions as collection version: <unsharded>
2021-01-13T15:34:56.082+0000 I INDEX    [conn4] build index on: arctic_test.TEST.versions properties: { v: 2, unique: true, key: { symbol: 1, version: -1 }, name: "symbol_1_version_-1", ns: "arctic_test.TEST.versions", background: true }
2021-01-13T15:34:56.082+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:56.083+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST.version_nums with generated UUID: f06b087e-f548-4c8b-8b53-9b4ddeb009c1
2021-01-13T15:34:56.100+0000 I SHARDING [conn4] Marking collection arctic_test.TEST.version_nums as collection version: <unsharded>
2021-01-13T15:34:56.111+0000 I INDEX    [conn4] build index on: arctic_test.TEST.version_nums properties: { v: 2, unique: true, key: { symbol: 1 }, name: "symbol_1", ns: "arctic_test.TEST.version_nums", background: true }
2021-01-13T15:34:56.111+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:56.112+0000 I STORAGE  [conn4] createCollection: arctic_test.TEST with generated UUID: 9ecb2384-5643-402a-a7b5-e036036e4ceb
2021-01-13T15:34:56.142+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, key: { symbol: "hashed" }, name: "symbol_hashed", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:56.142+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:56.143+0000 I SHARDING [conn4] Marking collection arctic_test.TEST as collection version: <unsharded>
2021-01-13T15:34:56.153+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1 }, name: "symbol_1_sha_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:56.153+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:56.163+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, parent: 1, segment: 1 }, name: "symbol_1_parent_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:56.163+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:34:56.174+0000 I INDEX    [conn4] build index on: arctic_test.TEST properties: { v: 2, unique: true, key: { symbol: 1, sha: 1, segment: 1 }, name: "symbol_1_sha_1_segment_1", ns: "arctic_test.TEST", background: true }
2021-01-13T15:34:56.174+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:34:55,316 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:55,316 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:55,316 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpt423dunw
2021-01-13 15:34:55,316 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:34:55,316 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:55,316 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:55,317 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:34:55,328 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=22750 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpt423dunw
2021-01-13 15:34:55,329 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:34:55,329 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:34:55,330 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:22750
2021-01-13 15:34:55,936 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:34:55,937 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:22750
2021-01-13 15:34:55,945 DEBUG pytest_server_fixtures.base2 waited 0:00:00.616010 for server to start successfully
2021-01-13 15:34:55,946 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:34:55,947 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:34:56,182 INFO arctic.store.version_store Trying to enable sharding...
2021-01-13 15:34:56,184 WARNING arctic.store.version_store Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpt423dunw
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=22750 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpt423dunw
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:22750
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:22750
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.616010 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[32mINFO    [0m arctic.store.version_store:version_store.py:62 Trying to enable sharding...
[33mWARNING [0m arctic.store.version_store:version_store.py:66 Library created, but couldn't enable sharding: no such command: 'enablesharding', full error: {'ok': 0.0, 'errmsg': "no such command: 'enablesharding'", 'code': 59, 'codeName': 'CommandNotFound'}. This is OK if you're not 'admin'
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:34:56.190+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.databases as collection version: <unsharded>
2021-01-13T15:34:56.191+0000 I SHARDING [conn4] Marking collection arctic_test.connection.config.collections as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:34:56,200 INFO arctic.arctic Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
2021-01-13 15:34:56,207 DEBUG arctic.store.version_store Finished writing versions for symTzSer
------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.arctic:arctic.py:625 Mongo Quota: arctic_test.TEST 0.000 / 10 GB used
[35mDEBUG   [0m arctic.store.version_store:version_store.py:674 Finished writing versions for symTzSer
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:34:56,311 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 29893 (total_procs_to_kill=1)
2021-01-13 15:34:56,311 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:34:56,312 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:34:56,316 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:34:56,316 DEBUG pytest_shutil.workspace 
2021-01-13 15:34:56,316 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:56,316 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpt423dunw
2021-01-13 15:34:56,316 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:34:56,316 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 29893 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpt423dunw
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_ test_should_return_data_when_date_range_falls_in_a_single_underlying_library _[0m

toplevel_tickstore = <arctic.tickstore.toplevel.TopLevelTickStore object at 0x7f84c64a1588>
arctic = <Arctic at 0x7f84c64713c8, connected to MongoClient(host=['127.67.249.105:28577'], document_class=dict, tz_aware=False, connect=True)>

    def test_should_return_data_when_date_range_falls_in_a_single_underlying_library(toplevel_tickstore, arctic):
        arctic.initialize_library('FEED_2010.LEVEL1', tickstore.TICK_STORE_TYPE)
        tstore = arctic['FEED_2010.LEVEL1']
        arctic.initialize_library('test_current.toplevel_tickstore', tickstore.TICK_STORE_TYPE)
        tickstore_current = arctic['test_current.toplevel_tickstore']
        toplevel_tickstore._collection.insert_one({'start': dt(2010, 1, 1),
                                               'end': dt(2010, 12, 31, 23, 59, 59),
                                               'library_name': 'FEED_2010.LEVEL1'})
        dates = pd.date_range('20100101', periods=6, tz=mktz('Europe/London'))
        df = pd.DataFrame(np.random.randn(6, 4), index=dates, columns=list('ABCD'))
        tstore.write('blah', df)
        tickstore_current.write('blah', df)
        res = toplevel_tickstore.read('blah', DateRange(start=dt(2010, 1, 1), end=dt(2010, 1, 6)), list('ABCD'))
    
>       assert_frame_equal(df, res.tz_convert(mktz('Europe/London')))
[1m[31mE       AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/tickstore/test_toplevel.py[0m:65: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:36:41.468+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:36:41.470+0000 I CONTROL  [initandlisten] MongoDB starting : pid=31725 port=28577 dbpath=/tmp/tmp8ivg2eob 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:36:41.470+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:36:41.470+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:36:41.470+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:36:41.470+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:36:41.470+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:36:41.470+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:36:41.470+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:36:41.470+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:36:41.470+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:36:41.470+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 28577, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp8ivg2eob", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:36:41.470+0000 I STORAGE  [initandlisten] 
2021-01-13T15:36:41.470+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:36:41.470+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:36:41.470+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:36:41.970+0000 I STORAGE  [initandlisten] WiredTiger message [1610552201:970935][31725:0x7f4333a4ca80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:36:41.984+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:36:42.011+0000 I CONTROL  [initandlisten] 
2021-01-13T15:36:42.011+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:36:42.011+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:36:42.011+0000 I CONTROL  [initandlisten] 
2021-01-13T15:36:42.012+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 76e394ca-fd00-42e1-b90b-0799960365c1
2021-01-13T15:36:42.031+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:36:42.031+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:36:42.031+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:36:42.031+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:36:42.031+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 733b2bae-451d-4e90-a3a9-5046d89177a4
2021-01-13T15:36:42.052+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:36:42.052+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp8ivg2eob/diagnostic.data'
2021-01-13T15:36:42.053+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:36:42.053+0000 I NETWORK  [initandlisten] waiting for connections on port 28577
2021-01-13T15:36:42.053+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:36:42.053+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 3b5a4712-35cb-432f-8c0e-cb4227659e64
2021-01-13T15:36:42.061+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:53192 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:42.063+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:53194 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:42.068+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:53196 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:42.070+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:53198 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:42.083+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:36:42.083+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:36:42.085+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:42.089+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:36:42.089+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 291b4eca-9486-4d5a-a463-ca8053c6bfb7
2021-01-13T15:36:42.119+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:36:42.119+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:36:42.119+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:36:42.119+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--677707699929140183
2021-01-13T15:36:42.119+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:42.121+0000 I SHARDING [conn4] Marking collection arctic_test.toplevel_tickstore.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:42.121+0000 I STORAGE  [conn4] createCollection: arctic_test.toplevel_tickstore.ARCTIC with generated UUID: 94363fd0-2b1f-48e2-b610-3c3562ed7f8f
2021-01-13T15:36:42.143+0000 I SHARDING [conn4] Marking collection meta_db.settings as collection version: <unsharded>
2021-01-13T15:36:42.147+0000 I STORAGE  [conn4] createCollection: arctic_test.toplevel_tickstore with generated UUID: fc2b2b91-a68e-4530-9ba4-ac3a0dc17cf8
2021-01-13T15:36:42.181+0000 I INDEX    [conn4] build index on: arctic_test.toplevel_tickstore properties: { v: 2, key: { start: 1 }, name: "start_1", ns: "arctic_test.toplevel_tickstore", background: true }
2021-01-13T15:36:42.181+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:36:41,438 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:41,438 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:41,438 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp8ivg2eob
2021-01-13 15:36:41,439 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:36:41,439 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:41,439 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:41,439 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:36:41,451 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=28577 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp8ivg2eob
2021-01-13 15:36:41,452 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:36:41,452 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:36:41,452 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:28577
2021-01-13 15:36:42,058 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:36:42,058 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:28577
2021-01-13 15:36:42,068 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615903 for server to start successfully
2021-01-13 15:36:42,068 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:36:42,069 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:36:42,144 DEBUG root Cache has expired data, fetching from slow path and reloading cache.
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp8ivg2eob
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=28577 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp8ivg2eob
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:28577
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:28577
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615903 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[35mDEBUG   [0m root:arctic.py:234 Cache has expired data, fetching from slow path and reloading cache.
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:36:42.187+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:42.187+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1.ARCTIC with generated UUID: cdab7d86-d2c8-4a74-96fb-27f31140e481
2021-01-13T15:36:42.210+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1 with generated UUID: ee2fcacd-3051-4e98-82e8-8f284825f24b
2021-01-13T15:36:42.237+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1 properties: { v: 2, key: { sy: 1, s: 1 }, name: "sy_1_s_1", ns: "arctic_FEED_2010.LEVEL1", background: true }
2021-01-13T15:36:42.237+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:42.248+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1 properties: { v: 2, key: { s: 1 }, name: "s_1", ns: "arctic_FEED_2010.LEVEL1", background: true }
2021-01-13T15:36:42.248+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:42.249+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1.metadata with generated UUID: 736fdfb3-99a5-42cf-8644-ad2fcf3980e6
2021-01-13T15:36:42.270+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1.metadata as collection version: <unsharded>
2021-01-13T15:36:42.281+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1.metadata properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_FEED_2010.LEVEL1.metadata", background: true }
2021-01-13T15:36:42.281+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:42.287+0000 I SHARDING [conn4] Marking collection arctic_test_current.toplevel_tickstore.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:42.287+0000 I STORAGE  [conn4] createCollection: arctic_test_current.toplevel_tickstore.ARCTIC with generated UUID: 7c7a1d4d-e9d1-432d-aa51-700c4a9fda4a
2021-01-13T15:36:42.306+0000 I STORAGE  [conn4] createCollection: arctic_test_current.toplevel_tickstore with generated UUID: 03bee10c-a579-4c8e-9a03-498565e2f19f
2021-01-13T15:36:42.336+0000 I INDEX    [conn4] build index on: arctic_test_current.toplevel_tickstore properties: { v: 2, key: { sy: 1, s: 1 }, name: "sy_1_s_1", ns: "arctic_test_current.toplevel_tickstore", background: true }
2021-01-13T15:36:42.336+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:42.348+0000 I INDEX    [conn4] build index on: arctic_test_current.toplevel_tickstore properties: { v: 2, key: { s: 1 }, name: "s_1", ns: "arctic_test_current.toplevel_tickstore", background: true }
2021-01-13T15:36:42.348+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:42.349+0000 I STORAGE  [conn4] createCollection: arctic_test_current.toplevel_tickstore.metadata with generated UUID: c8f7459c-8d5b-4fc4-b015-3f8d84a03ff3
2021-01-13T15:36:42.368+0000 I SHARDING [conn4] Marking collection arctic_test_current.toplevel_tickstore.metadata as collection version: <unsharded>
2021-01-13T15:36:42.381+0000 I INDEX    [conn4] build index on: arctic_test_current.toplevel_tickstore.metadata properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_test_current.toplevel_tickstore.metadata", background: true }
2021-01-13T15:36:42.381+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:42.385+0000 I SHARDING [conn4] Marking collection arctic_test.toplevel_tickstore as collection version: <unsharded>
2021-01-13T15:36:42.388+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1 as collection version: <unsharded>
2021-01-13T15:36:42.394+0000 I SHARDING [conn4] Marking collection arctic_test_current.toplevel_tickstore as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:36:42,390 WARNING arctic.tickstore.tickstore NB treating all values as 'exists' - no longer sparse
2021-01-13 15:36:42,393 DEBUG arctic.tickstore.tickstore 1 buckets in 0.001101: approx 90826521 ticks/sec
2021-01-13 15:36:42,395 WARNING arctic.tickstore.tickstore NB treating all values as 'exists' - no longer sparse
2021-01-13 15:36:42,397 DEBUG arctic.tickstore.tickstore 1 buckets in 0.001064: approx 93984962 ticks/sec
2021-01-13 15:36:42,404 INFO arctic.tickstore.tickstore Got data in 0.00478 secs, creating DataFrame...
2021-01-13 15:36:42,405 INFO arctic.tickstore.tickstore 6 rows in 0.006422 secs: 934 ticks/sec
------------------------------ Captured log call -------------------------------
[33mWARNING [0m arctic.tickstore.tickstore:tickstore.py:706 NB treating all values as 'exists' - no longer sparse
[35mDEBUG   [0m arctic.tickstore.tickstore:tickstore.py:612 1 buckets in 0.001101: approx 90826521 ticks/sec
[33mWARNING [0m arctic.tickstore.tickstore:tickstore.py:706 NB treating all values as 'exists' - no longer sparse
[35mDEBUG   [0m arctic.tickstore.tickstore:tickstore.py:612 1 buckets in 0.001064: approx 93984962 ticks/sec
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:355 Got data in 0.00478 secs, creating DataFrame...
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:364 6 rows in 0.006422 secs: 934 ticks/sec
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:36:42,436 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 31725 (total_procs_to_kill=1)
2021-01-13 15:36:42,436 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:36:42,436 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:36:42,440 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:36:42,440 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:42,441 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:42,441 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp8ivg2eob
2021-01-13 15:36:42,441 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:42,441 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 31725 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp8ivg2eob
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_ test_should_return_data_when_date_range_spans_libraries_even_if_one_returns_nothing _[0m

toplevel_tickstore = <arctic.tickstore.toplevel.TopLevelTickStore object at 0x7f84e40424a8>
arctic = <Arctic at 0x7f84c64a16a0, connected to MongoClient(host=['127.67.249.105:18940'], document_class=dict, tz_aware=False, connect=True)>

    def test_should_return_data_when_date_range_spans_libraries_even_if_one_returns_nothing(toplevel_tickstore, arctic):
        arctic.initialize_library('FEED_2010.LEVEL1', tickstore.TICK_STORE_TYPE)
        arctic.initialize_library('FEED_2011.LEVEL1', tickstore.TICK_STORE_TYPE)
        tickstore_2010 = arctic['FEED_2010.LEVEL1']
        tickstore_2011 = arctic['FEED_2011.LEVEL1']
        toplevel_tickstore.add(DateRange(start=dt(2010, 1, 1), end=dt(2010, 12, 31, 23, 59, 59, 999000)), 'FEED_2010.LEVEL1')
        toplevel_tickstore.add(DateRange(start=dt(2011, 1, 1), end=dt(2011, 12, 31, 23, 59, 59, 999000)), 'FEED_2011.LEVEL1')
        dates = pd.date_range('20100101', periods=6, tz=mktz('Europe/London'))
        df_10 = pd.DataFrame(np.random.randn(6, 4), index=dates, columns=list('ABCD'))
        tickstore_2010.write('blah', df_10)
        dates = pd.date_range('20110201', periods=6, tz=mktz('Europe/London'))
        df_11 = pd.DataFrame(np.random.randn(6, 4), index=dates, columns=list('ABCD'))
        tickstore_2011.write('blah', df_11)
        res = toplevel_tickstore.read('blah', DateRange(start=dt(2010, 1, 2), end=dt(2011, 1, 4)), list('ABCD'))
        expected_df = df_10[1:]
>       assert_frame_equal(expected_df, res.tz_convert(mktz('Europe/London')))
[1m[31mE       AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/tickstore/test_toplevel.py[0m:101: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:36:43.484+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:36:43.486+0000 I CONTROL  [initandlisten] MongoDB starting : pid=31795 port=18940 dbpath=/tmp/tmp7nucqtsa 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:36:43.486+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:36:43.486+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:36:43.486+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:36:43.486+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:36:43.486+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:36:43.486+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:36:43.486+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:36:43.486+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:36:43.486+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:36:43.486+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 18940, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp7nucqtsa", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:36:43.487+0000 I STORAGE  [initandlisten] 
2021-01-13T15:36:43.487+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:36:43.487+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:36:43.487+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:36:43.986+0000 I STORAGE  [initandlisten] WiredTiger message [1610552203:986896][31795:0x7f903b001a80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:36:43.999+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:36:44.027+0000 I CONTROL  [initandlisten] 
2021-01-13T15:36:44.027+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:36:44.027+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:36:44.027+0000 I CONTROL  [initandlisten] 
2021-01-13T15:36:44.028+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: b6af6a03-9fa8-4a25-b66a-0cd4b14976a3
2021-01-13T15:36:44.047+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:36:44.047+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:36:44.047+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:36:44.047+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:36:44.047+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: aee99e68-bcda-4364-9283-331b422b66d4
2021-01-13T15:36:44.069+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:36:44.069+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp7nucqtsa/diagnostic.data'
2021-01-13T15:36:44.070+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:36:44.070+0000 I NETWORK  [initandlisten] waiting for connections on port 18940
2021-01-13T15:36:44.070+0000 I CONTROL  [LogicalSessionCacheReap] Sessions collection is not set up; waiting until next sessions reap interval: config.system.sessions does not exist
2021-01-13T15:36:44.070+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 8da0de1b-961c-47fb-a09c-e7e8bf23e07b
2021-01-13T15:36:44.080+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:47874 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:44.081+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:47876 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:44.086+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:47878 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:44.087+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:47880 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:44.099+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:36:44.100+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:36:44.100+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:44.105+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:36:44.105+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 8703665c-f579-47da-9f5a-a0b57ca065e3
2021-01-13T15:36:44.135+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:36:44.135+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:36:44.135+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:36:44.135+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-5103618145865075472
2021-01-13T15:36:44.135+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:44.137+0000 I SHARDING [conn4] Marking collection arctic_test.toplevel_tickstore.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:44.138+0000 I STORAGE  [conn4] createCollection: arctic_test.toplevel_tickstore.ARCTIC with generated UUID: b29ebcfc-40bb-4353-9f62-70c0f1b050ac
2021-01-13T15:36:44.158+0000 I SHARDING [conn4] Marking collection meta_db.settings as collection version: <unsharded>
2021-01-13T15:36:44.162+0000 I STORAGE  [conn4] createCollection: arctic_test.toplevel_tickstore with generated UUID: 95ff8969-12e3-47ce-826e-f50571775309
2021-01-13T15:36:44.196+0000 I INDEX    [conn4] build index on: arctic_test.toplevel_tickstore properties: { v: 2, key: { start: 1 }, name: "start_1", ns: "arctic_test.toplevel_tickstore", background: true }
2021-01-13T15:36:44.196+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:36:43,455 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:43,456 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:43,456 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp7nucqtsa
2021-01-13 15:36:43,456 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:36:43,456 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:43,456 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:43,456 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:36:43,468 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=18940 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp7nucqtsa
2021-01-13 15:36:43,469 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:36:43,470 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:36:43,470 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:18940
2021-01-13 15:36:44,076 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:36:44,077 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:18940
2021-01-13 15:36:44,085 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615290 for server to start successfully
2021-01-13 15:36:44,085 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:36:44,086 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
2021-01-13 15:36:44,159 DEBUG root Cache has expired data, fetching from slow path and reloading cache.
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp7nucqtsa
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=18940 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp7nucqtsa
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:18940
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:18940
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615290 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
[35mDEBUG   [0m root:arctic.py:234 Cache has expired data, fetching from slow path and reloading cache.
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:36:44.203+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:44.204+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1.ARCTIC with generated UUID: 97b0e88b-2eea-475a-9f84-28bb56e81ec8
2021-01-13T15:36:44.226+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1 with generated UUID: 828a4f52-7f2f-4f5b-b591-3ae4a91b8881
2021-01-13T15:36:44.255+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1 properties: { v: 2, key: { sy: 1, s: 1 }, name: "sy_1_s_1", ns: "arctic_FEED_2010.LEVEL1", background: true }
2021-01-13T15:36:44.255+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:44.266+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1 properties: { v: 2, key: { s: 1 }, name: "s_1", ns: "arctic_FEED_2010.LEVEL1", background: true }
2021-01-13T15:36:44.266+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:44.267+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1.metadata with generated UUID: 329a84e5-3194-4d1c-80d5-d65f9b2acafa
2021-01-13T15:36:44.287+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1.metadata as collection version: <unsharded>
2021-01-13T15:36:44.298+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1.metadata properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_FEED_2010.LEVEL1.metadata", background: true }
2021-01-13T15:36:44.298+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:44.302+0000 I SHARDING [conn4] Marking collection arctic_FEED_2011.LEVEL1.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:44.302+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2011.LEVEL1.ARCTIC with generated UUID: eeaf10d9-0b1b-46b4-8312-6cdc5e953ce6
2021-01-13T15:36:44.321+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2011.LEVEL1 with generated UUID: f84c3b50-3653-4cb1-90de-8fa8316944dc
2021-01-13T15:36:44.349+0000 I INDEX    [conn4] build index on: arctic_FEED_2011.LEVEL1 properties: { v: 2, key: { sy: 1, s: 1 }, name: "sy_1_s_1", ns: "arctic_FEED_2011.LEVEL1", background: true }
2021-01-13T15:36:44.349+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:44.362+0000 I INDEX    [conn4] build index on: arctic_FEED_2011.LEVEL1 properties: { v: 2, key: { s: 1 }, name: "s_1", ns: "arctic_FEED_2011.LEVEL1", background: true }
2021-01-13T15:36:44.362+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:44.363+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2011.LEVEL1.metadata with generated UUID: 39400899-8568-4009-8b11-732ac93b66cb
2021-01-13T15:36:44.383+0000 I SHARDING [conn4] Marking collection arctic_FEED_2011.LEVEL1.metadata as collection version: <unsharded>
2021-01-13T15:36:44.395+0000 I INDEX    [conn4] build index on: arctic_FEED_2011.LEVEL1.metadata properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_FEED_2011.LEVEL1.metadata", background: true }
2021-01-13T15:36:44.395+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:44.401+0000 I SHARDING [conn4] Marking collection arctic_test.toplevel_tickstore as collection version: <unsharded>
2021-01-13T15:36:44.407+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1 as collection version: <unsharded>
2021-01-13T15:36:44.413+0000 I SHARDING [conn4] Marking collection arctic_FEED_2011.LEVEL1 as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:36:44,408 WARNING arctic.tickstore.tickstore NB treating all values as 'exists' - no longer sparse
2021-01-13 15:36:44,411 DEBUG arctic.tickstore.tickstore 1 buckets in 0.001326: approx 75414781 ticks/sec
2021-01-13 15:36:44,414 WARNING arctic.tickstore.tickstore NB treating all values as 'exists' - no longer sparse
2021-01-13 15:36:44,416 DEBUG arctic.tickstore.tickstore 1 buckets in 0.000912: approx 109649122 ticks/sec
2021-01-13 15:36:44,422 INFO arctic.tickstore.tickstore Got data in 0.00484 secs, creating DataFrame...
2021-01-13 15:36:44,423 INFO arctic.tickstore.tickstore 6 rows in 0.006111 secs: 981 ticks/sec
------------------------------ Captured log call -------------------------------
[33mWARNING [0m arctic.tickstore.tickstore:tickstore.py:706 NB treating all values as 'exists' - no longer sparse
[35mDEBUG   [0m arctic.tickstore.tickstore:tickstore.py:612 1 buckets in 0.001326: approx 75414781 ticks/sec
[33mWARNING [0m arctic.tickstore.tickstore:tickstore.py:706 NB treating all values as 'exists' - no longer sparse
[35mDEBUG   [0m arctic.tickstore.tickstore:tickstore.py:612 1 buckets in 0.000912: approx 109649122 ticks/sec
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:355 Got data in 0.00484 secs, creating DataFrame...
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:364 6 rows in 0.006111 secs: 981 ticks/sec
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:36:44,457 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 31795 (total_procs_to_kill=1)
2021-01-13 15:36:44,457 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:36:44,458 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:36:44,462 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:36:44,462 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:44,462 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:44,463 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp7nucqtsa
2021-01-13 15:36:44,463 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:44,463 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 31795 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp7nucqtsa
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m________________ test_should_write_top_level_with_list_of_dicts ________________[0m

arctic = <Arctic at 0x7f84c6719048, connected to MongoClient(host=['127.67.249.105:25758'], document_class=dict, tz_aware=False, connect=True)>

    def test_should_write_top_level_with_list_of_dicts(arctic):
        arctic.initialize_library('FEED_2010.LEVEL1', tickstore.TICK_STORE_TYPE)
        arctic.initialize_library('FEED_2011.LEVEL1', tickstore.TICK_STORE_TYPE)
        arctic.initialize_library('FEED.LEVEL1', toplevel.TICK_STORE_TYPE)
        toplevel_tickstore = arctic['FEED.LEVEL1']
        dates = pd.date_range('20101201', periods=57, tz=mktz('Europe/London'))
        data = [{'index': dates[i], 'a': i} for i in range(len(dates))]
        expected = pd.DataFrame(np.arange(57, dtype=np.float64), index=dates, columns=list('a'))
        toplevel_tickstore.write('blah', data)
        res = toplevel_tickstore.read('blah', DateRange(start=dt(2010, 12, 1), end=dt(2011, 2, 1)), columns=list('a'))
>       assert_frame_equal(expected, res.tz_convert(mktz('Europe/London')))
[1m[31mE       AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/tickstore/test_toplevel.py[0m:197: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:36:53.029+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:36:53.031+0000 I CONTROL  [initandlisten] MongoDB starting : pid=32151 port=25758 dbpath=/tmp/tmp6z08xk0_ 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:36:53.031+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:36:53.031+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:36:53.031+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:36:53.031+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:36:53.031+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:36:53.031+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:36:53.031+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:36:53.031+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:36:53.031+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:36:53.031+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 25758, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmp6z08xk0_", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:36:53.031+0000 I STORAGE  [initandlisten] 
2021-01-13T15:36:53.031+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:36:53.032+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:36:53.032+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:36:53.533+0000 I STORAGE  [initandlisten] WiredTiger message [1610552213:533816][32151:0x7fae88b6ca80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:36:53.547+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:36:53.573+0000 I CONTROL  [initandlisten] 
2021-01-13T15:36:53.574+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:36:53.574+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:36:53.574+0000 I CONTROL  [initandlisten] 
2021-01-13T15:36:53.574+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 28248820-ea9f-47c9-9925-8a7c48ec9c2f
2021-01-13T15:36:53.593+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:36:53.593+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:36:53.593+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:36:53.594+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:36:53.594+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 0517e466-ec3c-49f0-a0dd-aa58089adb0b
2021-01-13T15:36:53.613+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:36:53.613+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmp6z08xk0_/diagnostic.data'
2021-01-13T15:36:53.614+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:36:53.614+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: e06b2b74-fa03-4e97-8280-9479c4bf29be
2021-01-13T15:36:53.615+0000 I NETWORK  [initandlisten] waiting for connections on port 25758
2021-01-13T15:36:53.625+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:33112 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:53.626+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:33114 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:53.630+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:33116 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:53.632+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:33118 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:53.642+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:36:53.642+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:36:53.642+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:36:53.642+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6--6169859336226776818
2021-01-13T15:36:53.642+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:53.643+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:36:53.646+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:36:53.646+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: 9918709f-3a25-403a-b2d7-d5f2abc83842
2021-01-13T15:36:53.680+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:36:53.680+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:36:53.680+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:36:53.680+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9--6169859336226776818
2021-01-13T15:36:53.680+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:36:53,000 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:53,001 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:53,001 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmp6z08xk0_
2021-01-13 15:36:53,001 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:36:53,001 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:53,001 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:53,002 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:36:53,014 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=25758 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp6z08xk0_
2021-01-13 15:36:53,014 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:36:53,015 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:36:53,015 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:25758
2021-01-13 15:36:53,621 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:36:53,622 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:25758
2021-01-13 15:36:53,630 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615276 for server to start successfully
2021-01-13 15:36:53,630 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:36:53,631 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmp6z08xk0_
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=25758 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmp6z08xk0_
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:25758
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:25758
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615276 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:36:53.683+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:53.683+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1.ARCTIC with generated UUID: e4f5ddf0-b327-4770-a240-7960c1db6f4f
2021-01-13T15:36:53.706+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1 with generated UUID: e36433a2-99ff-4ddc-8b9d-1a51ee48f704
2021-01-13T15:36:53.736+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1 properties: { v: 2, key: { sy: 1, s: 1 }, name: "sy_1_s_1", ns: "arctic_FEED_2010.LEVEL1", background: true }
2021-01-13T15:36:53.736+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:53.746+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1 properties: { v: 2, key: { s: 1 }, name: "s_1", ns: "arctic_FEED_2010.LEVEL1", background: true }
2021-01-13T15:36:53.746+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:53.747+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1.metadata with generated UUID: afc7584e-1a5a-49b4-85d3-9fe631bd9111
2021-01-13T15:36:53.767+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1.metadata as collection version: <unsharded>
2021-01-13T15:36:53.778+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1.metadata properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_FEED_2010.LEVEL1.metadata", background: true }
2021-01-13T15:36:53.779+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:53.783+0000 I SHARDING [conn4] Marking collection arctic_FEED_2011.LEVEL1.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:53.783+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2011.LEVEL1.ARCTIC with generated UUID: 6e1a7568-229a-459d-809b-628c150755d6
2021-01-13T15:36:53.806+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2011.LEVEL1 with generated UUID: fb56d6f8-985d-41a5-bce6-93472d7719df
2021-01-13T15:36:53.837+0000 I INDEX    [conn4] build index on: arctic_FEED_2011.LEVEL1 properties: { v: 2, key: { sy: 1, s: 1 }, name: "sy_1_s_1", ns: "arctic_FEED_2011.LEVEL1", background: true }
2021-01-13T15:36:53.838+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:53.849+0000 I INDEX    [conn4] build index on: arctic_FEED_2011.LEVEL1 properties: { v: 2, key: { s: 1 }, name: "s_1", ns: "arctic_FEED_2011.LEVEL1", background: true }
2021-01-13T15:36:53.850+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:53.851+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2011.LEVEL1.metadata with generated UUID: f1760c8a-10c2-4df0-b2e3-518b33fa23dd
2021-01-13T15:36:53.872+0000 I SHARDING [conn4] Marking collection arctic_FEED_2011.LEVEL1.metadata as collection version: <unsharded>
2021-01-13T15:36:53.883+0000 I INDEX    [conn4] build index on: arctic_FEED_2011.LEVEL1.metadata properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_FEED_2011.LEVEL1.metadata", background: true }
2021-01-13T15:36:53.883+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:53.887+0000 I SHARDING [conn4] Marking collection arctic_FEED.LEVEL1.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:53.887+0000 I STORAGE  [conn4] createCollection: arctic_FEED.LEVEL1.ARCTIC with generated UUID: ae0de8ee-a1bf-4cdb-bf52-a9c2ac6abfe9
2021-01-13T15:36:53.905+0000 I SHARDING [conn4] Marking collection meta_db.settings as collection version: <unsharded>
2021-01-13T15:36:53.909+0000 I SHARDING [conn4] Marking collection arctic_FEED.LEVEL1 as collection version: <unsharded>
2021-01-13T15:36:53.909+0000 I STORAGE  [conn4] createCollection: arctic_FEED.LEVEL1 with generated UUID: cfd32d05-1c19-4d57-966d-9a1482597d63
2021-01-13T15:36:53.941+0000 I INDEX    [conn4] build index on: arctic_FEED.LEVEL1 properties: { v: 2, key: { start: 1 }, name: "start_1", ns: "arctic_FEED.LEVEL1", background: true }
2021-01-13T15:36:53.941+0000 I INDEX    [conn4] build index done.  scanned 2 total records. 0 secs
2021-01-13T15:36:53.950+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1 as collection version: <unsharded>
2021-01-13T15:36:53.956+0000 I SHARDING [conn4] Marking collection arctic_FEED_2011.LEVEL1 as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:36:53,955 DEBUG arctic.tickstore.tickstore 1 buckets in 0.001238: approx 80775444 ticks/sec
2021-01-13 15:36:53,961 DEBUG arctic.tickstore.tickstore 1 buckets in 0.001106: approx 90415913 ticks/sec
2021-01-13 15:36:53,967 INFO arctic.tickstore.tickstore Got data in 0.004656 secs, creating DataFrame...
2021-01-13 15:36:53,968 INFO arctic.tickstore.tickstore 31 rows in 0.005785 secs: 5358 ticks/sec
2021-01-13 15:36:53,974 INFO arctic.tickstore.tickstore Got data in 0.004574 secs, creating DataFrame...
2021-01-13 15:36:53,975 INFO arctic.tickstore.tickstore 26 rows in 0.005681 secs: 4576 ticks/sec
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.tickstore.tickstore:tickstore.py:612 1 buckets in 0.001238: approx 80775444 ticks/sec
[35mDEBUG   [0m arctic.tickstore.tickstore:tickstore.py:612 1 buckets in 0.001106: approx 90415913 ticks/sec
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:355 Got data in 0.004656 secs, creating DataFrame...
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:364 31 rows in 0.005785 secs: 5358 ticks/sec
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:355 Got data in 0.004574 secs, creating DataFrame...
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:364 26 rows in 0.005681 secs: 4576 ticks/sec
--------------------------- Captured stdout teardown ---------------------------
2021-01-13T15:36:54.000+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:36:54,008 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 32151 (total_procs_to_kill=1)
2021-01-13 15:36:54,008 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:36:54,009 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:36:54,016 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:36:54,017 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:54,017 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:54,017 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmp6z08xk0_
2021-01-13 15:36:54,017 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:54,017 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 32151 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmp6z08xk0_
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m______________ test_should_write_top_level_with_correct_timezone _______________[0m

arctic = <Arctic at 0x7f84e4061438, connected to MongoClient(host=['127.67.249.105:27088'], document_class=dict, tz_aware=False, connect=True)>

    def test_should_write_top_level_with_correct_timezone(arctic):
        # Write timezone aware data and read back in UTC
        utc = mktz('UTC')
        arctic.initialize_library('FEED_2010.LEVEL1', tickstore.TICK_STORE_TYPE)
        arctic.initialize_library('FEED_2011.LEVEL1', tickstore.TICK_STORE_TYPE)
        arctic.initialize_library('FEED.LEVEL1', toplevel.TICK_STORE_TYPE)
        toplevel_tickstore = arctic['FEED.LEVEL1']
        dates = pd.date_range('20101230220000', periods=10, tz=mktz('America/New_York'))  # 10pm New York time is 3am next day UTC
        data = [{'index': dates[i], 'a': i} for i in range(len(dates))]
        expected = pd.DataFrame(np.arange(len(dates), dtype=np.float64), index=dates.tz_convert(utc), columns=list('a'))
        toplevel_tickstore.write('blah', data)
        res = toplevel_tickstore.read('blah', DateRange(start=dt(2010, 1, 1), end=dt(2011, 12, 31)), columns=list('a')).tz_convert(utc)
>       assert_frame_equal(expected, res)
[1m[31mE       AssertionError: (<Day>, None)[0m

[1m[31mtests/integration/tickstore/test_toplevel.py[0m:215: AssertionError
---------------------------- Captured stdout setup -----------------------------
2021-01-13T15:36:54.050+0000 I CONTROL  [main] Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'
2021-01-13T15:36:54.052+0000 I CONTROL  [initandlisten] MongoDB starting : pid=32186 port=27088 dbpath=/tmp/tmpz23dcfdh 64-bit host=travis-job-e4e1ff55-a95a-4aff-afae-caac7bdabd5d
2021-01-13T15:36:54.052+0000 I CONTROL  [initandlisten] db version v4.0.19
2021-01-13T15:36:54.052+0000 I CONTROL  [initandlisten] git version: 7e28f4296a04d858a2e3dd84a1e79c9ba59a9568
2021-01-13T15:36:54.052+0000 I CONTROL  [initandlisten] OpenSSL version: OpenSSL 1.0.2g  1 Mar 2016
2021-01-13T15:36:54.052+0000 I CONTROL  [initandlisten] allocator: tcmalloc
2021-01-13T15:36:54.052+0000 I CONTROL  [initandlisten] modules: none
2021-01-13T15:36:54.052+0000 I CONTROL  [initandlisten] build environment:
2021-01-13T15:36:54.052+0000 I CONTROL  [initandlisten]     distmod: ubuntu1604
2021-01-13T15:36:54.052+0000 I CONTROL  [initandlisten]     distarch: x86_64
2021-01-13T15:36:54.052+0000 I CONTROL  [initandlisten]     target_arch: x86_64
2021-01-13T15:36:54.052+0000 I CONTROL  [initandlisten] options: { net: { bindIp: "127.67.249.105", port: 27088, unixDomainSocket: { enabled: false } }, storage: { dbPath: "/tmp/tmpz23dcfdh", journal: { enabled: false }, syncPeriodSecs: 0.0 }, systemLog: { quiet: true } }
2021-01-13T15:36:54.052+0000 I STORAGE  [initandlisten] 
2021-01-13T15:36:54.052+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2021-01-13T15:36:54.052+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2021-01-13T15:36:54.052+0000 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=3476M,cache_overflow=(file_max=0M),session_max=20000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),statistics_log=(wait=0),verbose=(recovery_progress),,log=(enabled=false),
2021-01-13T15:36:54.551+0000 I STORAGE  [initandlisten] WiredTiger message [1610552214:551290][32186:0x7feef6d1aa80], txn-recover: Set global recovery timestamp: 0
2021-01-13T15:36:54.564+0000 I RECOVERY [initandlisten] WiredTiger recoveryTimestamp. Ts: Timestamp(0, 0)
2021-01-13T15:36:54.590+0000 I CONTROL  [initandlisten] 
2021-01-13T15:36:54.590+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2021-01-13T15:36:54.590+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2021-01-13T15:36:54.590+0000 I CONTROL  [initandlisten] 
2021-01-13T15:36:54.591+0000 I STORAGE  [initandlisten] createCollection: admin.system.version with provided UUID: 909454a8-926a-401d-8e04-290f282fc928
2021-01-13T15:36:54.612+0000 I SHARDING [initandlisten] Marking collection admin.system.version as collection version: <unsharded>
2021-01-13T15:36:54.612+0000 I COMMAND  [initandlisten] setting featureCompatibilityVersion to 4.0
2021-01-13T15:36:54.612+0000 I SHARDING [initandlisten] Marking collection local.system.replset as collection version: <unsharded>
2021-01-13T15:36:54.612+0000 I SHARDING [initandlisten] Marking collection admin.system.roles as collection version: <unsharded>
2021-01-13T15:36:54.612+0000 I STORAGE  [initandlisten] createCollection: local.startup_log with generated UUID: 93607811-2e24-4a76-8772-f5d75cac92b8
2021-01-13T15:36:54.632+0000 I SHARDING [initandlisten] Marking collection local.startup_log as collection version: <unsharded>
2021-01-13T15:36:54.633+0000 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory '/tmp/tmpz23dcfdh/diagnostic.data'
2021-01-13T15:36:54.634+0000 I SHARDING [LogicalSessionCacheRefresh] Marking collection config.system.sessions as collection version: <unsharded>
2021-01-13T15:36:54.634+0000 I STORAGE  [LogicalSessionCacheRefresh] createCollection: config.system.sessions with generated UUID: 5d8e0925-74be-43e6-a464-820080a47829
2021-01-13T15:36:54.634+0000 I NETWORK  [initandlisten] waiting for connections on port 27088
2021-01-13T15:36:54.646+0000 I NETWORK  [conn1] received client metadata from 127.0.0.1:56650 conn1: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:54.647+0000 I NETWORK  [conn2] received client metadata from 127.0.0.1:56652 conn2: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:54.651+0000 I NETWORK  [conn3] received client metadata from 127.0.0.1:56654 conn3: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:54.653+0000 I NETWORK  [conn4] received client metadata from 127.0.0.1:56656 conn4: { driver: { name: "PyMongo", version: "3.11.2" }, os: { type: "Linux", name: "Linux", architecture: "x86_64", version: "4.15.0-1077-gcp" }, platform: "CPython 3.6.7.final.0" }
2021-01-13T15:36:54.671+0000 I INDEX    [LogicalSessionCacheRefresh] build index on: config.system.sessions properties: { v: 2, key: { lastUse: 1 }, name: "lsidTTLIndex", ns: "config.system.sessions", expireAfterSeconds: 1800 }
2021-01-13T15:36:54.671+0000 I INDEX    [LogicalSessionCacheRefresh] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:36:54.671+0000 W STORAGE  [LogicalSessionCacheRefresh] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:36:54.671+0000 W STORAGE  [LogicalSessionCacheRefresh] falling back to non-bulk cursor for index table:index-6-8040307382550566681
2021-01-13T15:36:54.671+0000 I INDEX    [LogicalSessionCacheRefresh] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:54.671+0000 I SHARDING [LogicalSessionCacheReap] Marking collection config.transactions as collection version: <unsharded>
2021-01-13T15:36:54.674+0000 I SHARDING [conn4] Marking collection meta_db.cache as collection version: <unsharded>
2021-01-13T15:36:54.674+0000 I STORAGE  [conn4] createCollection: meta_db.cache with generated UUID: d57ac3e1-ab60-4c6d-b52a-cf6488031648
2021-01-13T15:36:54.708+0000 I INDEX    [conn4] build index on: meta_db.cache properties: { v: 2, key: { date: 1 }, name: "date_1", ns: "meta_db.cache", expireAfterSeconds: 3600 }
2021-01-13T15:36:54.708+0000 I INDEX    [conn4] 	 building index using bulk method; build may temporarily use up to 500 megabytes of RAM
2021-01-13T15:36:54.708+0000 W STORAGE  [conn4] failed to create WiredTiger bulk cursor: Device or resource busy
2021-01-13T15:36:54.708+0000 W STORAGE  [conn4] falling back to non-bulk cursor for index table:index-9-8040307382550566681
2021-01-13T15:36:54.708+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
---------------------------- Captured stderr setup -----------------------------
2021-01-13 15:36:54,020 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:54,020 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:54,021 DEBUG pytest_shutil.workspace pytest_shutil created workspace /tmp/tmpz23dcfdh
2021-01-13 15:36:54,021 DEBUG pytest_shutil.workspace This workspace will delete itself on teardown
2021-01-13 15:36:54,021 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:54,021 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:54,021 DEBUG pytest_server_fixtures.serverclass.thread Launching thread server.
2021-01-13 15:36:54,034 DEBUG pytest_server_fixtures.serverclass.thread Running server: mongod --bind_ip=127.67.249.105 --port=27088 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpz23dcfdh
2021-01-13 15:36:54,035 DEBUG pytest_server_fixtures.serverclass.thread CWD: /home/travis/build/man-group/arctic
2021-01-13 15:36:54,036 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (1 of 28)
2021-01-13 15:36:54,036 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:27088
2021-01-13 15:36:54,642 DEBUG pytest_server_fixtures.base2 sleeping for 0.1 before retrying (2 of 28)
2021-01-13 15:36:54,643 INFO pytest_server_fixtures.mongo Connecting to Mongo at 127.67.249.105:27088
2021-01-13 15:36:54,651 DEBUG pytest_server_fixtures.base2 waited 0:00:00.615303 for server to start successfully
2021-01-13 15:36:54,651 DEBUG pytest_server_fixtures.base2 Server now awake
2021-01-13 15:36:54,652 INFO arctic.fixtures.arctic arctic.fixtures: arctic init()
------------------------------ Captured log setup ------------------------------
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:52 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:53 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:56 pytest_shutil created workspace /tmp/tmpz23dcfdh
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:64 This workspace will delete itself on teardown
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:65 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:66 
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:77 Launching thread server.
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:89 Running server: mongod --bind_ip=127.67.249.105 --port=27088 --nounixsocket --syncdelay=0 --nojournal --quiet --dbpath=/tmp/tmpz23dcfdh
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:90 CWD: /home/travis/build/man-group/arctic
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (1 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:27088
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:226 sleeping for 0.1 before retrying (2 of 28)
[32mINFO    [0m pytest_server_fixtures.mongo:mongo.py:128 Connecting to Mongo at 127.67.249.105:27088
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:229 waited 0:00:00.615303 for server to start successfully
[35mDEBUG   [0m pytest_server_fixtures.base2:base2.py:69 Server now awake
[32mINFO    [0m arctic.fixtures.arctic:arctic.py:23 arctic.fixtures: arctic init()
----------------------------- Captured stdout call -----------------------------
2021-01-13T15:36:54.712+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:54.712+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1.ARCTIC with generated UUID: ed1513e5-4b4f-4929-aa7a-51bcbeb20889
2021-01-13T15:36:54.735+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1 with generated UUID: 08e347fc-5978-4599-8d2f-443b9dbe497c
2021-01-13T15:36:54.771+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1 properties: { v: 2, key: { sy: 1, s: 1 }, name: "sy_1_s_1", ns: "arctic_FEED_2010.LEVEL1", background: true }
2021-01-13T15:36:54.771+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:54.782+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1 properties: { v: 2, key: { s: 1 }, name: "s_1", ns: "arctic_FEED_2010.LEVEL1", background: true }
2021-01-13T15:36:54.782+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:54.783+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2010.LEVEL1.metadata with generated UUID: f53d7566-8dda-4838-96c8-82292e7072ba
2021-01-13T15:36:54.806+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1.metadata as collection version: <unsharded>
2021-01-13T15:36:54.817+0000 I INDEX    [conn4] build index on: arctic_FEED_2010.LEVEL1.metadata properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_FEED_2010.LEVEL1.metadata", background: true }
2021-01-13T15:36:54.817+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:54.822+0000 I SHARDING [conn4] Marking collection arctic_FEED_2011.LEVEL1.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:54.822+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2011.LEVEL1.ARCTIC with generated UUID: 35be8fff-a436-47a2-aa72-bb112a17c75f
2021-01-13T15:36:54.844+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2011.LEVEL1 with generated UUID: 605e58ab-47f7-449c-a2e2-3ff4a400c728
2021-01-13T15:36:54.874+0000 I INDEX    [conn4] build index on: arctic_FEED_2011.LEVEL1 properties: { v: 2, key: { sy: 1, s: 1 }, name: "sy_1_s_1", ns: "arctic_FEED_2011.LEVEL1", background: true }
2021-01-13T15:36:54.874+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:54.886+0000 I INDEX    [conn4] build index on: arctic_FEED_2011.LEVEL1 properties: { v: 2, key: { s: 1 }, name: "s_1", ns: "arctic_FEED_2011.LEVEL1", background: true }
2021-01-13T15:36:54.886+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:54.887+0000 I STORAGE  [conn4] createCollection: arctic_FEED_2011.LEVEL1.metadata with generated UUID: f5d82b36-6be2-4e00-baff-78f9c511ce79
2021-01-13T15:36:54.909+0000 I SHARDING [conn4] Marking collection arctic_FEED_2011.LEVEL1.metadata as collection version: <unsharded>
2021-01-13T15:36:54.921+0000 I INDEX    [conn4] build index on: arctic_FEED_2011.LEVEL1.metadata properties: { v: 2, unique: true, key: { sy: 1 }, name: "sy_1", ns: "arctic_FEED_2011.LEVEL1.metadata", background: true }
2021-01-13T15:36:54.921+0000 I INDEX    [conn4] build index done.  scanned 0 total records. 0 secs
2021-01-13T15:36:54.925+0000 I SHARDING [conn4] Marking collection arctic_FEED.LEVEL1.ARCTIC as collection version: <unsharded>
2021-01-13T15:36:54.925+0000 I STORAGE  [conn4] createCollection: arctic_FEED.LEVEL1.ARCTIC with generated UUID: e10ebcc9-90c7-4e09-ae7e-3d109b704cf0
2021-01-13T15:36:54.946+0000 I SHARDING [conn4] Marking collection meta_db.settings as collection version: <unsharded>
2021-01-13T15:36:54.949+0000 I SHARDING [conn4] Marking collection arctic_FEED.LEVEL1 as collection version: <unsharded>
2021-01-13T15:36:54.950+0000 I STORAGE  [conn4] createCollection: arctic_FEED.LEVEL1 with generated UUID: b03bfc3b-a295-4ee3-8951-f443edb94ce6
2021-01-13T15:36:54.983+0000 I INDEX    [conn4] build index on: arctic_FEED.LEVEL1 properties: { v: 2, key: { start: 1 }, name: "start_1", ns: "arctic_FEED.LEVEL1", background: true }
2021-01-13T15:36:54.983+0000 I INDEX    [conn4] build index done.  scanned 2 total records. 0 secs
2021-01-13T15:36:54.991+0000 I SHARDING [conn4] Marking collection arctic_FEED_2010.LEVEL1 as collection version: <unsharded>
2021-01-13T15:36:54.995+0000 I SHARDING [conn4] Marking collection arctic_FEED_2011.LEVEL1 as collection version: <unsharded>
2021-01-13T15:36:55.002+0000 I SHARDING [ftdc] Marking collection local.oplog.rs as collection version: <unsharded>
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:36:54,994 DEBUG arctic.tickstore.tickstore 1 buckets in 0.001201: approx 83263946 ticks/sec
2021-01-13 15:36:54,998 DEBUG arctic.tickstore.tickstore 1 buckets in 0.001116: approx 89605734 ticks/sec
2021-01-13 15:36:55,004 INFO arctic.tickstore.tickstore Got data in 0.004836 secs, creating DataFrame...
2021-01-13 15:36:55,006 INFO arctic.tickstore.tickstore 1 rows in 0.006157 secs: 162 ticks/sec
2021-01-13 15:36:55,010 INFO arctic.tickstore.tickstore Got data in 0.003192 secs, creating DataFrame...
2021-01-13 15:36:55,011 INFO arctic.tickstore.tickstore 9 rows in 0.004197 secs: 2144 ticks/sec
------------------------------ Captured log call -------------------------------
[35mDEBUG   [0m arctic.tickstore.tickstore:tickstore.py:612 1 buckets in 0.001201: approx 83263946 ticks/sec
[35mDEBUG   [0m arctic.tickstore.tickstore:tickstore.py:612 1 buckets in 0.001116: approx 89605734 ticks/sec
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:355 Got data in 0.004836 secs, creating DataFrame...
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:364 1 rows in 0.006157 secs: 162 ticks/sec
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:355 Got data in 0.003192 secs, creating DataFrame...
[32mINFO    [0m arctic.tickstore.tickstore:tickstore.py:364 9 rows in 0.004197 secs: 2144 ticks/sec
--------------------------- Captured stderr teardown ---------------------------
2021-01-13 15:36:55,043 DEBUG pytest_server_fixtures.serverclass.thread Killing process tree for 32186 (total_procs_to_kill=1)
2021-01-13 15:36:55,043 DEBUG pytest_server_fixtures.serverclass.thread Killing 1 processes with signal Signals.SIGKILL
2021-01-13 15:36:55,043 DEBUG pytest_server_fixtures.serverclass.thread Waiting for 1 processes to die
2021-01-13 15:36:55,047 DEBUG pytest_server_fixtures.serverclass.thread All processes are terminated
2021-01-13 15:36:55,048 DEBUG pytest_shutil.workspace 
2021-01-13 15:36:55,048 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:55,048 DEBUG pytest_shutil.workspace pytest_shutil deleting workspace /tmp/tmpz23dcfdh
2021-01-13 15:36:55,048 DEBUG pytest_shutil.workspace =======================================================
2021-01-13 15:36:55,048 DEBUG pytest_shutil.workspace 
---------------------------- Captured log teardown -----------------------------
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:54 Killing process tree for 32186 (total_procs_to_kill=1)
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:35 Killing 1 processes with signal Signals.SIGKILL
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:39 Waiting for 1 processes to die
[35mDEBUG   [0m pytest_server_fixtures.serverclass.thread:thread.py:43 All processes are terminated
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:140 
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:141 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:142 pytest_shutil deleting workspace /tmp/tmpz23dcfdh
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:143 =======================================================
[35mDEBUG   [0m pytest_shutil.workspace:workspace.py:144
[31m[1m_______________ test_ArcticTransaction_detects_concurrent_writes _______________[0m

    def test_ArcticTransaction_detects_concurrent_writes():
        vs = Mock(spec=VersionStore)
        ts1 = pd.DataFrame(index=[1, 2], data={'a': [1.0, 2.0]})
        vs.read.return_value = VersionedItem(symbol=sentinel.symbol, library=sentinel.library, version=1, metadata=None,
                                             data=ts1, host=sentinel.host)
        vs.write.side_effect = [VersionedItem(symbol=sentinel.symbol, library=sentinel.library, version=2, metadata=None,
                                              data=None, host=sentinel.host),
                                VersionedItem(symbol=sentinel.symbol, library=sentinel.library, version=3, metadata=None,
                                              data=None, host=sentinel.host)]
        # note that we return some extra version 5, it is possible that we have a write coming in after our own write that gets picked up
        vs.list_versions.side_effect = [[{'version': 5}, {'version': 2}, {'version': 1}, ],
                                       [{'version': 5}, {'version': 3}, {'version': 2}, {'version': 1}, ]]
        from threading import Event, Thread
        e1 = Event()
        e2 = Event()
    
        def losing_writer():
            # will attempt to write version 2, should find that version 2 is there and it ends up writing version 3
            with pytest.raises(ArcticTransaction):
                with ArcticTransaction(vs, sentinel.symbol, sentinel.user, sentinel.log) as cwb:
                    cwb.write(sentinel.symbol, pd.DataFrame([1.0, 2.0], [3, 4]))
                    e1.wait()
    
        def winning_writer():
            # will attempt to write version 2 as well
            with ArcticTransaction(vs, sentinel.symbol, sentinel.user, sentinel.log) as cwb:
                cwb.write(sentinel.symbol, pd.DataFrame([1.0, 2.0], [5, 6]))
                e2.wait()
    
        t1 = Thread(target=losing_writer)
        t2 = Thread(target=winning_writer)
        t1.start()
        t2.start()
    
        # both read the same timeseries and are locked doing some 'work'
        e2.set()
        # t2  should now be able to finish
        t2.join()
        e1.set()
        t1.join()
    
        # we're expecting the losing_writer to undo its write once it realises that it wrote v3 instead of v2
>       vs._delete_version.assert_called_once_with(sentinel.symbol, 3)

[1m[31mtests/unit/store/test_version_store_audit.py[0m:221: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

_mock_self = <Mock name='mock._delete_version' id='140207817640312'>
args = (sentinel.symbol, 3), kwargs = {}
self = <Mock name='mock._delete_version' id='140207817640312'>
msg = "Expected '_delete_version' to be called once. Called 0 times."

    def assert_called_once_with(_mock_self, *args, **kwargs):
        """assert that the mock was called exactly once and that that call was
        with the specified arguments."""
        self = _mock_self
        if not self.call_count == 1:
            msg = ("Expected '%s' to be called once. Called %s times.%s"
                   % (self._mock_name or 'mock',
                      self.call_count,
                      self._calls_repr()))
>           raise AssertionError(msg)
[1m[31mE           AssertionError: Expected '_delete_version' to be called once. Called 0 times.[0m

[1m[31m../../../virtualenv/python3.6.7/lib/python3.6/site-packages/mock/mock.py[0m:925: AssertionError
----------------------------- Captured stderr call -----------------------------
2021-01-13 15:40:04,084 INFO arctic.store.audit MT: None@None: [sentinel.user] sentinel.log: sentinel.symbol
Exception in thread Thread-773:
Traceback (most recent call last):
  File "/opt/python/3.6.7/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/opt/python/3.6.7/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "/home/travis/build/man-group/arctic/tests/unit/store/test_version_store_audit.py", line 197, in losing_writer
    with pytest.raises(ArcticTransaction):
  File "/home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages/_pytest/python_api.py", line 719, in raises
    raise TypeError(msg.format(not_a))
TypeError: expected exception must be a BaseException type, not ArcticTransaction

------------------------------ Captured log call -------------------------------
[32mINFO    [0m arctic.store.audit:audit.py:87 MT: None@None: [sentinel.user] sentinel.log: sentinel.symbol
[33m=============================== warnings summary ===============================[0m
tests/integration/test_arctic.py:6
  /home/travis/build/man-group/arctic/tests/integration/test_arctic.py:6: FutureWarning: pandas.util.testing is deprecated. Use the functions in the public API at pandas.testing instead.
    from pandas.util.testing import assert_frame_equal

tests/integration/tickstore/test_ts_read.py:9
  /home/travis/build/man-group/arctic/tests/integration/tickstore/test_ts_read.py:9: DeprecationWarning: Importing from numpy.testing.utils is deprecated since 1.15.0, import from numpy.testing instead.
    from numpy.testing.utils import assert_array_equal

tests/integration/test_arctic.py: 4 warnings
tests/integration/test_concurrent_append.py: 1 warning
tests/integration/test_howtos.py: 3 warnings
tests/integration/scripts/test_arctic_fsck.py: 45 warnings
tests/integration/scripts/test_copy_data.py: 23 warnings
tests/integration/store/test_bitemporal_store.py: 43 warnings
tests/integration/store/test_ndarray_store.py: 37 warnings
tests/integration/store/test_ndarray_store_append.py: 69 warnings
tests/integration/store/test_pandas_store.py: 378 warnings
tests/integration/store/test_version_store.py: 647 warnings
tests/integration/store/test_version_store_audit.py: 29 warnings
tests/integration/store/test_version_store_corruption.py: 14 warnings
  /home/travis/build/man-group/arctic/arctic/store/_ndarray_store.py:600: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    sha.update(item.tostring())

tests/integration/test_arctic.py: 3 warnings
tests/integration/test_howtos.py: 3 warnings
tests/integration/scripts/test_arctic_fsck.py: 42 warnings
tests/integration/scripts/test_copy_data.py: 21 warnings
tests/integration/store/test_bitemporal_store.py: 29 warnings
tests/integration/store/test_ndarray_store.py: 828 warnings
tests/integration/store/test_ndarray_store_append.py: 314 warnings
tests/integration/store/test_pandas_store.py: 285 warnings
tests/integration/store/test_version_store.py: 570 warnings
tests/integration/store/test_version_store_audit.py: 21 warnings
tests/integration/store/test_version_store_corruption.py: 18 warnings
  /home/travis/build/man-group/arctic/arctic/store/_ndarray_store.py:657: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    chunks = [(item[i * rows_per_chunk: (i + 1) * rows_per_chunk]).tostring() for i in idxs]

tests/integration/test_arctic.py: 3 warnings
tests/integration/test_howtos.py: 3 warnings
tests/integration/scripts/test_arctic_fsck.py: 42 warnings
tests/integration/scripts/test_copy_data.py: 21 warnings
tests/integration/store/test_bitemporal_store.py: 29 warnings
tests/integration/store/test_pandas_store.py: 37 warnings
tests/integration/store/test_version_store.py: 1976 warnings
tests/integration/store/test_version_store_audit.py: 21 warnings
tests/integration/store/test_version_store_corruption.py: 138 warnings
  /home/travis/build/man-group/arctic/arctic/store/_pandas_ndarray_store.py:62: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    return Binary(compress(index.tostring()))

tests/integration/test_arctic.py: 5 warnings
tests/integration/scripts/test_delete_library.py: 5 warnings
  /home/travis/build/man-group/arctic/arctic/_cache.py:120: DeprecationWarning: update is deprecated. Use replace_one, update_one or update_many instead.
    {"$pull": {"data": item}}

tests/integration/test_arctic.py::test_list_libraries_cached
  /home/travis/build/man-group/arctic/tests/integration/test_arctic.py:250: DeprecationWarning: remove is deprecated. Use delete_one or delete_many instead.
    arctic._conn.meta_db.cache.remove({})

tests/integration/chunkstore/test_chunkstore.py: 9982 warnings
tests/integration/chunkstore/test_fixes.py: 91 warnings
tests/integration/chunkstore/test_utils.py: 2 warnings
tests/integration/chunkstore/tools/test_tools.py: 52 warnings
tests/unit/serialization/test_numpy_arrays.py: 26 warnings
  /home/travis/build/man-group/arctic/arctic/serialization/numpy_arrays.py:119: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    arrays.append(arr.tostring())

tests/integration/store/test_ndarray_store.py: 3 warnings
tests/integration/store/test_ndarray_store_append.py: 583 warnings
tests/integration/store/test_pandas_store.py: 19 warnings
tests/integration/store/test_version_store.py: 1546 warnings
tests/integration/store/test_version_store_corruption.py: 124 warnings
  /home/travis/build/man-group/arctic/arctic/store/_ndarray_store.py:449: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    data = item.tostring()

tests/integration/store/test_ndarray_store.py::test_save_read_large_ndarray
  /home/travis/build/man-group/arctic/tests/integration/store/test_ndarray_store.py:146: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    assert len(ndarr.tostring()) > 16 * 1024 * 1024

tests/integration/store/test_ndarray_store_append.py::test_append_read_large_ndarray[FwPointersCfg.DISABLED]
tests/integration/store/test_ndarray_store_append.py::test_append_read_large_ndarray[FwPointersCfg.HYBRID]
tests/integration/store/test_ndarray_store_append.py::test_append_read_large_ndarray[FwPointersCfg.ENABLED]
  /home/travis/build/man-group/arctic/tests/integration/store/test_ndarray_store_append.py:112: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    assert len(ndarr.tostring()) > 16 * 1024 * 1024

tests/integration/store/test_ndarray_store_append.py::test_save_append_read_ndarray[FwPointersCfg.DISABLED]
tests/integration/store/test_ndarray_store_append.py::test_save_append_read_ndarray[FwPointersCfg.HYBRID]
tests/integration/store/test_ndarray_store_append.py::test_save_append_read_ndarray[FwPointersCfg.ENABLED]
  /home/travis/build/man-group/arctic/tests/integration/store/test_ndarray_store_append.py:138: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    assert len(ndarr.tostring()) > 16 * 1024 * 1024

tests/integration/store/test_ndarray_store_append.py::test_save_append_read_1row_ndarray
  /home/travis/build/man-group/arctic/tests/integration/store/test_ndarray_store_append.py:155: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    assert len(ndarr.tostring()) > 16 * 1024 * 1024

tests/integration/store/test_ndarray_store_append.py::test_append_too_large_ndarray
  /home/travis/build/man-group/arctic/tests/integration/store/test_ndarray_store_append.py:172: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    assert len(ndarr.tostring()) > 16 * 1024 * 1024

tests/integration/store/test_pandas_store.py::test_save_read_pandas_empty_series_with_datetime_multiindex_with_timezone
  /home/travis/build/man-group/arctic/tests/integration/store/test_pandas_store.py:150: DeprecationWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
    df = Series(data=[], index=empty_index)

tests/integration/store/test_pandas_store.py::test_duplicate_labels
tests/integration/store/test_pandas_store.py::test_duplicate_labels
tests/integration/store/test_pandas_store.py::test_duplicate_labels
tests/integration/store/test_pandas_store.py::test_duplicate_labels
  /home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages/numpy/core/numeric.py:2378: DeprecationWarning: elementwise comparison failed; this will raise an error in the future.
    return bool(asarray(a1 == a2).all())

tests/integration/store/test_pickle_store.py::test_bson_large_object
  /home/travis/build/man-group/arctic/tests/integration/store/test_pickle_store.py:53: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    'large_thing': np.random.rand(int(2.1 * 1024 * 1024)).tostring()}

tests/integration/tickstore/test_toplevel.py: 44 warnings
tests/integration/tickstore/test_ts_read.py: 5 warnings
tests/integration/tickstore/test_ts_write.py: 2 warnings
tests/unit/tickstore/test_tickstore.py: 1 warning
  /home/travis/build/man-group/arctic/arctic/tickstore/tickstore.py:707: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    rowmask = Binary(lz4_compressHC(np.packbits(np.ones(len(df), dtype='uint8')).tostring()))

tests/integration/tickstore/test_toplevel.py: 176 warnings
tests/integration/tickstore/test_ts_read.py: 6 warnings
tests/integration/tickstore/test_ts_write.py: 6 warnings
tests/unit/tickstore/test_tickstore.py: 3 warnings
  /home/travis/build/man-group/arctic/arctic/tickstore/tickstore.py:718: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    DATA: Binary(lz4_compressHC(array.tostring())),

tests/integration/tickstore/test_toplevel.py: 44 warnings
tests/integration/tickstore/test_ts_read.py: 4 warnings
tests/integration/tickstore/test_ts_write.py: 2 warnings
tests/unit/tickstore/test_tickstore.py: 1 warning
  /home/travis/build/man-group/arctic/arctic/tickstore/tickstore.py:727: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    recs[index_name].astype('datetime64[ms]').view('uint64')))).tostring()))

tests/integration/tickstore/test_toplevel.py: 4 warnings
tests/integration/tickstore/test_ts_delete.py: 12 warnings
tests/integration/tickstore/test_ts_read.py: 141 warnings
tests/integration/tickstore/test_ts_write.py: 18 warnings
tests/unit/tickstore/test_tickstore.py: 8 warnings
  /home/travis/build/man-group/arctic/arctic/tickstore/tickstore.py:758: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    for k, v in iteritems(rowmask)])

tests/integration/tickstore/test_toplevel.py: 4 warnings
tests/integration/tickstore/test_ts_delete.py: 12 warnings
tests/integration/tickstore/test_ts_read.py: 141 warnings
tests/integration/tickstore/test_ts_write.py: 18 warnings
tests/unit/tickstore/test_tickstore.py: 8 warnings
  /home/travis/build/man-group/arctic/arctic/tickstore/tickstore.py:763: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    rtn[COLUMNS][k] = {DATA: Binary(lz4_compressHC(v.tostring())),

tests/integration/tickstore/test_toplevel.py: 4 warnings
tests/integration/tickstore/test_ts_delete.py: 6 warnings
tests/integration/tickstore/test_ts_read.py: 40 warnings
tests/integration/tickstore/test_ts_write.py: 7 warnings
tests/unit/tickstore/test_tickstore.py: 2 warnings
  /home/travis/build/man-group/arctic/arctic/tickstore/tickstore.py:776: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    rtn[INDEX] = Binary(lz4_compressHC(np.concatenate(([data['index'][0]], np.diff(data['index']))).tostring()))

tests/unit/chunkstore/test_passthrough_chunker.py::test_pass_thru
  /home/travis/build/man-group/arctic/arctic/chunkstore/passthrough_chunker.py:75: DeprecationWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
    return Series()

tests/unit/chunkstore/test_passthrough_chunker.py::test_pass_thru
  /home/travis/build/man-group/arctic/tests/unit/chunkstore/test_passthrough_chunker.py:18: DeprecationWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
    assert(p.exclude(Series([1, 2, 3]), None).equals(Series()))

tests/unit/serialization/test_incremental.py: 38 warnings
  /home/travis/build/man-group/arctic/tests/unit/serialization/test_incremental.py:53: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    matching = expectation[0].tostring() == incr_ser_data.tostring()

tests/unit/serialization/test_incremental.py: 41846 warnings
  /home/travis/build/man-group/arctic/arctic/serialization/incremental.py:223: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    chunk = chunk.tostring() if chunk is not None and get_bytes else chunk

tests/unit/serialization/test_incremental.py: 19 warnings
  /home/travis/build/man-group/arctic/tests/unit/serialization/test_incremental.py:73: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    matching = expectation[0].tostring() == b''.join(chunk_bytes)

tests/unit/serialization/test_incremental.py: 57 warnings
  /home/travis/build/man-group/arctic/tests/unit/serialization/test_incremental.py:101: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    matching = expectation[0].tostring() == b''.join(chunk_bytes)

tests/unit/serialization/test_incremental.py: 10 warnings
  /home/travis/build/man-group/arctic/tests/unit/serialization/test_incremental.py:136: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    matching = expectation[0][from_idx:to_idx].tostring() == b''.join(chunk_bytes)

tests/unit/serialization/test_numpy_arrays.py::test_string_cols_with_nans
tests/unit/serialization/test_numpy_arrays.py::test_objify_with_missing_columns
  /home/travis/build/man-group/arctic/arctic/serialization/numpy_arrays.py:118: DeprecationWarning: tostring() is deprecated. Use tobytes() instead.
    masks[str(c)] = Binary(compress(mask.tostring()))

tests/unit/store/test_pickle_store.py::test_unpickle_highest_protocol
  /home/travis/build/man-group/arctic/tests/unit/store/test_pickle_store.py:121: DeprecationWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
    'blob': compressHC(cPickle.dumps(pd.Series(), protocol=cPickle.HIGHEST_PROTOCOL)),

tests/unit/store/test_pickle_store.py::test_unpickle_highest_protocol
  /home/travis/build/man-group/arctic/tests/unit/store/test_pickle_store.py:127: DeprecationWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
    expected = pd.Series()

-- Docs: https://docs.pytest.org/en/stable/warnings.html
------ generated xml file: /home/travis/build/man-group/arctic/junit.xml -------

----------- coverage: platform linux, python 3.6.7-final-0 -----------
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml

=========================== short test summary info ============================
FAILED tests/integration/chunkstore/test_chunkstore.py::test_overwrite_series
FAILED tests/integration/chunkstore/test_chunkstore.py::test_quarterly_data
FAILED tests/integration/chunkstore/test_fixes.py::test_date_interval - Asser...
FAILED tests/integration/chunkstore/test_fixes.py::test_missing_cols - Assert...
FAILED tests/integration/store/test_pandas_store.py::test_save_read_pandas_series_with_unicode_index_name
FAILED tests/integration/store/test_pandas_store.py::test_save_read_pandas_dataframe_with_unicode_index_name
FAILED tests/integration/store/test_pandas_store.py::test_daterange_large_DataFrame
FAILED tests/integration/store/test_pandas_store.py::test_daterange_large_DataFrame_middle
FAILED tests/integration/store/test_pandas_store.py::test_daterange[df0-assert_frame_equal]
FAILED tests/integration/store/test_pandas_store.py::test_daterange[df1-assert_series_equal]
FAILED tests/integration/store/test_pandas_store.py::test_daterange_append - ...
FAILED tests/integration/store/test_version_store.py::test_write_metadata[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_write_metadata[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_write_metadata[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_followed_by_append[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_followed_by_append[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_followed_by_append[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_purge_previous_versions[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_purge_previous_versions[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_purge_previous_versions[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_delete_symbol[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_delete_symbol[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_delete_symbol[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_snapshots[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_snapshots[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_write_metadata_snapshots[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_restore_version[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_purging_previous_versions[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_purging_previous_versions[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_restore_version_purging_previous_versions[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_non_existent_version[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_non_existent_version[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_restore_version_non_existent_version[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_which_updated_only_metadata[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_which_updated_only_metadata[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_restore_version_which_updated_only_metadata[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_then_snapshot[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_then_snapshot[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_restore_version_then_snapshot[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_latest_snapshot_noop[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_latest_snapshot_noop[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_restore_version_latest_snapshot_noop[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_latest_version_noop[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_latest_version_noop[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_restore_version_latest_version_noop[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_snap_delete_symbol_restore[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_restore_version_snap_delete_symbol_restore[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_restore_version_snap_delete_symbol_restore[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_df[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_df[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_df[FwPointersCfg.ENABLED]
FAILED tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_series[FwPointersCfg.DISABLED]
FAILED tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_series[FwPointersCfg.HYBRID]
FAILED tests/integration/store/test_version_store.py::test_can_write_tz_aware_data_series[FwPointersCfg.ENABLED]
FAILED tests/integration/tickstore/test_toplevel.py::test_should_return_data_when_date_range_falls_in_a_single_underlying_library
FAILED tests/integration/tickstore/test_toplevel.py::test_should_return_data_when_date_range_spans_libraries_even_if_one_returns_nothing
FAILED tests/integration/tickstore/test_toplevel.py::test_should_write_top_level_with_list_of_dicts
FAILED tests/integration/tickstore/test_toplevel.py::test_should_write_top_level_with_correct_timezone
FAILED tests/unit/store/test_version_store_audit.py::test_ArcticTransaction_detects_concurrent_writes
[31m= [31m[1m61 failed[0m, [32m1255 passed[0m, [33m3 skipped[0m, [33m19 xfailed[0m, [33m1 xpassed[0m, [33m60848 warnings[0m[31m in 1322.83s (0:22:02)[0m[31m =[0m
travis_time:end:02f62911:start=1610551082098121370,finish=1610552409085845627,duration=1326987724257,event=script[0K[31;1mThe command "python setup.py test --pytest-args=-v" exited with 1.[0m
travis_time:start:0d91c866[0K$ pycodestyle arctic
travis_time:end:0d91c866:start=1610552409089661881,finish=1610552410349960611,duration=1260298730,event=script[0K[32;1mThe command "pycodestyle arctic" exited with 0.[0m


Done. Your build exited with 1.
